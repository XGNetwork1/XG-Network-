<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XG Network Dashboard v3.2</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNB/ZpiBw==" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script> <!-- For swipe gestures -->
    <script src="script.js" defer></script>
<style>
/* Root Variables */
:root {
  --bg-1: #0a1a3a; /* Darker, richer base */
  --bg-2: #123a5a; /* Slightly brighter secondary */
  --accent-1: #3beaff; /* Brighter cyan for vibrancy */
  --accent-2: #9b7eff; /* Softer purple */
  --accent-3: #ffda80; /* Warmer gold */
  --success: #2bd9a0; /* Vibrant green */
  --danger: #ff6b6b; /* Softer red */
  --warning: #ffc107; /* Standard amber */
  --txt: #f0f6ff; /* Slightly brighter text */
  --muted: #a8bcd9; /* Softer muted tone */
  --focus: rgba(59, 234, 255, 0.2); /* Stronger focus ring */
  --card-radius: 12px; /* Tighter radius for modern look */
  --ui-shadow: 0 8px 24px rgba(0, 10, 30, 0.5); /* Subtler shadow */
  --glow: 0 0 8px rgba(59, 234, 255, 0.4); /* Reduced glow intensity */
  --ease: cubic-bezier(0.4, 0.8, 0.2, 1); /* Smoother easing */
  --max-width: 1440px;
  --ui-padding: 16px; /* Optimized padding */
  --fs: 16px;
  --fs-heading: 1.6rem;
  --fs-subheading: 1.15rem;
  --fs-small: 0.875rem;
  --light-bg-1: #f4f8ff; /* Cleaner light background */
  --light-bg-2: #e6edff; /* Softer light secondary */
  --light-txt: #1f2a44; /* Darker text for contrast */
  --light-muted: #5a6b8a; /* Neutral muted tone */
}

/* Light Theme */
[data-theme="light"] {
  --bg-1: var(--light-bg-1);
  --bg-2: var(--light-bg-2);
  --txt: var(--light-txt);
  --muted: var(--light-muted);
  --ui-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
  --focus: rgba(59, 234, 255, 0.15);
}

/* Global Reset */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
  font-size: var(--fs);
  color: var(--txt);
}

html, body {
  height: 100%;
  scroll-behavior: smooth;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  background: radial-gradient(1000px 600px at 15% 15%, rgba(20, 40, 70, 0.6), transparent),
              linear-gradient(145deg, var(--bg-1), var(--bg-2));
  display: flex;
  justify-content: center;
  overflow-x: hidden;
  transition: background 0.3s var(--ease);
}

/* Loader */
.loader {
  position: fixed;
  inset: 0;
  background: var(--bg-1);
  display: grid;
  place-items: center;
  z-index: 5000;
  opacity: 1;
  transition: opacity 0.4s var(--ease);
}

.loader.hidden {
  opacity: 0;
  pointer-events: none;
}

.loader .xg-logo {
  width: 80px;
  height: 80px;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  border-radius: 10px;
  display: grid;
  place-items: center;
  font-size: 2rem;
  font-weight: 900;
  color: var(--bg-1);
  animation: pulseLogo 1.5s infinite var(--ease);
}

@keyframes pulseLogo {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

/* Particles */
.particles {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 5;
}

#particles-js canvas {
  width: 100% !important;
  height: 100% !important;
}

/* Navbar */
.navbar {
  background: linear-gradient(90deg, rgba(10, 26, 58, 0.94), rgba(18, 58, 90, 0.94));
  backdrop-filter: blur(12px);
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  padding: 8px 12px;
  box-shadow: var(--ui-shadow);
  height: 52px;
  transition: all 0.3s var(--ease);
}

[data-theme="light"] .navbar {
  background: linear-gradient(90deg, rgba(255, 255, 255, 0.94), rgba(230, 237, 255, 0.94));
}

.navbar.scrolled {
  background: linear-gradient(90deg, rgba(18, 58, 90, 0.98), rgba(10, 26, 58, 0.98));
}

.nav-links {
  display: flex;
  align-items: center;
  justify-content: center;
  max-width: var(--max-width);
  margin: 0 auto;
  gap: 8px;
  flex-wrap: wrap;
}

.nav-links li {
  margin: 0 6px;
}

.nav-links a,
.nav-links button {
  color: var(--txt);
  text-decoration: none;
  padding: 6px 10px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: var(--fs-small);
  font-weight: 600;
  transition: all 0.2s var(--ease);
}

.nav-links a:hover,
.nav-links button:hover {
  background: rgba(255, 255, 255, 0.12);
  box-shadow: var(--glow);
  transform: scale(1.03);
}

.nav-links a:focus,
.nav-links button:focus {
  outline: 2px solid var(--accent-1);
  outline-offset: 2px;
}

.nav-links a.active {
  background: var(--focus);
  outline: 1px solid var(--accent-1);
}

.logo-badge {
  width: 28px;
  height: 28px;
  border-radius: 6px;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  font-weight: 900;
  font-size: var(--fs-small);
  display: grid;
  place-items: center;
  box-shadow: var(--glow);
}

.search-container {
  background: rgba(255, 255, 255, 0.06);
  border-radius: 8px;
  max-width: 220px;
  display: flex;
  align-items: center;
  position: relative;
  transition: background 0.2s var(--ease);
}

.search-container input {
  border: none;
  background: transparent;
  color: var(--txt);
  padding: 6px 10px;
  font-size: var(--fs-small);
  width: 100%;
}

.search-container input:focus {
  box-shadow: var(--glow);
  outline: none;
}

.search-container button {
  background: transparent;
  border: none;
  color: var(--accent-1);
  padding: 6px;
  cursor: pointer;
  transition: transform 0.2s var(--ease);
}

.search-container button:hover {
  transform: scale(1.08);
}

.search-suggestions {
  position: absolute;
  top: calc(100% + 4px);
  left: 0;
  right: 0;
  background: var(--bg-2);
  border-radius: 8px;
  box-shadow: var(--ui-shadow);
  max-height: 200px;
  overflow-y: auto;
  display: none;
  z-index: 2000;
}

.search-suggestions.active {
  display: block;
}

.search-suggestions div {
  padding: 8px 12px;
  cursor: pointer;
  transition: background 0.2s var(--ease);
}

.search-suggestions div:hover,
.search-suggestions div:focus {
  background: var(--focus);
}

#day-time {
  font-size: 0.75rem;
  font-weight: 600;
}

#balance-amount {
  color: var(--success);
  font-weight: 700;
  padding: 4px 8px;
  border-radius: 6px;
  background: var(--focus);
  transition: transform 0.2s var(--ease);
}

#balance-amount:hover {
  transform: scale(1.05);
}

.theme-toggle {
  background: transparent;
  border: none;
  color: var(--accent-1);
  font-size: var(--fs-small);
  cursor: pointer;
  transition: transform 0.2s var(--ease);
}

.theme-toggle:hover {
  transform: scale(1.08);
}

/* Status Bar */
.status-bar {
  margin-top: 52px;
  padding: 6px 10px;
  background: rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(10px);
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  gap: 12px;
  box-shadow: var(--ui-shadow);
  z-index: 90;
}

.status-item {
  scroll-snap-align: center;
  text-align: center;
  cursor: pointer;
  transition: transform 0.2s var(--ease);
}

.status-item:hover,
.status-item:focus {
  transform: scale(1.06);
}

.status-circle {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: 2px solid var(--accent-1);
  background: rgba(255, 255, 255, 0.06);
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  box-shadow: var(--glow);
}

.status-circle img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
}

.status-label {
  font-size: var(--fs-small);
  margin-top: 4px;
  color: var(--muted);
}

/* Sidebar Toggle */
.sidebar-toggle {
  position: fixed;
  left: 10px;
  top: 10px;
  z-index: 2000;
  width: 34px;
  height: 34px;
  border-radius: 50%;
  background: var(--focus);
  border: 1px solid rgba(255, 255, 255, 0.06);
  color: var(--accent-1);
  cursor: pointer;
  display: none;
  align-items: center;
  justify-content: center;
  font-size: 1.1rem;
  transition: all 0.2s var(--ease);
}

.sidebar-toggle:hover,
.sidebar-toggle:focus {
  background: rgba(255, 255, 255, 0.15);
  transform: scale(1.06);
}

.sidebar-toggle[aria-expanded="true"] i::before {
  content: '\f00d';
}

/* App Layout */
.app {
  display: flex;
  height: calc(100vh - 52px);
  max-width: var(--max-width);
  margin: 52px auto 0;
  border-radius: var(--card-radius);
  overflow: hidden;
  box-shadow: var(--ui-shadow);
}

/* Contacts */
.contacts {
  width: 30%;
  min-width: 280px;
  background: linear-gradient(180deg, var(--bg-2), #0b2a4a 120%);
  padding: var(--ui-padding);
  border-right: 1px solid rgba(255, 255, 255, 0.04);
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.header-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

.dashboard-title {
  margin: 0;
  font-size: var(--fs-heading);
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.search {
  margin-top: 8px;
  display: flex;
  gap: 8px;
  align-items: center;
}

.search input {
  flex: 1;
  padding: 8px 12px;
  border-radius: 8px;
  border: none;
  background: rgba(255, 255, 255, 0.04);
  color: var(--txt);
  outline: none;
  transition: background 0.2s var(--ease);
}

.search input:focus {
  background: rgba(255, 255, 255, 0.1);
  box-shadow: var(--glow);
}

.search button {
  background: transparent;
  border: none;
  color: var(--accent-1);
  padding: 6px;
  cursor: pointer;
  transition: transform 0.2s var(--ease);
}

.search button:hover {
  transform: scale(1.08);
}

.contact-list {
  margin-top: 12px;
  overflow-y: auto;
  padding-right: 6px;
}

.contact-list::-webkit-scrollbar {
  width: 5px;
}

.contact-list::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.04);
  border-radius: 3px;
}

.contact-list::-webkit-scrollbar-thumb {
  background: var(--accent-1);
  border-radius: 3px;
}

.contact-card {
  display: flex;
  gap: 12px;
  align-items: center;
  padding: 10px;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s var(--ease);
  background: rgba(255, 255, 255, 0.03);
}

.contact-card:hover,
.contact-card:focus {
  background: var(--focus);
  transform: translateY(-2px);
  box-shadow: var(--glow);
}

.post-profile-img {
  width: 48px;
  height: 48px;
  border-radius: 10px;
  object-fit: cover;
  box-shadow: var(--glow);
}

.avatar-wrap {
  position: relative;
}

.online-dot {
  position: absolute;
  right: 0;
  bottom: 0;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--success);
  border: 2px solid var(--bg-2);
  box-shadow: 0 0 6px rgba(43, 217, 160, 0.3);
}

.info h4 {
  margin: 0;
  font-size: var(--fs-subheading);
}

.info p {
  margin: 0;
  font-size: var(--fs-small);
  color: var(--muted);
}

/* Chat Area */
.chat {
  width: 70%;
  display: flex;
  flex-direction: column;
  background: var(--bg-1);
}

.chat-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.04);
  background: linear-gradient(90deg, var(--bg-2), #0a1e3a 140%);
}

.chat-title h3 {
  margin: 0;
  font-size: var(--fs-subheading);
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.chat-title p {
  margin: 0;
  color: var(--muted);
  font-size: var(--fs-small);
}

.tag {
  padding: 5px 10px;
  border-radius: 999px;
  background: rgba(155, 126, 255, 0.18);
  color: var(--accent-2);
  font-size: var(--fs-small);
  margin-left: 6px;
}

.chat-body {
  flex: 1;
  padding: var(--ui-padding);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 12px;
  background: linear-gradient(180deg, rgba(10, 26, 58, 0.04), transparent 40%), var(--bg-1);
}

.chat-body::-webkit-scrollbar {
  width: 5px;
}

.chat-body::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.04);
  border-radius: 3px;
}

.chat-body::-webkit-scrollbar-thumb {
  background: var(--accent-1);
  border-radius: 3px;
}

.msg-row {
  display: flex;
  gap: 8px;
  align-items: flex-end;
  max-width: 75%;
  animation: slideInMsg 0.3s var(--ease);
}

@keyframes slideInMsg {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

.msg-row.sent {
  margin-left: auto;
  flex-direction: row-reverse;
}

.msg {
  padding: 10px 14px;
  border-radius: 12px;
  line-height: 1.5;
  font-size: 0.9rem;
  box-shadow: var(--ui-shadow);
  word-break: break-word;
  transition: transform 0.2s var(--ease);
}

.msg:hover {
  transform: scale(1.01);
}

.msg.sent {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  border-bottom-right-radius: 4px;
}

.msg.received {
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid rgba(255, 255, 255, 0.04);
  color: var(--txt);
  border-bottom-left-radius: 4px;
}

.meta {
  font-size: 0.75rem;
  color: var(--muted);
  margin-top: 3px;
}

.neg-card {
  border-radius: 10px;
  padding: 12px;
  background: linear-gradient(180deg, rgba(155, 126, 255, 0.1), rgba(59, 234, 255, 0.08));
  border: 1px solid rgba(255, 255, 255, 0.04);
  width: 320px;
  box-shadow: var(--ui-shadow);
}

.actions {
  display: flex;
  gap: 8px;
  margin-top: 8px;
}

.btn {
  padding: 6px 10px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.2s var(--ease);
}

.btn.accept {
  background: var(--success);
  color: var(--bg-1);
}

.btn.decline {
  background: var(--danger);
  color: var(--bg-1);
}

.btn.counter {
  background: var(--accent-3);
  color: var(--bg-1);
}

.btn:hover,
.btn:focus {
  transform: translateY(-1px);
  box-shadow: var(--glow);
}

.chat-footer {
  padding: 12px;
  border-top: 1px solid rgba(255, 255, 255, 0.04);
  display: flex;
  gap: 8px;
  align-items: center;
  background: linear-gradient(180deg, rgba(10, 26, 58, 0.06), transparent);
}

.tools {
  display: flex;
  gap: 6px;
  align-items: center;
}

.icon-btn {
  width: 38px;
  height: 38px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  background: rgba(255, 255, 255, 0.04);
  color: var(--accent-1);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s var(--ease);
}

.icon-btn:hover,
.icon-btn:focus {
  background: var(--focus);
  transform: scale(1.08);
}

.input {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.04);
}

.input input {
  flex: 1;
  border: none;
  outline: none;
  background: transparent;
  color: var(--txt);
  font-size: var(--fs-small);
}

.input input:focus {
  outline: none;
}

.attach-preview {
  display: flex;
  gap: 6px;
  align-items: center;
  margin-top: 6px;
}

.preview-img {
  width: 60px;
  height: 45px;
  object-fit: cover;
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.04);
}

/* Sidebar */
.sidebar {
  height: calc(100vh - 70px);
  border-radius: var(--card-radius);
  background: linear-gradient(180deg, rgba(59, 234, 255, 0.12), rgba(155, 126, 255, 0.12));
  border: 1px solid rgba(255, 255, 255, 0.06);
  backdrop-filter: blur(10px);
  box-shadow: var(--ui-shadow);
  padding: 16px;
  position: sticky;
  top: 70px;
  overflow-y: auto;
  transition: all 0.2s var(--ease);
}

.sidebar:hover {
  background: linear-gradient(180deg, rgba(59, 234, 255, 0.16), rgba(155, 126, 255, 0.16));
}

.sidebar::-webkit-scrollbar {
  width: 5px;
}

.sidebar::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.04);
  border-radius: 3px;
}

.sidebar::-webkit-scrollbar-thumb {
  background: var(--accent-1);
  border-radius: 3px;
}

.sb-top {
  display: flex;
  gap: 12px;
  align-items: center;
  margin-bottom: 12px;
}

.logoBadge {
  width: 48px;
  height: 48px;
  border-radius: 10px;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  font-weight: 900;
  font-size: 1.2rem;
  display: grid;
  place-items: center;
  box-shadow: var(--glow);
}

.title {
  font-size: var(--fs-subheading);
  font-weight: 800;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.desc {
  font-size: var(--fs-small);
  color: var(--muted);
}

.nav {
  margin-top: 16px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.nav a {
  padding: 10px;
  border-radius: 8px;
  color: var(--txt);
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 10px;
  transition: all 0.2s var(--ease);
}

.nav a:hover,
.nav a:focus {
  background: rgba(255, 255, 255, 0.12);
  transform: translateX(3px);
  box-shadow: var(--glow);
}

.nav a.active {
  background: var(--focus);
  outline: 1px solid var(--accent-1);
}

.nav-submenu .submenu {
  display: none;
  padding-left: 16px;
}

.nav-submenu.active .submenu {
  display: block;
}

.sb-foot {
  margin-top: auto;
  padding-top: 16px;
  border-top: 1px solid rgba(255, 255, 255, 0.06);
  display: flex;
  justify-content: space-between;
  font-size: var(--fs-small);
  color: var(--muted);
}

/* Panel and Containers */
.panel,
.portfolio-card,
.market-grid,
.ai-insights-container,
.settings-container,
.wallet-card,
.contact-list,
.deals-grid,
.referral-container,
.upload-area,
.exchange-container,
.zone-container,
.ad-container,
.chat-container,
.trust-container,
.business-grid,
.invest-container,
.loan-container,
.super-admin-container {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: var(--card-radius);
  padding: 16px;
  box-shadow: var(--ui-shadow);
  backdrop-filter: blur(12px);
  transition: transform 0.2s var(--ease);
}

[data-theme="light"] .panel,
[data-theme="light"] .portfolio-card,
[data-theme="light"] .market-grid,
[data-theme="light"] .ai-insights-container,
[data-theme="light"] .settings-container,
[data-theme="light"] .wallet-card,
[data-theme="light"] .contact-list,
[data-theme="light"] .deals-grid,
[data-theme="light"] .referral-container,
[data-theme="light"] .upload-area,
[data-theme="light"] .exchange-container,
[data-theme="light"] .zone-container,
[data-theme="light"] .ad-container,
[data-theme="light"] .chat-container,
[data-theme="light"] .trust-container,
[data-theme="light"] .business-grid,
[data-theme="light"] .invest-container,
[data-theme="light"] .loan-container,
[data-theme="light"] .super-admin-container {
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.94), rgba(230, 237, 255, 0.94));
}

.slider-container {
  display: flex;
  flex-direction: column;
}

.slide {
  padding: var(--ui-padding);
  display: none;
  opacity: 0;
  transition: opacity 0.3s var(--ease);
}

.slide.active-slide {
  display: block;
  opacity: 1;
}

.fixed-section {
  background: rgba(18, 58, 90, 0.94);
  backdrop-filter: blur(10px);
  padding: 12px;
  border-radius: var(--card-radius);
}

[data-theme="light"] .fixed-section {
  background: rgba(255, 255, 255, 0.94);
}

.dashboard-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
}

.orbit-wallet {
  position: relative;
  width: 300px;
  height: 300px;
  margin: 16px auto;
  perspective: 1200px;
  display: flex;
  justify-content: center;
  align-items: center;
  animation: orbitPulse 6s infinite var(--ease);
}

@keyframes orbitPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.015); }
}

.profile-img-container {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  border: 2px solid var(--accent-1);
  box-shadow: var(--glow);
  display: grid;
  place-items: center;
  z-index: 10;
  animation: floatProfile 3s infinite var(--ease);
}

@keyframes floatProfile {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

.profile-img {
  width: 92px;
  height: 92px;
  border-radius: 50%;
  object-fit: cover;
}

.orbit-wallet .action {
  --size: 48px;
  width: var(--size);
  height: var(--size);
  border-radius: 50%;
  background: linear-gradient(180deg, var(--accent-1), var(--accent-2));
  border: 1px solid rgba(255, 255, 255, 0.15);
  box-shadow: var(--ui-shadow), var(--glow);
  display: grid;
  place-items: center;
  font-size: 24px;
  cursor: pointer;
  color: var(--bg-1);
  position: absolute;
  transition: all 0.2s var(--ease);
  animation: orbit 14s infinite linear, glowPulse 1.5s infinite var(--ease);
}

@keyframes orbit {
  0% { transform: rotate(0deg) translate(120px) rotate(0deg); }
  100% { transform: rotate(360deg) translate(120px) rotate(-360deg); }
}

@keyframes glowPulse {
  0%, 100% { box-shadow: var(--ui-shadow), var(--glow); }
  50% { box-shadow: 0 0 10px rgba(59, 234, 255, 0.7); }
}

.orbit-wallet .action::after {
  content: attr(data-label);
  position: absolute;
  bottom: -28px;
  font-size: var(--fs-small);
  color: var(--txt);
  background: rgba(0, 0, 0, 0.65);
  padding: 3px 6px;
  border-radius: 6px;
  opacity: 0;
  transform: translateY(8px);
  transition: all 0.2s var(--ease);
}

.orbit-wallet .action:hover,
.orbit-wallet .action:focus {
  transform: scale(1.1) !important;
  box-shadow: 0 0 10px var(--accent-1);
}

.orbit-wallet .action:hover::after,
.orbit-wallet .action:focus::after {
  opacity: 1;
  transform: translateY(0);
}

.orbit-wallet .action:nth-child(1) { transform: rotate(0deg) translate(120px) rotate(0deg); }
.orbit-wallet .action:nth-child(2) { transform: rotate(51.43deg) translate(120px) rotate(-51.43deg); }
.orbit-wallet .action:nth-child(3) { transform: rotate(102.86deg) translate(120px) rotate(-102.86deg); }
.orbit-wallet .action:nth-child(4) { transform: rotate(154.29deg) translate(120px) rotate(-154.29deg); }
.orbit-wallet .action:nth-child(5) { transform: rotate(205.71deg) translate(120px) rotate(-205.71deg); }
.orbit-wallet .action:nth-child(6) { transform: rotate(257.14deg) translate(120px) rotate(-257.14deg); }
.orbit-wallet .action:nth-child(7) { transform: rotate(308.57deg) translate(120px) rotate(-308.57deg); }

.post-card {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: var(--card-radius);
  padding: 16px;
  margin-bottom: 16px;
  box-shadow: var(--ui-shadow);
  backdrop-filter: blur(12px);
  transition: all 0.2s var(--ease);
}

.post-card:hover,
.post-card:focus-within {
  transform: translateY(-2px);
  box-shadow: 0 8px 16px rgba(0, 10, 30, 0.4);
}

.post-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 12px;
}

.post-info h4 {
  font-size: var(--fs-subheading);
  font-weight: 700;
}

.post-info p {
  font-size: var(--fs-small);
  color: var(--muted);
}

.post-content p {
  line-height: 1.5;
  margin-bottom: 10px;
}

.post-content img,
.post-content video {
  width: 100%;
  border-radius: 12px;
  object-fit: cover;
}

.post-content img.watermarked::after,
.post-content video.watermarked::after {
  content: 'XG Network';
  position: absolute;
  bottom: 8px;
  right: 8px;
  color: var(--txt);
  opacity: 0.65;
  font-size: var(--fs-small);
  font-weight: 700;
}

.post-actions {
  display: flex;
  gap: 8px;
  margin-top: 8px;
  flex-wrap: wrap;
}

.post-actions button {
  background: transparent;
  border: none;
  color: var(--txt);
  cursor: pointer;
  font-size: var(--fs-small);
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 6px 10px;
  border-radius: 8px;
  transition: all 0.2s var(--ease);
}

.post-actions button:hover,
.post-actions button:focus {
  background: rgba(255, 255, 255, 0.12);
  color: var(--accent-1);
  transform: translateY(-1px);
  box-shadow: var(--glow);
}

.post-actions .like-btn.active {
  color: var(--danger);
}

.post-actions .like-btn.active i::before {
  content: '\f004';
}

.post-actions .view-property-btn {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  font-weight: 700;
}

.view-post-modal .modal {
  max-width: 600px;
  max-height: 90vh;
  overflow-y: auto;
}

.view-post-modal .modal::-webkit-scrollbar {
  width: 5px;
}

.view-post-modal .modal::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.04);
  border-radius: 3px;
}

.view-post-modal .modal::-webkit-scrollbar-thumb {
  background: var(--accent-1);
  border-radius: 3px;
}

.view-post-modal .media-container {
  margin-bottom: 16px;
}

.view-post-modal .media-container img,
.view-post-modal .media-container video {
  width: 100%;
  max-height: 300px;
  border-radius: 12px;
  margin-bottom: 10px;
  object-fit: cover;
}

.view-post-modal .chat-container {
  margin-bottom: 16px;
}

.view-post-modal .chat-messages {
  height: 200px;
  overflow-y: auto;
  padding: 10px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
}

.view-post-modal .chat-messages::-webkit-scrollbar {
  width: 5px;
}

.view-post-modal .chat-messages::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.04);
  border-radius: 3px;
}

.view-post-modal .chat-messages::-webkit-scrollbar-thumb {
  background: var(--accent-1);
  border-radius: 3px;
}

.view-post-modal .chat-input {
  display: flex;
  gap: 10px;
}

.view-post-modal .chat-input input {
  flex-grow: 1;
  padding: 10px;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.9);
  color: var(--bg-1);
  border: none;
}

.view-post-modal .chat-input button {
  padding: 10px 20px;
  border-radius: 8px;
  background: var(--bg-1);
  color: var(--txt);
  transition: all 0.2s var(--ease);
}

.view-post-modal .chat-input button:hover,
.view-post-modal .chat-input button:focus {
  background: var(--bg-2);
  transform: translateY(-1px);
}

.view-post-modal .agent-selection {
  display: none;
  margin-top: 16px;
}

.view-post-modal .agent-selection.active {
  display: block;
}

.view-post-modal .agent-list {
  display: grid;
  gap: 10px;
}

.view-post-modal .agent-card {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 10px;
  padding: 10px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.view-post-modal .agent-card img {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
}

.view-post-modal .agent-card h4 {
  font-size: var(--fs-small);
  margin: 0;
}

.view-post-modal .agent-card p {
  font-size: 0.8rem;
  color: var(--muted);
}

.view-post-modal .agent-card button {
  padding: 6px 12px;
  border-radius: 8px;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  border: none;
  cursor: pointer;
  transition: all 0.2s var(--ease);
}

.view-post-modal .agent-card button:hover,
.view-post-modal .agent-card button:focus {
  transform: translateY(-1px);
  box-shadow: var(--glow);
}

.status-btn {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  font-weight: 700;
  cursor: pointer;
  box-shadow: var(--glow);
  transition: all 0.2s var(--ease);
}

.status-btn:hover,
.status-btn:focus {
  transform: translateY(-1px);
  box-shadow: 0 0 12px var(--accent-1);
}

/* Upload Hub */
.upload-area {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: var(--card-radius);
  padding: 16px;
  box-shadow: var(--ui-shadow);
  backdrop-filter: blur(12px);
}

#progress-bar {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-bottom: 16px;
}

.progress-step {
  width: 28px;
  height: 28px;
  background: rgba(255, 255, 255, 0.1);
  color: var(--muted);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.9rem;
  transition: all 0.2s var(--ease);
}

.progress-step.active {
  background: var(--accent-1);
  color: var(--bg-1);
  box-shadow: var(--glow);
}

.upload-form-group {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 16px;
}

.upload-form-group select,
.upload-form-group input {
  flex: 1;
  min-width: 140px;
  padding: 8px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.04);
  color: var(--txt);
  font-size: var(--fs-small);
}

.upload-form-group select:focus,
.upload-form-group input:focus {
  box-shadow: var(--glow);
  outline: none;
}

#price-group {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 16px;
}

#upload-price,
#upload-currency {
  padding: 8px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.04);
  color: var(--txt);
  font-size: var(--fs-small);
}

#upload-currency {
  width: 90px;
}

.boost-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--muted);
  font-size: var(--fs-small);
}

.boost-note {
  font-size: 0.75rem;
  color: var(--muted);
  margin-top: 4px;
}

.capture-group {
  margin-bottom: 16px;
}

#video,
#owner-video {
  width: 100%;
  max-height: 180px;
  border-radius: 10px;
  border: 1px solid var(--muted);
  background: rgba(255, 255, 255, 0.04);
}

#canvas,
#owner-canvas {
  display: none;
}

#preview-gallery {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 8px;
}

#preview-gallery img,
#preview-gallery video {
  width: 80px;
  height: 80px;
  object-fit: cover;
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.06);
}

.capture-buttons {
  display: flex;
  gap: 8px;
  margin-top: 8px;
}

#owner-verification-step {
  margin-bottom: 16px;
}

#owner-name,
#owner-contact,
#owner-id {
  width: 100%;
  padding: 8px;
  margin-bottom: 8px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.04);
  color: var(--txt);
  font-size: var(--fs-small);
}

.selfie-controls {
  display: flex;
  align-items: center;
  gap: 8px;
}

#selfie-countdown {
  color: var(--warning);
  font-size: var(--fs-small);
}

.verification-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 16px;
}

.verification-group label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--txt);
  font-size: var(--fs-small);
}

.kyc-note {
  font-size: 0.75rem;
  color: var(--muted);
  margin-top: 4px;
}

#submit-btn {
  width: 100%;
  padding: 10px;
  border-radius: 8px;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  border: none;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s var(--ease);
}

#submit-btn:hover,
#submit-btn:focus {
  transform: translateY(-1px);
  box-shadow: var(--glow);
}

#upload-status {
  margin-top: 8px;
  color: var(--success);
  font-size: var(--fs-small);
}

.uploads-group {
  margin-top: 16px;
}

.uploads-filter {
  display: flex;
  gap: 8px;
  margin-bottom: 8px;
}

#search-box {
  flex: 1;
  padding: 8px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.04);
  color: var(--txt);
  font-size: var(--fs-small);
}

#upload-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

#notif-list {
  margin-top: 8px;
  color: var(--muted);
  font-size: var(--fs-small);
}

/* Portfolio */
.portfolio-card .balance-info {
  margin: 16px 0;
}

.portfolio-card .balance-info p {
  font-size: var(--fs-small);
  color: var(--muted);
}

.portfolio-card .balance-info h2 {
  font-size: 1.6rem;
  color: var(--success);
}

.portfolio-types {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.portfolio-types div {
  padding: 8px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: all 0.2s var(--ease);
}

.portfolio-types div:hover,
.portfolio-types div:focus {
  background: rgba(255, 255, 255, 0.12);
  transform: scale(1.03);
}

.market-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 16px;
}

.market-card {
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid rgba(255, 255, 255, 0.05);
  border-radius: 10px;
  padding: 12px;
  box-shadow: var(--ui-shadow);
  transition: all 0.2s var(--ease);
}

.market-card:hover,
.market-card:focus-within {
  transform: translateY(-2px);
  box-shadow: 0 8px 16px rgba(0, 10, 30, 0.4);
}

.market-card h4 {
  font-size: var(--fs-subheading);
  margin-bottom: 8px;
}

.market-card p {
  font-size: var(--fs-small);
  color: var(--muted);
}

.market-card .progress {
  height: 6px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
  margin-top: 8px;
}

.market-card .progress-bar {
  height: 100%;
  background: var(--success);
  border-radius: 3px;
  transition: width 0.4s var(--ease);
}

.ai-insights-container .insight-item {
  padding: 10px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  transition: all 0.2s var(--ease);
}

.ai-insights-container .insight-item:hover,
.ai-insights-container .insight-item:focus-within {
  background: rgba(255, 255, 255, 0.1);
}

.contact-list .contact-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  transition: background 0.2s var(--ease);
}

.contact-item:hover,
.contact-item:focus-within {
  background: rgba(255, 255, 255, 0.08);
}

.deals-grid,
.exchange-grid,
.zone-grid,
.ad-grid,
.chat-grid,
.business-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 20px;
}

.deal-card,
.zone-card,
.ad-card,
.chat-card,
.business-card {
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid rgba(255, 255, 255, 0.05);
  border-radius: 10px;
  padding: 16px;
  box-shadow: var(--ui-shadow);
  transition: transform 0.2s var(--ease);
}

.deal-card:hover,
.deal-card:focus-within,
.zone-card:hover,
.zone-card:focus-within,
.ad-card:hover,
.ad-card:focus-within,
.chat-card:hover,
.chat-card:focus-within,
.business-card:hover,
.business-card:focus-within {
  transform: translateY(-3px);
  box-shadow: 0 8px 16px rgba(0, 10, 30, 0.4);
}

.deal-card h4,
.zone-card h4,
.ad-card h4,
.chat-card h4,
.business-card h4 {
  font-size: var(--fs-subheading);
  margin-bottom: 10px;
}

.deal-card p,
.zone-card p,
.ad-card p,
.chat-card p,
.business-card p {
  font-size: var(--fs-small);
  color: var(--muted);
}

.exchange-filters,
.zone-filters,
.ad-filters,
.business-filters,
.analysis-filters {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.exchange-filters select,
.zone-filters select,
.ad-filters select,
.business-filters select,
.analysis-filters select {
  padding: 10px;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.05);
  color: var(--txt);
  border: none;
  transition: all 0.2s var(--ease);
}

.exchange-filters select:focus,
.zone-filters select:focus,
.ad-filters select:focus,
.business-filters select:focus,
.analysis-filters select:focus {
  box-shadow: var(--glow);
}

.business-filters button,
.analysis-filters button {
  background: rgba(255, 255, 255, 0.05);
  color: var(--txt);
  padding: 10px 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s var(--ease);
}

.business-filters button:hover,
.business-filters button:focus,
.analysis-filters button:hover,
.analysis-filters button:focus {
  background: rgba(255, 255, 255, 0.12);
  transform: translateY(-1px);
}

.business-filters button.active,
.analysis-filters button.active {
  background: var(--accent-1);
  color: var(--bg-1);
}

.zone-map {
  height: 400px;
  border-radius: var(--card-radius);
  margin-bottom: 20px;
}

.chat-container .chat-messages {
  height: 300px;
  overflow-y: auto;
  padding: 10px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
}

.chat-container .chat-messages::-webkit-scrollbar {
  width: 5px;
}

.chat-container .chat-messages::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.04);
  border-radius: 3px;
}

.chat-container .chat-messages::-webkit-scrollbar-thumb {
  background: var(--accent-1);
  border-radius: 3px;
}

.chat-messages .message {
  padding: 8px;
  margin-bottom: 10px;
  border-radius: 10px;
}

.chat-messages .message.sent {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  align-self: flex-end;
}

.chat-messages .message.received {
  background: rgba(255, 255, 255, 0.1);
}

.chat-input {
  display: flex;
  gap: 10px;
  margin-top: 10px;
}

.chat-input input {
  flex-grow: 1;
  padding: 10px;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.05);
  color: var(--txt);
  border: none;
}

.chat-input input:focus {
  box-shadow: var(--glow);
}

.chat-input button {
  padding: 10px;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  border: none;
  border-radius: 8px;
  transition: all 0.2s var(--ease);
}

.chat-input button:hover,
.chat-input button:focus {
  transform: translateY(-1px);
  box-shadow: var(--glow);
}

.form-group {
  margin-bottom: 12px;
}

.form-group label {
  display: block;
  font-size: var(--fs-small);
  color: var(--muted);
  margin-bottom: 5px;
}

.form-group input,
.form-group textarea,
.form-group select {
  width: 100%;
  padding: 8px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.04);
  color: var(--txt);
  font-size: var(--fs-small);
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
  box-shadow: var(--glow);
}

.form-group input[type="file"] {
  padding: 5px;
}

.form-group select[multiple] {
  height: 90px;
}

.modal-bg {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 3000;
  backdrop-filter: blur(5px);
  animation: fadeIn 0.3s var(--ease);
}

.modal-bg.active {
  display: flex;
}

.modal {
  background: linear-gradient(160deg, var(--accent-1), var(--accent-2));
  padding: 18px;
  border-radius: var(--card-radius);
  width: 90%;
  max-width: 400px;
  box-shadow: var(--ui-shadow);
  position: relative;
  animation: slideUp 0.3s var(--ease);
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}

.modal h3 {
  margin: 0 0 12px;
  color: var(--bg-1);
  font-size: var(--fs-heading);
}

.modal input,
.modal textarea {
  width: 100%;
  padding: 12px;
  border-radius: 8px;
  border: none;
  margin-bottom: 10px;
  background: rgba(255, 255, 255, 0.9);
  color: var(--bg-1);
  font-size: var(--fs-small);
}

.modal input:focus,
.modal textarea:focus {
  outline: 2px solid var(--accent-3);
}

.modal button {
  padding: 12px 16px;
  border-radius: 8px;
  border: none;
  background: var(--bg-1);
  color: var(--txt);
  cursor: pointer;
  font-weight: 600;
  width: 100%;
  margin-top: 10px;
  transition: all 0.2s var(--ease);
}

.modal button:hover,
.modal button:focus {
  background: var(--bg-2);
  transform: translateY(-1px);
}

.modal .close {
  position: absolute;
  top: 10px;
  right: 10px;
  cursor: pointer;
  font-size: 1.1rem;
  color: var(--bg-1);
  transition: transform 0.2s var(--ease);
}

.modal .close:hover,
.modal .close:focus {
  transform: scale(1.1);
}

.modal .input-group {
  margin-bottom: 16px;
}

.modal label {
  display: block;
  margin-bottom: 5px;
  color: var(--bg-1);
  font-weight: 500;
}

.notification {
  position: fixed;
  top: 65px;
  right: 15px;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  padding: 8px 16px;
  border-radius: 8px;
  box-shadow: var(--ui-shadow);
  z-index: 2000;
  opacity: 0;
  transform: translateX(100%);
  transition: all 0.2s var(--ease);
}

.notification.active {
  opacity: 1;
  transform: translateX(0);
}

.notification.success {
  background: var(--success);
}

.notification.error {
  background: var(--danger);
}

.video-capture {
  display: none;
  width: 100%;
  border-radius: 10px;
}

.video-capture.active {
  display: block;
}

.profile-badges {
  display: flex;
  gap: 8px;
  margin-top: 8px;
}

.profile-badge {
  padding: 5px 8px;
  background: var(--accent-1);
  color: var(--bg-1);
  border-radius: 8px;
  font-size: var(--fs-small);
}

.wallet-card {
  width: 100%;
  max-width: 500px;
  margin: 0 auto 28px auto;
  background: linear-gradient(160deg, var(--accent-1), var(--accent-2));
  border-radius: var(--card-radius);
  padding: 20px;
  box-shadow: var(--ui-shadow);
  position: relative;
  overflow: hidden;
}

.wallet-card::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
  opacity: 0.5;
}

.wallet-card h2 {
  margin: 0 0 8px 0;
  font-size: 1.25rem;
}

.wallet-card .balance {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 12px;
}

.wallet-types {
  display: flex;
  justify-content: space-between;
  margin-top: 12px;
  gap: 6px;
  flex-wrap: wrap;
}

.wallet-types div {
  flex: 1;
  min-width: 85px;
  text-align: center;
  padding: 12px;
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.1);
  margin: 0 5px;
  cursor: pointer;
  transition: all 0.2s var(--ease);
}

.wallet-types div:hover,
.wallet-types div:focus {
  transform: scale(1.03);
  background: rgba(255, 255, 255, 0.15);
}

.transaction-controls {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 20px;
  max-width: 600px;
  margin: 0 auto;
}

.search-box input {
  width: 100%;
  padding: 12px 16px;
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  background: rgba(255, 255, 255, 0.04);
  color: var(--txt);
  font-size: var(--fs-small);
}

.search-box input:focus {
  box-shadow: var(--glow);
}

.transaction-filters {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.filter-btn {
  padding: 8px 16px;
  border-radius: 8px;
  border: none;
  background: rgba(255, 255, 255, 0.05);
  color: var(--txt);
  cursor: pointer;
  transition: all 0.2s var(--ease);
  font-size: var(--fs-small);
}

.filter-btn.active {
  background: var(--accent-1);
  color: var(--bg-1);
  font-weight: 600;
}

.category-filter {
  padding: 8px 12px;
  border-radius: 8px;
  border: none;
  background: rgba(255, 255, 255, 0.05);
  color: var(--txt);
  margin-left: auto;
  font-size: var(--fs-small);
}

.category-filter:focus {
  box-shadow: var(--glow);
}

.transactions,
.trust-container,
.receipts-container {
  max-width: 600px;
  margin: 0 auto;
  background: rgba(255, 255, 255, 0.04);
  border-radius: var(--card-radius);
  padding: 18px;
  box-shadow: var(--ui-shadow);
}

.transactions h3,
.trust-container h3,
.receipts-container h3 {
  margin: 0 0 12px;
  font-size: var(--fs-heading);
}

.transaction-item,
.trust-item,
.receipt-item {
  display: flex;
  justify-content: space-between;
  padding: 12px;
  border-radius: 10px;
  margin-bottom: 8px;
  background: rgba(255, 255, 255, 0.03);
  transition: background 0.2s var(--ease);
  align-items: center;
}

.transaction-item:hover,
.transaction-item:focus-within,
.trust-item:hover,
.trust-item:focus-within,
.receipt-item:hover,
.receipt-item:focus-within {
  background: rgba(255, 255, 255, 0.1);
}

.transaction-item .desc,
.trust-item .desc,
.receipt-item .desc {
  display: flex;
  align-items: center;
  gap: 10px;
}

.transaction-item .icon,
.trust-item .icon,
.receipt-item .icon {
  width: 36px;
  height: 36px;
  border-radius: 8px;
  display: grid;
  place-items: center;
  background: rgba(255, 255, 255, 0.05);
}

.transaction-item .amount.positive {
  color: var(--success);
}

.transaction-item .amount.negative {
  color: var(--danger);
}

.transaction-item .details,
.trust-item .details,
.receipt-item .details {
  font-size: var(--fs-small);
  color: var(--muted);
  margin-top: 5px;
  display: flex;
  gap: 10px;
}

.receipt-item .actions {
  display: flex;
  gap: 8px;
}

.receipt-item .actions button {
  background: transparent;
  border: none;
  color: var(--txt);
  cursor: pointer;
  font-size: var(--fs-small);
  padding: 6px 10px;
  border-radius: 8px;
  transition: all 0.2s var(--ease);
}

.receipt-item .actions button:hover,
.receipt-item .actions button:focus {
  background: rgba(255, 255, 255, 0.12);
  color: var(--accent-1);
  transform: translateY(-1px);
  box-shadow: var(--glow);
}

.receipt-item .actions .status-btn {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  font-weight: 700;
}

.analytics-container {
  display: grid;
  gap: 20px;
  max-width: 600px;
  margin: 0 auto;
}

.analytics-card {
  background: rgba(255, 255, 255, 0.04);
  border-radius: var(--card-radius);
  padding: 20px;
  box-shadow: var(--ui-shadow);
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 12px;
}

.stat-card {
  background: rgba(255, 255, 255, 0.04);
  border-radius: 10px;
  padding: 16px;
  text-align: center;
  transition: all 0.2s var(--ease);
}

.stat-card:hover,
.stat-card:focus-within {
  transform: translateY(-3px);
  background: rgba(255, 255, 255, 0.1);
}

.stat-value {
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: 5px;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-3));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.stat-label {
  font-size: var(--fs-small);
  color: var(--muted);
}

.payment-modal .form-group select,
.payment-modal .form-group input {
  background: rgba(255, 255, 255, 0.9);
  color: var(--bg-1);
}

.payment-modal .loading {
  display: none;
  text-align: center;
  padding: 20px;
}

.payment-modal .loading.active {
  display: block;
}

.payment-modal .error-message {
  color: var(--danger);
  font-size: var(--fs-small);
  margin-top: 5px;
  display: none;
}

.receipt-modal .receipt-details {
  margin-bottom: 20px;
}

.receipt-modal .receipt-details p {
  margin: 5px 0;
  font-size: var(--fs-small);
}

.receipt-modal .download-btn {
  background: var(--bg-1);
  color: var(--txt);
  transition: all 0.2s var(--ease);
}

.receipt-modal .download-btn:hover,
.receipt-modal .download-btn:focus {
  background: var(--bg-2);
  transform: translateY(-1px);
}

.file-preview {
  margin-top: 10px;
  max-width: 100%;
  max-height: 200px;
  display: none;
  border-radius: 8px;
  object-fit: cover;
}

.contact-form-container,
.court-case-form,
.ad-campaign-form,
.mining-upload,
.negotiation-chat,
.zone-management {
  margin-top: 20px;
}

.deal-card button.subscribe-btn {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  font-weight: 700;
}

.upload-steps {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.upload-step {
  background: rgba(255, 255, 255, 0.05);
  padding: 16px;
  border-radius: 10px;
}

#video,
#captured-photo {
  width: 100%;
  max-width: 640px;
  height: auto;
  border: 1px solid var(--muted);
  border-radius: 10px;
}

#captured-photo {
  margin-top: 20px;
}

#metadata-display {
  margin-top: 10px;
  font-size: var(--fs-small);
  color: var(--muted);
}

.checklist {
  list-style: none;
  padding: 0;
}

.checklist li {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

.checklist input[type="checkbox"] {
  accent-color: var(--accent-1);
}

.verification-levels {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.verification-level {
  padding: 8px 12px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 8px;
}

.trust-metrics {
  margin-top: 10px;
}

.faq-list {
  list-style: none;
  padding: 0;
}

.faq-item {
  margin-bottom: 16px;
}

.faq-question {
  font-weight: 700;
  cursor: pointer;
  transition: color 0.2s var(--ease);
}

.faq-question:hover,
.faq-question:focus {
  color: var(--accent-1);
}

.faq-answer {
  display: none;
  color: var(--muted);
  margin-top: 5px;
}

.faq-question.active + .faq-answer {
  display: block;
}

.chart-container {
  height: 300px;
  margin-top: 20px;
}

.btn-primary {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  font-weight: 700;
  padding: 8px 16px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  transition: all 0.2s var(--ease);
}

.btn-primary:hover,
.btn-primary:focus {
  transform: translateY(-1px);
  box-shadow: var(--glow);
}

.switch-container {
  display: flex;
  align-items: center;
  gap: 8px;
}

.switch {
  width: 40px;
  height: 20px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 10px;
  position: relative;
  cursor: pointer;
}

.switch .dot {
  width: 16px;
  height: 16px;
  background: var(--accent-1);
  border-radius: 50%;
  position: absolute;
  top: 2px;
  left: 2px;
  transition: transform 0.2s var(--ease);
}

.switch.active .dot {
  transform: translateX(20px);
}

.progress-bar {
  width: 100%;
  height: 6px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
  margin-top: 10px;
}

.progress {
  height: 100%;
  background: var(--success);
  border-radius: 3px;
  width: 0;
  transition: width 0.4s var(--ease);
}

/* New Features and Enhancements */
.load-more-btn {
  display: block;
  margin: 16px auto;
  padding: 10px 20px;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: var(--bg-1);
  border: none;
  border-radius: 8px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s var(--ease);
}

.load-more-btn:hover,
.load-more-btn:focus {
  transform: translateY(-1px);
  box-shadow: var(--glow);
}

.chart-container canvas:hover {
  filter: brightness(1.1);
}

#portfolio-value {
  font-size: 1.2rem;
  color: var(--success);
  animation: fadeIn 1s var(--ease);
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Login Modal */
#login-modal .form-group input[type="email"],
#login-modal .form-group input[type="password"] {
  padding: 8px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.04);
  color: var(--txt);
  font-size: var(--fs-small);
}

#login-modal .form-group input:focus {
  box-shadow: var(--glow);
}

/* Responsive */
.container {
  width: 100%;
  max-width: var(--max-width);
  margin: 70px auto 20px;
  display: grid;
  grid-template-columns: 300px 1fr;
  gap: 16px;
  padding: 0 16px;
  animation: slideIn 0.4s var(--ease);
}

@keyframes slideIn {
  from { opacity: 0; transform: translateX(-20px); }
  to { opacity: 1; transform: translateX(0); }
}

@media (max-width: 980px) {
  .container {
    grid-template-columns: 1fr;
    margin-top: 65px;
  }

  .sidebar-toggle {
    display: block;
  }

  .navbar {
    height: 48px;
    padding: 6px 10px;
  }

  .nav-links {
    justify-content: flex-start;
    gap: 5px;
  }

  .nav-links li {
    margin: 2px;
  }

  .nav-links a,
  .nav-links button {
    padding: 5px 8px;
    font-size: 0.75rem;
  }

  .logo-badge {
    width: 24px;
    height: 24px;
    font-size: 0.75rem;
  }

  .search-container {
    max-width: 160px;
    margin-top: 5px;
  }

  .search-container input {
    padding: 5px 8px;
    font-size: 0.75rem;
  }

  .search-container button {
    padding: 5px;
  }

  .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    width: 260px;
    height: 100%;
    transform: translateX(-100%);
    z-index: 1500;
    transition: transform 0.3s var(--ease);
  }

  .sidebar.active {
    transform: translateX(0);
  }

  .app {
    flex-direction: column;
    height: auto;
    margin-top: 65px;
  }

  .contacts {
    width: 100%;
    min-width: unset;
    border-right: none;
    border-bottom: 1px solid rgba(255, 255, 255, 0.04);
  }

  .chat {
    width: 100%;
  }

  .status-bar {
    margin-top: 48px;
    padding: 8px;
    gap: 8px;
  }

  .status-circle {
    width: 40px;
    height: 40px;
  }

  .status-label {
    font-size: 0.75rem;
  }

  .market-grid,
  .deals-grid,
  .exchange-grid,
  .zone-grid,
  .ad-grid,
  .chat-grid,
  .business-grid {
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 12px;
  }

  .orbit-wallet {
    width: 250px;
    height: 250px;
  }

  .orbit-wallet .action {
    --size: 40px;
  }

  .profile-img-container {
    width: 80px;
    height: 80px;
  }

  .profile-img {
    width: 72px;
    height: 72px;
  }

  .wallet-card {
    padding: 16px;
  }

  .wallet-types div {
    min-width: 70px;
    padding: 10px;
  }

  .modal {
    width: 95%;
    max-width: 360px;
  }

  .view-post-modal .modal {
    max-width: 90%;
  }

  .view-post-modal .media-container img,
  .view-post-modal .media-container video {
    max-height: 250px;
  }

  .chat-body {
    padding: 12px;
  }

  .msg-row {
    max-width: 85%;
  }

  .msg {
    font-size: 0.85rem;
    padding: 8px 12px;
  }

  .chat-footer {
    padding: 10px;
  }

  .input {
    padding: 6px 10px;
  }

  .icon-btn {
    width: 34px;
    height: 34px;
  }

  .post-card {
    padding: 12px;
  }

  .post-content img,
  .post-content video {
    max-height: 200px;
  }

  .upload-form-group select,
  .upload-form-group input {
    min-width: 120px;
  }

  #upload-currency {
    width: 80px;
  }

  #video,
  #owner-video {
    max-height: 150px;
  }

  #preview-gallery img,
  #preview-gallery video {
    width: 70px;
    height: 70px;
  }
}

@media (max-width: 600px) {
  :root {
    --fs: 14px;
    --fs-heading: 1.4rem;
    --fs-subheading: 1rem;
    --fs-small: 0.75rem;
    --ui-padding: 12px;
    --card-radius: 10px;
  }

  .navbar {
    padding: 6px 8px;
  }

  .nav-links {
    gap: 4px;
  }

  .nav-links a,
  .nav-links button {
    padding: 4px 6px;
    font-size: 0.7rem;
  }

  .logo-badge {
    width: 20px;
    height: 20px;
    font-size: 0.7rem;
  }

  .search-container {
    max-width: 140px;
  }

  .search-container input {
    padding: 4px 6px;
    font-size: 0.7rem;
  }

  .search-container button {
    padding: 4px;
  }

  .status-bar {
    gap: 6px;
    padding: 6px;
  }

  .status-circle {
    width: 36px;
    height: 36px;
  }

  .sidebar {
    width: 220px;
    padding: 12px;
  }

  .sb-top {
    flex-direction: column;
    align-items: flex-start;
  }

  .logoBadge {
    width: 40px;
    height: 40px;
    font-size: 1rem;
  }

  .nav a {
    padding: 8px;
    font-size: 0.85rem;
  }

  .contacts {
    padding: 12px;
  }

  .contact-card {
    padding: 8px;
  }

  .post-profile-img {
    width: 40px;
    height: 40px;
  }

  .chat-header {
    padding: 10px 12px;
  }

  .chat-title h3 {
    font-size: 1rem;
  }

  .chat-title p {
    font-size: 0.7rem;
  }

  .tag {
    padding: 4px 8px;
    font-size: 0.7rem;
  }

  .msg-row {
    max-width: 90%;
  }

  .msg {
    padding: 6px 10px;
    font-size: 0.8rem;
  }

  .meta {
    font-size: 0.65rem;
  }

  .neg-card {
    width: 100%;
    padding: 10px;
  }

  .btn {
    padding: 5px 8px;
    font-size: 0.75rem;
  }

  .icon-btn {
    width: 30px;
    height: 30px;
  }

  .input input {
    font-size: 0.75rem;
  }

  .preview-img {
    width: 50px;
    height: 38px;
  }

  .wallet-card {
    padding: 12px;
  }

  .wallet-card h2 {
    font-size: 1rem;
  }

  .wallet-card .balance {
    font-size: 1.5rem;
  }

  .orbit-wallet {
    width: 200px;
    height: 200px;
  }

  .orbit-wallet .action {
    --size: 36px;
    font-size: 20px;
  }

  .profile-img-container {
    width: 70px;
    height: 70px;
  }

  .profile-img {
    width: 62px;
    height: 62px;
  }

  .modal {
    padding: 14px;
  }

  .modal h3 {
    font-size: 1.2rem;
  }

  .modal input,
  .modal textarea {
    padding: 10px;
    font-size: 0.75rem;
  }

  .modal button {
    padding: 10px 14px;
    font-size: 0.75rem;
  }

  .notification {
    top: 55px;
    right: 10px;
    padding: 6px 12px;
    font-size: 0.75rem;
  }

  .market-grid,
  .deals-grid,
  .exchange-grid,
  .zone-grid,
  .ad-grid,
  .chat-grid,
  .business-grid {
    grid-template-columns: 1fr;
  }

  .market-card,
  .deal-card,
  .zone-card,
  .ad-card,
  .chat-card,
  .business-card {
    padding: 12px;
  }

  .upload-form-group select,
  .upload-form-group input {
    min-width: 100%;
  }

  #upload-currency {
    width: 100%;
  }

  #video,
  #owner-video {
    max-height: 120px;
  }

  #preview-gallery img,
  #preview-gallery video {
    width: 60px;
    height: 60px;
  }

  .analytics-container {
    gap: 16px;
  }

  .stats-grid {
    grid-template-columns: 1fr;
  }

  .stat-card {
    padding: 12px;
  }

  .stat-value {
    font-size: 1.2rem;
  }

  .chart-container {
    height: 250px;
  }
}

/* Accessibility Enhancements */
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
    animation: none !important;
  }
}

@media (prefers-contrast: high) {
  :root {
    --bg-1: #000000;
    --bg-2: #1a1a1a;
    --txt: #ffffff;
    --muted: #b3b3b3;
    --focus: rgba(59, 234, 255, 0.5);
    --ui-shadow: 0 0 0 2px #ffffff;
  }

  [data-theme="light"] {
    --bg-1: #ffffff;
    --bg-2: #f0f0f0;
    --txt: #000000;
    --muted: #4d4d4d;
    --ui-shadow: 0 0 0 2px #000000;
  }

  .navbar,
  .status-bar,
  .sidebar,
  .contacts,
  .chat,
  .panel,
  .portfolio-card,
  .market-grid,
  .ai-insights-container,
  .settings-container,
  .wallet-card,
  .contact-list,
  .deals-grid,
  .referral-container,
  .upload-area,
  .exchange-container,
  .zone-container,
  .ad-container,
  .chat-container,
  .trust-container,
  .business-grid,
  .invest-container,
  .loan-container,
  .super-admin-container {
    border: 2px solid var(--txt);
  }

  .btn,
  .icon-btn,
  .status-btn,
  .load-more-btn,
  .modal button {
    outline: 2px solid var(--txt);
  }
}

/* Print Styles */
@media print {
  .navbar,
  .status-bar,
  .sidebar,
  .sidebar-toggle,
  .particles,
  .loader,
  .modal-bg,
  .notification {
    display: none;
  }

  body {
    background: #ffffff;
    color: #000000;
  }

  .container {
    margin: 0;
    padding: 0;
  }

  .app,
  .contacts,
  .chat {
    width: 100%;
    border: none;
    box-shadow: none;
  }

  .chat-body {
    overflow: visible;
  }

  .msg {
    border: 1px solid #000000;
  }

  .wallet-card,
  .post-card,
  .market-card,
  .deal-card,
  .zone-card,
  .ad-card,
  .chat-card,
  .business-card {
    border: 1px solid #000000;
    box-shadow: none;
  }

  .orbit-wallet {
    display: none;
  }
}

/* Additional Enhancements */
:focus-visible {
  outline: 2px solid var(--accent-1);
  outline-offset: 2px;
}

::selection {
  background: var(--accent-1);
  color: var(--bg-1);
}

::-webkit-input-placeholder,
::-moz-placeholder,
:-ms-input-placeholder,
:-moz-placeholder {
  color: var(--muted);
  opacity: 0.7;
}

button:disabled,
.btn:disabled,
.icon-btn:disabled,
.status-btn:disabled,
.load-more-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

input[type="range"] {
  accent-color: var(--accent-1);
}

textarea {
  resize: vertical;
}

img,
video {
  max-width: 100%;
  height: auto;
}

/* Dark Mode Scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: var(--accent-1);
  border-radius: 4px;
}

[data-theme="light"]::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.05);
}

[data-theme="light"]::-webkit-scrollbar-thumb {
  background: var(--accent-2);
}

/* Touch Optimizations */
@media (hover: none) {
  .btn:hover,
  .icon-btn:hover,
  .status-btn:hover,
  .load-more-btn:hover,
  .nav a:hover,
  .contact-card:hover,
  .post-card:hover,
  .market-card:hover,
  .deal-card:hover,
  .zone-card:hover,
  .ad-card:hover,
  .chat-card:hover,
  .business-card:hover,
  .orbit-wallet .action:hover {
    transform: none;
    box-shadow: none;
  }
}
</style>
<body data-theme="dark">
    <!-- Loader -->
    <div class="loader" id="loader" aria-hidden="true">
        <div class="xg-logo">XG</div>
    </div>

    <!-- Particles Background -->
    <div class="particles" id="particles-js" aria-hidden="true"></div>

    <!-- Notification -->
    <div class="notification" id="notification" aria-live="polite">
        <span id="notification-message"></span>
    </div>

    <!-- Header with Navbar -->
    <header class="navbar" role="navigation" aria-label="Main navigation">
        <nav>
            <ul class="nav-links">
                <li><a href="#" class="logo-badge" aria-label="XG Network Logo">XG</a></li>
                <li><a href="#home" class="nav-link active" aria-label="Home" aria-current="page"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="#portfolio" class="nav-link" aria-label="Portfolio"><i class="fas fa-briefcase"></i> Portfolio</a></li>
                <li><a href="#market" class="nav-link" aria-label="Market"><i class="fas fa-chart-line"></i> Market</a></li>
                <li><a href="#ai-insights" class="nav-link" aria-label="AI Insights"><i class="fas fa-robot"></i> XG AI Insights</a></li>
                <li><a href="#settings" class="nav-link" aria-label="Settings"><i class="fas fa-gear"></i> Settings</a></li>
                <li class="search-item">
                    <div class="search-container">
                        <input type="text" id="search-input" placeholder="Search XG Network..." aria-label="Search XG Network" autocomplete="off">
                        <button type="submit" aria-label="Search"><i class="fas fa-search"></i></button>
                        <div class="search-suggestions" id="search-suggestions" role="listbox" aria-hidden="true"></div>
                    </div>
                </li>
                <li><button class="theme-toggle status-btn" id="theme-toggle" aria-label="Toggle light/dark theme"><i class="fas fa-moon"></i></button></li>
                <li id="day-time" aria-label="Current date and time"></li>
                <li id="balance-item"><a href="#wallet" class="nav-link" aria-label="Wallet balance"><i class="fas fa-wallet"></i> <span id="balance-amount">₦4,500,000</span></a></li>
            </ul>
        </nav>
    </header>

    <!-- Sidebar Toggle -->
    <button class="sidebar-toggle status-btn" id="sidebar-toggle" aria-label="Toggle sidebar" aria-expanded="false">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Main Content -->
    <main class="container" role="main">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar" role="navigation" aria-label="Sidebar navigation">
            <div class="sb-top">
                <div class="logoBadge">XG</div>
                <div>
                    <h1 class="title">XG Network</h1>
                    <p class="desc">Welcome, Ibrahim</p>
                </div>
            </div>
            <nav class="nav" role="menu">
                <a href="#home" class="nav-link active" aria-label="Home" aria-current="page"><i class="fas fa-home"></i> Home</a>
                <a href="#profile" class="nav-link" aria-label="Profile"><i class="fas fa-user-circle"></i> Profile</a>
                <a href="#wallet" class="nav-link" aria-label="Wallet"><i class="fas fa-wallet"></i> Wallet</a>
                <a href="#trust" class="nav-link" aria-label="XG Trust"><i class="fas fa-shield-alt"></i> XG Trust</a>
                <a href="#deals" class="nav-link" aria-label="Deals"><i class="fas fa-handshake"></i> Deals</a>
                <a href="#upload" class="nav-link" aria-label="Upload Hub"><i class="fas fa-cloud-upload-alt"></i> Upload Hub</a>
                <a href="#contacts" class="nav-link" aria-label="Contacts"><i class="fas fa-users"></i> Contacts</a>
                <div class="nav-submenu" data-role="agent">
                    <a href="#business" class="nav-link" aria-label="Business Hub"><i class="fas fa-briefcase"></i> Business Hub</a>
                    <div class="submenu" role="menu">
                        <a href="#business" class="nav-link" aria-label="Business"><i class="fas fa-store"></i> Business</a>
                        <a href="#invest" class="nav-link" aria-label="Invest"><i class="fas fa-sack-dollar"></i> Invest</a>
                        <a href="#loans" class="nav-link" aria-label="Loans"><i class="fas fa-piggy-bank"></i> Loan</a>
                        <a href="#exchanges" class="nav-link" aria-label="Exchanges"><i class="fas fa-right-left"></i> Exchange</a>
                    </div>
                </div>
                <a href="#advertisement" class="nav-link" aria-label="Advertisement"><i class="fas fa-bullhorn"></i> Advertisement</a>
                <div class="nav-submenu">
                    <a href="#support" class="nav-link" aria-label="Support"><i class="fas fa-circle-info"></i> Support</a>
                    <div class="submenu" role="menu">
                        <a href="#help" class="nav-link" aria-label="Help & Support"><i class="fas fa-question-circle"></i> Support</a>
                        <a href="#privacy" class="nav-link" aria-label="Privacy & Policy"><i class="fas fa-shield-halved"></i> Privacy & Policy</a>
                    </div>
                </div>
                <a href="#insight" class="nav-link" aria-label="XG Insight"><i class="fas fa-chart-bar"></i> XG Insight</a>
                <a href="#court" class="nav-link" aria-label="Court & Legal Hub"><i class="fas fa-gavel"></i> Court & Legal Hub</a>
                <a href="#ads" class="nav-link" aria-label="Advertising"><i class="fas fa-ad"></i> Advertising</a>
                <a href="#mining" class="nav-link" aria-label="Mining & Resource Hub"><i class="fas fa-pickaxe"></i> Mining & Resource Hub</a>
                <a href="#learning" class="nav-link" aria-label="Learning & Certification"><i class="fas fa-graduation-cap"></i> Learning & Certification</a>
                <a href="#zone" class="nav-link" aria-label="Zone Management"><i class="fas fa-map-marker-alt"></i> Zone Management</a>
                <a href="#settings" class="nav-link" aria-label="Settings"><i class="fas fa-gear"></i> Settings</a>
                <a href="#logout" class="nav-link" aria-label="Log Out"><i class="fas fa-arrow-right-from-bracket"></i> Log Out</a>
            </nav>
            <div class="sb-foot">
                <span class="powered">Powered by XG</span>
                <span class="version">v3.1</span>
            </div>
        </aside>

        <!-- Main Panel -->
        <section class="panel" aria-label="Main content">
            <div class="slider-container" id="slider-container">
                <!-- Home Slide -->
                <section class="slide active-slide" id="home-slide" aria-labelledby="home-title">
                    <div class="fixed-section">
                        <div class="dashboard-header">
                            <h2 class="dashboard-title" id="home-title">Dashboard</h2>
                            <button class="status-btn" onclick="toggleXGAI()" aria-label="Toggle XG AI">Toggle XG AI</button>
                        </div>
                        <!-- Status Bar -->
                        <div class="status-bar" role="region" aria-label="User status updates">
                            <div class="status-item my-status" onclick="openMyStatus()" data-seen="true" role="button" tabindex="0" aria-label="View my status">
                                <div class="status-circle">
                                    <img src="https://via.placeholder.com/150/8b6dff" alt="My Status" loading="lazy">
                                </div>
                                <div class="status-label">My Status</div>
                            </div>
                            <div class="status-item" onclick="openStatus(0)" data-seen="false" role="button" tabindex="0" aria-label="View Aisha's status">
                                <div class="status-circle">
                                    <img src="https://via.placeholder.com/150/35e0ff" alt="Aisha's Status" loading="lazy">
                                </div>
                                <div class="status-label">Aisha</div>
                            </div>
                            <div class="status-item" onclick="openStatus(1)" data-seen="false" role="button" tabindex="0" aria-label="View Ibrahim's status">
                                <div class="status-circle">
                                    <img src="https://via.placeholder.com/150/8b6dff" alt="Ibrahim's Status" loading="lazy">
                                </div>
                                <div class="status-label">Ibrahim</div>
                            </div>
                            <div class="status-item" onclick="openStatus(2)" data-seen="false" role="button" tabindex="0" aria-label="View Usman's status">
                                <div class="status-circle">
                                    <img src="https://via.placeholder.com/150/ffd36a" alt="Usman's Status" loading="lazy">
                                </div>
                                <div class="status-label">Usman</div>
                            </div>
                        </div>
                        <!-- Orbit Wallet -->
                        <div class="orbit-wallet" aria-label="Quick actions">
                            <div class="profile-img-container">
                                <img src="https://via.placeholder.com/100/35e0ff" alt="User Profile" class="profile-img" loading="lazy">
                            </div>
                            <a href="#wallet" class="action wallet nav-link" data-label="Wallet" data-section="wallet" aria-label="Go to Wallet"><i class="fas fa-wallet"></i></a>
                            <a href="#trust" class="action trust nav-link" data-label="XG Trust" data-section="trust" aria-label="Go to XG Trust"><i class="fas fa-shield-alt"></i></a>
                            <a href="#deals" class="action deals nav-link" data-label="Deals" data-section="deals" aria-label="Go to Deals"><i class="fas fa-handshake"></i></a>
                            <a href="#upload" class="action upload nav-link" data-label="Upload" data-section="upload" aria-label="Go to Upload Hub"><i class="fas fa-cloud-upload-alt"></i></a>
                            <a href="#contacts" class="action contacts nav-link" data-label="Contacts" data-section="contacts" aria-label="Go to Contacts"><i class="fas fa-users"></i></a>
                            <a href="#exchanges" class="action exchange nav-link" data-label="Exchange" data-section="exchanges" aria-label="Go to Exchange"><i class="fas fa-right-left"></i></a>
                        </div>
                    </div>
                    <!-- Post Container -->
                    <div class="scrollable-content" id="post-container" role="region" aria-label="Latest updates">
                        <h2 class="dashboard-title">Latest Updates</h2>
                        <!-- Post 1 -->
                        <article class="post-card" data-post-id="1" aria-labelledby="post-1-title">
                            <div class="post-header">
                                <img src="https://via.placeholder.com/40/35e0ff" alt="Aisha Bello's profile" class="post-profile-img" loading="lazy">
                                <div class="post-info">
                                    <h4 id="post-1-title">Aisha Bello</h4>
                                    <p>Posted 2 hours ago • Real Estate</p>
                                </div>
                            </div>
                            <div class="post-content">
                                <p>Exciting new property listing in Lagos! Check out this modern apartment.</p>
                                <img src="https://via.placeholder.com/300x200/35e0ff" alt="Modern apartment in Lagos" class="watermarked" loading="lazy">
                            </div>
                            <div class="post-actions">
                                <button class="like-btn status-btn" onclick="toggleLike('1')" aria-label="Like post 1"><i class="far fa-heart"></i> Like</button>
                                <button class="status-btn" onclick="openCommentModal('1')" aria-label="Comment on post 1"><i class="far fa-comment"></i> Comment</button>
                                <button class="status-btn" onclick="sharePost('1')" aria-label="Share post 1"><i class="fas fa-share"></i> Share</button>
                                <button class="view-property-btn status-btn" onclick="openViewPostModal('1', 'Aisha Bello', 'Ibrahim Musa', 'Exciting new property listing in Lagos! Check out this modern apartment.', 'https://via.placeholder.com/300x200/35e0ff', '', '₦45,000,000', '/post/1')" aria-label="View post 1 details"><i class="fas fa-eye"></i> View Post</button>
                            </div>
                        </article>
                        <!-- Post 2 -->
                        <article class="post-card" data-post-id="2" aria-labelledby="post-2-title">
                            <div class="post-header">
                                <img src="https://via.placeholder.com/40/ffd36a" alt="Usman Danjuma's profile" class="post-profile-img" loading="lazy">
                                <div class="post-info">
                                    <h4 id="post-2-title">Usman Danjuma</h4>
                                    <p>Posted 4 hours ago • Crypto</p>
                                </div>
                            </div>
                            <div class="post-content">
                                <p>New crypto trading strategy shared! Watch the video below.</p>
                                <video src="https://via.placeholder.com/300x200.mp4" controls class="watermarked" aria-label="Crypto trading strategy video"></video>
                            </div>
                            <div class="post-actions">
                                <button class="like-btn status-btn" onclick="toggleLike('2')" aria-label="Like post 2"><i class="far fa-heart"></i> Like</button>
                                <button class="status-btn" onclick="openCommentModal('2')" aria-label="Comment on post 2"><i class="far fa-comment"></i> Comment</button>
                                <button class="status-btn" onclick="sharePost('2')" aria-label="Share post 2"><i class="fas fa-share"></i> Share</button>
                                <button class="view-property-btn status-btn" onclick="openViewPostModal('2', 'Usman Danjuma', 'Maryam Ali', 'New crypto trading strategy shared! Watch the video below.', '', 'https://via.placeholder.com/300x200.mp4', '₦0', '/post/2')" aria-label="View post 2 details"><i class="fas fa-eye"></i> View Post</button>
                            </div>
                        </article>
                        <!-- Post 3 -->
                        <article class="post-card" data-post-id="3" aria-labelledby="post-3-title">
                            <div class="post-header">
                                <img src="https://via.placeholder.com/40/8b6dff" alt="Ibrahim Adeyemi's profile" class="post-profile-img" loading="lazy">
                                <div class="post-info">
                                    <h4 id="post-3-title">Ibrahim Adeyemi</h4>
                                    <p>Posted 6 hours ago • Real Estate</p>
                                </div>
                            </div>
                            <div class="post-content">
                                <p>Luxury villa for sale in Abuja!</p>
                                <img src="https://via.placeholder.com/300x200/8b6dff" alt="Luxury villa in Abuja" class="watermarked" loading="lazy">
                            </div>
                            <div class="post-actions">
                                <button class="like-btn status-btn" onclick="toggleLike('3')" aria-label="Like post 3"><i class="far fa-heart"></i> Like</button>
                                <button class="status-btn" onclick="openCommentModal('3')" aria-label="Comment on post 3"><i class="far fa-comment"></i> Comment</button>
                                <button class="status-btn" onclick="sharePost('3')" aria-label="Share post 3"><i class="fas fa-share"></i> Share</button>
                                <button class="view-property-btn status-btn" onclick="openViewPostModal('3', 'Ibrahim Adeyemi', 'John Smith', 'Luxury villa for sale in Abuja!', 'https://via.placeholder.com/300x200/8b6dff', '', '₦120,000,000', '/post/3')" aria-label="View post 3 details"><i class="fas fa-eye"></i> View Post</button>
                            </div>
                        </article>
                        <!-- Post 4 -->
                        <article class="post-card" data-post-id="4" aria-labelledby="post-4-title">
                            <div class="post-header">
                                <img src="https://via.placeholder.com/40/ffd36a" alt="Fatima Adebayo's profile" class="post-profile-img" loading="lazy">
                                <div class="post-info">
                                    <h4 id="post-4-title">Fatima Adebayo</h4>
                                    <p>Posted 8 hours ago • Real Estate</p>
                                </div>
                            </div>
                            <div class="post-content">
                                <p>New commercial property available!</p>
                                <img src="https://via.placeholder.com/300x200/ffd36a" alt="Commercial property" class="watermarked" loading="lazy">
                            </div>
                            <div class="post-actions">
                                <button class="like-btn status-btn" onclick="toggleLike('4')" aria-label="Like post 4"><i class="far fa-heart"></i> Like</button>
                                <button class="status-btn" onclick="openCommentModal('4')" aria-label="Comment on post 4"><i class="far fa-comment"></i> Comment</button>
                                <button class="status-btn" onclick="sharePost('4')" aria-label="Share post 4"><i class="fas fa-share"></i> Share</button>
                                <button class="view-property-btn status-btn" onclick="openViewPostModal('4', 'Fatima Adebayo', 'Ahmed Yusuf', 'New commercial property available!', 'https://via.placeholder.com/300x200/ffd36a', '', '₦85,000,000', '/post/4')" aria-label="View post 4 details"><i class="fas fa-eye"></i> View Post</button>
                            </div>
                        </article>
                        <!-- Post 5 -->
                        <article class="post-card" data-post-id="5" aria-labelledby="post-5-title">
                            <div class="post-header">
                                <img src="https://via.placeholder.com/40/35e0ff" alt="Chinedu Okeke's profile" class="post-profile-img" loading="lazy">
                                <div class="post-info">
                                    <h4 id="post-5-title">Chinedu Okeke</h4>
                                    <p>Posted 10 hours ago • Crypto</p>
                                </div>
                            </div>
                            <div class="post-content">
                                <p>Crypto market analysis for Q4.</p>
                                <video src="https://via.placeholder.com/300x200.mp4" controls class="watermarked" aria-label="Crypto market analysis video"></video>
                            </div>
                            <div class="post-actions">
                                <button class="like-btn status-btn" onclick="toggleLike('5')" aria-label="Like post 5"><i class="far fa-heart"></i> Like</button>
                                <button class="status-btn" onclick="openCommentModal('5')" aria-label="Comment on post 5"><i class="far fa-comment"></i> Comment</button>
                                <button class="status-btn" onclick="sharePost('5')" aria-label="Share post 5"><i class="fas fa-share"></i> Share</button>
                                <button class="view-property-btn status-btn" onclick="openViewPostModal('5', 'Chinedu Okeke', 'Maryam Ali', 'Crypto market analysis for Q4.', '', 'https://via.placeholder.com/300x200.mp4', '₦0', '/post/5')" aria-label="View post 5 details"><i class="fas fa-eye"></i> View Post</button>
                            </div>
                        </article>
                    </div>
                </section>
                <!-- Portfolio Slide -->
                <section class="slide" id="portfolio-slide" aria-labelledby="portfolio-title">
                    <div class="portfolio-card">
                        <h2 class="dashboard-title" id="portfolio-title">Portfolio Overview</h2>
                        <div class="balance-info">
                            <p>Total Balance</p>
                            <h2>₦4,500,000</h2>
                        </div>
                        <div class="portfolio-types">
                            <button class="status-btn" type="button" aria-label="View Real Estate portfolio"><i class="fas fa-home"></i> Real Estate</button>
                            <button class="status-btn" type="button" aria-label="View Crypto portfolio"><i class="fas fa-bitcoin"></i> Crypto</button>
                            <button class="status-btn" type="button" aria-label="View Deals portfolio"><i class="fas fa-handshake"></i> Deals</button>
                        </div>
                    </div>
                </section>
                <!-- Market Slide -->
                <section class="slide" id="market-slide" aria-labelledby="market-title">
                    <div class="market-grid">
                        <h2 class="dashboard-title" id="market-title">Market Trends</h2>
                        <div class="market-card">
                            <h4>Bitcoin (BTC)</h4>
                            <p>Price: $45,000</p>
                            <p>Change: +2.5%</p>
                            <div class="progress">
                                <div class="progress-bar" style="width: 70%" aria-label="Bitcoin progress 70%"></div>
                            </div>
                        </div>
                        <div class="market-card">
                            <h4>Ethereum (ETH)</h4>
                            <p>Price: $3,200</p>
                            <p>Change: -1.8%</p>
                            <div class="progress">
                                <div class="progress-bar" style="width: 40%" aria-label="Ethereum progress 40%"></div>
                            </div>
                        </div>
                        <div class="market-card">
                            <h4>Lagos Property Index</h4>
                            <p>Value: ₦12,500,000</p>
                            <p>Change: +3.1%</p>
                            <div class="progress">
                                <div class="progress-bar" style="width: 80%" aria-label="Lagos Property Index progress 80%"></div>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- AI Insights Slide -->
                <section class="slide" id="ai-insights-slide" aria-labelledby="ai-insights-title">
                    <div class="ai-insights-container">
                        <h2 class="dashboard-title" id="ai-insights-title">XG AI Insights</h2>
                        <div class="insight-item">
                            <h4>Market Prediction</h4>
                            <p>Bitcoin likely to rise by 5% in the next week based on current trends.</p>
                        </div>
                        <div class="insight-item">
                            <h4>Real Estate Opportunity</h4>
                            <p>High demand for commercial properties in Lagos. Consider investing.</p>
                        </div>
                        <div class="insight-item">
                            <h4>Negotiation Tip</h4>
                            <p>Use data-driven insights to strengthen your position in real estate deals.</p>
                        </div>
                    </div>
                </section>
                <!-- Wallet Slide -->
                <section class="slide" id="wallet-slide" aria-labelledby="wallet-title">
                    <div class="wallet-card">
                        <h2 id="wallet-title">Wallet (XG-234aa)</h2>
                        <p>Ibrahim Alhassan</p>
                        <div class="balance">₦4,500,000 / 0.5 BTC</div>
                        <div class="wallet-types">
                            <button class="status-btn" data-type="crypto" aria-label="View Crypto wallet">Crypto</button>
                            <button class="status-btn" data-type="fiat" aria-label="View Fiat wallet">Fiat</button>
                            <button class="status-btn" data-type="real-estate" aria-label="View Real Estate wallet">Real Estate</button>
                        </div>
                    </div>
                    <div class="wallet-actions">
                        <button class="status-btn" onclick="openDepositModal()" aria-label="Deposit funds">Deposit</button>
                        <button class="status-btn" onclick="openWithdrawModal()" aria-label="Withdraw funds">Withdraw</button>
                        <button class="status-btn" onclick="openTransferModal()" aria-label="Transfer funds">Transfer</button>
                    </div>
                    <div class="transactions">
                        <h3>Recent Transactions</h3>
                        <div class="transaction-controls">
                            <div class="search-box">
                                <input type="text" placeholder="Search transactions..." aria-label="Search transactions">
                            </div>
                            <div class="transaction-filters">
                                <button class="filter-btn status-btn active" data-filter="all" aria-label="Show all transactions">All</button>
                                <button class="filter-btn status-btn" data-filter="crypto" aria-label="Show crypto transactions">Crypto</button>
                                <button class="filter-btn status-btn" data-filter="fiat" aria-label="Show fiat transactions">Fiat</button>
                                <select class="category-filter" aria-label="Filter by category">
                                    <option value="all">All Categories</option>
                                    <option value="real-estate">Real Estate</option>
                                    <option value="crypto">Crypto</option>
                                </select>
                            </div>
                        </div>
                        <div class="transaction-item">
                            <div class="desc">
                                <div class="icon"><i class="fas fa-home"></i></div>
                                <div>
                                    <h4>Property Purchase</h4>
                                    <div class="details">Lagos • 08/31/2025</div>
                                </div>
                            </div>
                            <div class="amount positive">+₦1,200,000</div>
                        </div>
                        <div class="transaction-item">
                            <div class="desc">
                                <div class="icon"><i class="fas fa-bitcoin"></i></div>
                                <div>
                                    <h4>BTC Sale</h4>
                                    <div class="details">Crypto • 08/30/2025</div>
                                </div>
                            </div>
                            <div class="amount negative">-₦500,000</div>
                        </div>
                    </div>
                </section>
                <!-- Trust Slide -->
                <section class="slide" id="trust-slide" aria-labelledby="trust-title">
  <div class="trust-container">
    <h2 class="dashboard-title" id="trust-title">🚀 XG Trust: Secure Your Future & Unlock Rewards!</h2>

    <!-- Tasks Management -->
    <div class="trust-item">
      <div class="desc">
        <div class="icon"><i class="fas fa-tasks"></i></div>
        <div>
          <h4>Tasks Management</h4>
          <div class="details" id="tasks-details">Earn rewards from quick gigs • <span id="tasks-active">5 Active tasks</span> • <span id="tasks-countdown"></span></div>
          <div class="progress-bar"><div id="tasks-progress" style="width: 60%;"></div></div> <!-- New: Progress bar -->
        </div>
      </div>
      <div class="amount positive" id="tasks-amount">+₦4,500</div>
      <button class="status-btn" id="tasks-btn" aria-label="View Tasks">View Tasks</button>
    </div>

    <!-- Bonus System -->
    <div class="trust-item">
      <div class="desc">
        <div class="icon"><i class="fas fa-gift"></i></div>
        <div>
          <h4>Bonus System</h4>
          <div class="details" id="bonus-details">Unlock daily & performance bonuses • <span id="bonus-countdown"></span></div>
          <div class="progress-bar"><div id="bonus-progress" style="width: 80%;"></div></div> <!-- New: Progress bar -->
        </div>
      </div>
      <div class="amount positive" id="bonus-amount">+₦1,200</div>
      <button class="status-btn" id="bonus-btn" aria-label="Claim Bonus">Claim Bonus</button>
    </div>

    <!-- Escrow Service -->
    <div class="trust-item">
      <div class="desc">
        <div class="icon"><i class="fas fa-shield-alt"></i></div>
        <div>
          <h4>Escrow Service</h4>
          <div class="details">Protect your real estate deals • Secure & reliable • <span id="escrow-countdown"></span></div>
          <div class="progress-bar"><div id="escrow-progress" style="width: 40%;"></div></div> <!-- New: Progress bar -->
        </div>
      </div>
      <div class="amount positive" id="escrow-amount">+₦2,000,000</div>
      <button class="status-btn" id="escrow-btn" aria-label="Start Escrow">Start Escrow</button>
    </div>

    <!-- Deal Guarantee -->
    <div class="trust-item">
      <div class="desc">
        <div class="icon"><i class="fas fa-handshake"></i></div>
        <div>
          <h4>Deal Guarantee</h4>
          <div class="details">Safeguard your crypto trades • Risk-free assurance • <span id="deal-countdown"></span></div>
          <div class="progress-bar"><div id="deal-progress" style="width: 70%;"></div></div> <!-- New: Progress bar -->
        </div>
      </div>
      <div class="amount positive" id="deal-amount">+0.1 BTC</div>
      <button class="status-btn" id="deal-btn" aria-label="View Deal">View Deal</button>
    </div>

    <!-- New Feature: Leaderboard Snippet -->
    <div class="leaderboard-snippet">
      <h4>🏆 Top Earners This Week</h4>
      <ul id="leaderboard-list">
        <li>UserA: ₦10,000</li>
        <li>UserB: ₦8,500</li>
        <li>You: ₦4,500</li>
      </ul>
      <button class="status-btn" id="leaderboard-btn">View Full Leaderboard</button>
    </div>

    <!-- New Feature: Referral System -->
    <div class="referral-section">
      <h4>👥 Refer Friends & Earn More!</h4>
      <p>Share your code: <strong id="referral-code">XGTRUST123</strong> • Rewards: ₦500 per referral</p>
      <button class="status-btn" id="referral-btn">Generate Link</button>
    </div>

  </div>
</section>

<!-- Modal HTML -->
<div class="modal-bg" id="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; align-items: center; justify-content: center;">
  <div class="modal" style="background: white; padding: 20px; width: 80%; max-width: 600px; border-radius: 8px; position: relative; box-shadow: 0 4px 20px rgba(0,0,0,0.2);">
    <span class="close" id="close-modal" style="position: absolute; right: 15px; top: 10px; font-size: 28px; cursor: pointer; color: #aaa;" aria-label="Close modal">&times;</span>
    <h3 id="modal-title" style="margin-bottom: 20px; text-align: center;"></h3>
    <div id="modal-content" class="modal-content" style="line-height: 1.6;"></div>
  </div>
</div>

<!-- New: Notification Toast -->
<div id="notification-toast" style="display: none; position: fixed; bottom: 20px; right: 20px; background: #4caf50; color: white; padding: 15px; border-radius: 5px; z-index: 10000; box-shadow: 0 2px 10px rgba(0,0,0,0.2);"></div>

<script>
// Wrap everything in DOMContentLoaded
document.addEventListener('DOMContentLoaded', function() {
    // Elements
    const modalBg = document.getElementById('modal');
    const modalTitle = document.getElementById('modal-title');
    const modalContent = document.getElementById('modal-content');
    const closeBtn = document.getElementById('close-modal');
    const toast = document.getElementById('notification-toast');

    if (!modalBg || !modalTitle || !modalContent) {
        console.error('Modal elements not found!');
        return;
    }

    // Modal functions
    function openModal(title, content) {
        modalTitle.innerText = title;
        modalContent.innerHTML = content;
        modalBg.style.display = 'flex';
        document.body.style.overflow = 'hidden';
        console.log('Modal opened:', title);
    }

    function closeModal() {
        modalBg.style.display = 'none';
        document.body.style.overflow = 'auto';
        console.log('Modal closed');
    }

    // Event listeners for modal
    modalBg.addEventListener('click', (e) => { if (e.target === modalBg) closeModal(); });
    closeBtn.addEventListener('click', closeModal);
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

    // New: Show notification toast
    function showToast(message, duration = 3000) {
        toast.innerText = message;
        toast.style.display = 'block';
        setTimeout(() => { toast.style.display = 'none'; }, duration);
    }

    // New: Animate amount update
    function animateAmount(id, newValue) {
        const elem = document.getElementById(id);
        elem.classList.add('amount-animate'); // Assume CSS: .amount-animate { animation: pulse 0.5s; }
        setTimeout(() => { elem.classList.remove('amount-animate'); }, 500);
        elem.innerText = newValue;
    }

    // Countdown setup
    const countdowns = {
        tasks: new Date(Date.now() + 2 * 60 * 60 * 1000),
        bonus: new Date(Date.now() + 24 * 60 * 60 * 1000),
        escrow: new Date(Date.now() + 6 * 60 * 60 * 1000),
        deal: new Date(Date.now() + 12 * 60 * 60 * 1000)
    };

    function updateCountdowns() {
        const now = Date.now();
        for (const key in countdowns) {
            const distance = countdowns[key].getTime() - now;
            let display = '';
            if (distance > 0) {
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                display = days > 0 ? `${days}d ` : '';
                display += `${hours}h ${minutes}m ${seconds}s remaining`;
            } else {
                display = '⏰ Expired - Renew Now!';
            }
            const el = document.getElementById(`${key}-countdown`);
            if (el) el.textContent = display;
        }
    }

    setInterval(updateCountdowns, 1000);
    updateCountdowns();

    // Helper functions
    window.claimTask = function(taskName, reward) {
        showToast(`✅ ${taskName} claimed! +₦${reward} added to your balance.`);
        // Simulate update
        const currentAmount = parseInt(document.getElementById('tasks-amount').innerText.replace(/[^\d]/g, ''));
        animateAmount('tasks-amount', `+₦${currentAmount + reward}`);
        closeModal();
    };

    window.claimBonus = function(bonusType, reward) {
        showToast(`🎉 ${bonusType} bonus claimed! +₦${reward} added.`);
        const currentAmount = parseInt(document.getElementById('bonus-amount').innerText.replace(/[^\d]/g, ''));
        animateAmount('bonus-amount', `+₦${currentAmount + reward}`);
        closeModal();
    };

    window.startEscrow = function() {
        showToast('🔒 Escrow initiated successfully!');
        closeModal();
    };

    window.viewDeal = function() {
        showToast('📊 Deal viewed - Proceed with trade!');
        closeModal();
    };

    // Modal open functions (enhanced with more items and animations)
    function openTasksModal() {
        openModal('📋 Tasks Management - Level Up Your Earnings!', `
            <ul style="list-style: none; padding: 0;">
                <li style="margin-bottom: 10px;"><strong>Survey: Real Estate Trends</strong> - Reward: ₦500 
                    <button onclick="claimTask('Survey', 500)" style="margin-left: 10px; padding: 5px 10px; background: #4fd1c7; color: white; border: none; border-radius: 4px; cursor: pointer;">Claim Now</button></li>
                <li style="margin-bottom: 10px;"><strong>Review: Property Listings</strong> - Reward: ₦1,000 
                    <button onclick="claimTask('Review', 1000)" style="margin-left: 10px; padding: 5px 10px; background: #4fd1c7; color: white; border: none; border-radius: 4px; cursor: pointer;">Claim Now</button></li>
                <li style="margin-bottom: 10px;"><strong>Verification: Document Check</strong> - Reward: ₦3,000 
                    <button onclick="claimTask('Verification', 3000)" style="margin-left: 10px; padding: 5px 10px; background: #4fd1c7; color: white; border: none; border-radius: 4px; cursor: pointer;">Claim Now</button></li>
                <li style="margin-bottom: 10px;"><strong>New: Social Share Challenge</strong> - Reward: ₦200 
                    <button onclick="claimTask('Social Share', 200)" style="margin-left: 10px; padding: 5px 10px; background: #4fd1c7; color: white; border: none; border-radius: 4px; cursor: pointer;">Claim Now</button></li>
            </ul>
            <p style="margin-top: 15px; font-style: italic; color: #666;">💡 Tip: Complete tasks to fill your progress bar and unlock badges!</p>
        `);
    }

    function openBonusModal() {
        openModal('🎁 Bonus System - Daily Surprises Await!', `
            <ul style="list-style: none; padding: 0;">
                <li style="margin-bottom: 10px;"><strong>Daily Login Bonus</strong> - ₦50 
                    <button onclick="claimBonus('Daily', 50)" style="margin-left: 10px; padding: 5px 10px; background: #4fd1c7; color: white; border: none; border-radius: 4px; cursor: pointer;">Claim</button></li>
                <li style="margin-bottom: 10px;"><strong>Weekly Performance Streak</strong> - ₦1,150 
                    <button onclick="claimBonus('Streak', 1150)" style="margin-left: 10px; padding: 5px 10px; background: #4fd1c7; color: white; border: none; border-radius: 4px; cursor: pointer;">Claim</button></li>
                <li style="margin-bottom: 10px;"><strong>New: Mystery Box</strong> - Up to ₦500 
                    <button onclick="claimBonus('Mystery', Math.floor(Math.random() * 500) + 1)" style="margin-left: 10px; padding: 5px 10px; background: #4fd1c7; color: white; border: none; border-radius: 4px; cursor: pointer;">Open Box</button></li>
            </ul>
            <p style="margin-top: 15px; font-style: italic; color: #666;">🌟 Pro Tip: Chain bonuses for multipliers - x2 on streaks!</p>
        `);
    }

    function openEscrowModal() {
        openModal('🛡️ Escrow Service - Ironclad Protection', `
            <div style="text-align: center;">
                <p>Launch a bulletproof escrow for your real estate transaction. Funds locked until mutual agreement!</p>
                <input type="text" placeholder="Enter deal amount (₦)" style="width: 100%; padding: 10px; margin: 10px 0;" id="escrow-amount-input">
                <button onclick="startEscrow()" style="width: 100%; padding: 12px; margin-top: 10px; font-size: 1.1rem; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">🚀 Initiate Secure Escrow</button>
            </div>
            <p style="margin-top: 15px; font-style: italic; color: #28a745;">✅ New: Real-time status tracking via email notifications.</p>
        `);
    }

    function openDealModal() {
        openModal('🤝 Deal Guarantee - Trade with Confidence', `
            <div style="text-align: center;">
                <p>Explore your guaranteed crypto deal: 0.1 BTC secured against defaults or disputes.</p>
                <select style="width: 100%; padding: 10px; margin: 10px 0;">
                    <option>Bitcoin (BTC)</option>
                    <option>Ethereum (ETH)</option>
                    <option>New: Solana (SOL)</option>
                </select>
                <button onclick="viewDeal()" style="width: 100%; padding: 12px; margin-top: 10px; font-size: 1.1rem; background: #fd7e14; color: white; border: none; border-radius: 4px; cursor: pointer;">🔍 Review & Confirm Deal</button>
            </div>
            <p style="margin-top: 15px; font-style: italic; color: #fd7e14;">⚡ New: Instant price quotes and conversion tools.</p>
        `);
    }

    // New: Leaderboard Modal
    function openLeaderboardModal() {
        openModal('🏆 Full Leaderboard - Climb the Ranks!', `
            <ul style="list-style: none; padding: 0;">
                <li style="margin-bottom: 10px;">1. UserA: ₦15,000 🥇</li>
                <li style="margin-bottom: 10px;">2. UserB: ₦12,000 🥈</li>
                <li style="margin-bottom: 10px;">3. UserC: ₦10,500 🥉</li>
                <li style="margin-bottom: 10px;">4. You: ₦4,500 📈</li>
            </ul>
            <p style="margin-top: 15px; font-style: italic; color: #666;">Challenge friends to beat their scores!</p>
        `);
    }

    // New: Referral Modal
    function openReferralModal() {
        const link = 'https://xgtrust.com/refer?code=' + document.getElementById('referral-code').innerText;
        showToast('🔗 Referral link copied to clipboard!');
        navigator.clipboard.writeText(link); // Copy to clipboard
        openModal('👥 Referral System - Spread the Wealth!', `
            <p>Your unique referral link: <a href="${link}" style="color: #4fd1c7;">${link}</a></p>
            <p>Share on social media and earn ₦500 per successful referral!</p>
            <button onclick="closeModal()" style="width: 100%; padding: 12px; background: #4fd1c7; color: white; border: none; border-radius: 4px; cursor: pointer;">Close</button>
        `);
    }

    // Attach button listeners
    document.getElementById('tasks-btn').addEventListener('click', openTasksModal);
    document.getElementById('bonus-btn').addEventListener('click', openBonusModal);
    document.getElementById('escrow-btn').addEventListener('click', openEscrowModal);
    document.getElementById('deal-btn').addEventListener('click', openDealModal);
    document.getElementById('leaderboard-btn').addEventListener('click', openLeaderboardModal);
    document.getElementById('referral-btn').addEventListener('click', openReferralModal);

    // New: Simulate progress bar updates every 5 seconds
    function updateProgressBars() {
        document.getElementById('tasks-progress').style.width = `${Math.random() * 100}%`;
        document.getElementById('bonus-progress').style.width = `${Math.random() * 100}%`;
        document.getElementById('escrow-progress').style.width = `${Math.random() * 100}%`;
        document.getElementById('deal-progress').style.width = `${Math.random() * 100}%`;
    }
    setInterval(updateProgressBars, 5000);
    updateProgressBars();

    console.log('Enhanced script loaded with new features!');
});
</script>
               <!-- Deals Slide -->
<section class="slide" id="deals-slide" aria-labelledby="deals-title">
  <div class="deals-header">
    <h2 class="dashboard-title" id="deals-title">🔥 Hot Deals: Invest Smart, Earn Big!</h2>
    <div class="deals-controls">
      <!-- New Feature: User Auth Status -->
      <div class="user-auth" style="display: flex; align-items: center; gap: 10px;">
        <span id="user-status" style="color: var(--txt);">Guest</span>
        <button id="auth-btn" onclick="toggleAuth()" style="padding: 8px 16px; background: var(--accent-1); color: var(--bg-1); border: none; border-radius: 5px; cursor: pointer;">Login</button>
      </div>
      <!-- Search and Filter -->
      <div class="deals-filter">
        <input type="text" id="deal-search" placeholder="Search deals..." aria-label="Search deals" style="padding: 10px; border-radius: 5px; border: 1px solid var(--muted); background: var(--bg-2); color: var(--txt); margin-right: 10px;">
        <select id="deal-filter" aria-label="Filter deals by status" style="padding: 10px; border-radius: 5px; border: 1px solid var(--muted); background: var(--bg-2); color: var(--txt);">
          <option value="all">All Statuses</option>
          <option value="negotiating">Negotiating</option>
          <option value="pending">Pending</option>
          <option value="ongoing">Ongoing</option>
        </select>
      </div>
    </div>
  </div>

  <div class="deals-grid" id="deals-grid">
    <!-- Deal Card 1 -->
    <div class="deal-card" id="property-deal" data-status="negotiating">
      <div class="deal-icon"><i class="fas fa-home"></i></div>
      <h4>🏠 Luxury Property Flip</h4>
      <p>Prime villa in Abuja - ₦15,000,000 | ROI: 25% in 6 months</p>
      <div class="progress-bar">
        <div class="progress" id="property-progress" style="width: 30%;"></div>
      </div>
      <div class="deal-meta">
        <span class="status-badge negotiating">Negotiating</span>
        <span class="amount">+₦15M Potential</span>
        <!-- New Feature: Favorite Button -->
        <button class="favorite-btn" onclick="toggleFavorite('Property Deal')" aria-label="Favorite property deal"><i class="fas fa-star" id="favorite-property-deal"></i></button>
      </div>
      <button class="subscribe-btn status-btn" onclick="openDealModal('Property Deal')" aria-label="Negotiate property deal">🚀 Negotiate Now</button>
      <!-- New Feature: Share Button -->
      <button class="share-btn" onclick="shareDeal('Property Deal')" style="margin-top: 10px; background: var(--accent-2); color: var(--bg-1); border: none; border-radius: 5px; padding: 8px; width: 100%;">Share Deal</button>
    </div>

    <!-- Deal Card 2 -->
    <div class="deal-card" id="crypto-deal" data-status="pending">
      <div class="deal-icon"><i class="fas fa-bitcoin"></i></div>
      <h4>₿ Crypto Venture Fund</h4>
      <p>0.5 BTC for AI startup - High-growth potential</p>
      <div class="progress-bar">
        <div class="progress" id="crypto-progress" style="width: 0%;"></div>
      </div>
      <div class="deal-meta">
        <span class="status-badge pending">Pending</span>
        <span class="amount">+0.5 BTC Yield</span>
        <button class="favorite-btn" onclick="toggleFavorite('Crypto Investment')" aria-label="Favorite crypto deal"><i class="fas fa-star" id="favorite-crypto-deal"></i></button>
      </div>
      <button class="subscribe-btn status-btn" onclick="openDealModal('Crypto Investment')" aria-label="Invest in crypto">💰 Invest Now</button>
      <button class="share-btn" onclick="shareDeal('Crypto Investment')" style="margin-top: 10px; background: var(--accent-2); color: var(--bg-1); border: none; border-radius: 5px; padding: 8px; width: 100%;">Share Deal</button>
    </div>

    <!-- Deal Card 3 -->
    <div class="deal-card" id="business-deal" data-status="pending">
      <div class="deal-icon"><i class="fas fa-briefcase"></i></div>
      <h4>💼 Business Expansion</h4>
      <p>E-commerce platform in Lagos - ₦5,000,000 | 20% Equity</p>
      <div class="progress-bar">
        <div class="progress" id="business-progress" style="width: 15%;"></div>
      </div>
      <div class="deal-meta">
        <span class="status-badge pending">New Launch</span>
        <span class="amount">+20% Equity</span>
        <button class="favorite-btn" onclick="toggleFavorite('Business Expansion')" aria-label="Favorite business deal"><i class="fas fa-star" id="favorite-business-deal"></i></button>
      </div>
      <button class="subscribe-btn status-btn" onclick="openDealModal('Business Expansion')" aria-label="Invest in business">🌟 Launch Deal</button>
      <button class="share-btn" onclick="shareDeal('Business Expansion')" style="margin-top: 10px; background: var(--accent-2); color: var(--bg-1); border: none; border-radius: 5px; padding: 8px; width: 100%;">Share Deal</button>
    </div>

    <!-- Deal Card 4 -->
    <div class="deal-card" id="tech-deal" data-status="ongoing">
      <div class="deal-icon"><i class="fas fa-rocket"></i></div>
      <h4>🚀 Tech Startup Seed</h4>
      <p>Fintech app in Lagos - ₦8,000,000 | 15% ROI projected</p>
      <div class="progress-bar">
        <div class="progress" id="tech-progress" style="width: 45%;"></div>
      </div>
      <div class="deal-meta">
        <span class="status-badge ongoing">Ongoing</span>
        <span class="amount">+15% ROI</span>
        <button class="favorite-btn" onclick="toggleFavorite('Tech Startup')" aria-label="Favorite tech deal"><i class="fas fa-star" id="favorite-tech-deal"></i></button>
      </div>
      <button class="subscribe-btn status-btn" onclick="openDealModal('Tech Startup')" aria-label="Join tech deal">⚡ Join Now</button>
      <button class="share-btn" onclick="shareDeal('Tech Startup')" style="margin-top: 10px; background: var(--accent-2); color: var(--bg-1); border: none; border-radius: 5px; padding: 8px; width: 100%;">Share Deal</button>
    </div>

    <!-- Deal Card 5 -->
    <div class="deal-card" id="green-energy-deal" data-status="pending">
      <div class="deal-icon"><i class="fas fa-leaf"></i></div>
      <h4>🌿 Green Energy Project</h4>
      <p>Solar farm in Kano - ₦10,000,000 | ROI: 18% in 12 months</p>
      <div class="progress-bar">
        <div class="progress" id="green-energy-progress" style="width: 5%;"></div>
      </div>
      <div class="deal-meta">
        <span class="status-badge pending">Pending</span>
        <span class="amount">+₦10M Potential</span>
        <button class="favorite-btn" onclick="toggleFavorite('Green Energy Project')" aria-label="Favorite green energy deal"><i class="fas fa-star" id="favorite-green-energy-deal"></i></button>
      </div>
      <button class="subscribe-btn status-btn" onclick="openDealModal('Green Energy Project')" aria-label="Invest in green energy">🍃 Invest Now</button>
      <button class="share-btn" onclick="shareDeal('Green Energy Project')" style="margin-top: 10px; background: var(--accent-2); color: var(--bg-1); border: none; border-radius: 5px; padding: 8px; width: 100%;">Share Deal</button>
    </div>

    <!-- Deal Card 6 -->
    <div class="deal-card" id="art-nft-deal" data-status="negotiating">
      <div class="deal-icon"><i class="fas fa-palette"></i></div>
      <h4>🎨 Art NFT Collection</h4>
      <p>Exclusive digital art series - 1 ETH | High resale value</p>
      <div class="progress-bar">
        <div class="progress" id="art-nft-progress" style="width: 20%;"></div>
      </div>
      <div class="deal-meta">
        <span class="status-badge negotiating">Negotiating</span>
        <span class="amount">+1 ETH Yield</span>
        <button class="favorite-btn" onclick="toggleFavorite('Art NFT Collection')" aria-label="Favorite NFT deal"><i class="fas fa-star" id="favorite-art-nft-deal"></i></button>
      </div>
      <button class="subscribe-btn status-btn" onclick="openDealModal('Art NFT Collection')" aria-label="Negotiate NFT deal">🖼️ Negotiate Now</button>
      <button class="share-btn" onclick="shareDeal('Art NFT Collection')" style="margin-top: 10px; background: var(--accent-2); color: var(--bg-1); border: none; border-radius: 5px; padding: 8px; width: 100%;">Share Deal</button>
    </div>
  </div>

  <!-- Enhanced Quick Stats -->
  <div class="deals-stats">
    <div class="stat-item">
      <i class="fas fa-chart-line"></i>
      <span>Total Deals: <span id="total-deals">6</span> Active</span>
    </div>
    <div class="stat-item">
      <i class="fas fa-trophy"></i>
      <span>Success Rate: 92%</span>
    </div>
    <div class="stat-item">
      <i class="fas fa-clock"></i>
      <span>Avg. ROI: 22%</span>
    </div>
    <div class="stat-item">
      <i class="fas fa-users"></i>
      <span>Investors: 1,250+</span>
    </div>
    <div class="stat-item">
      <i class="fas fa-dollar-sign"></i>
      <span>Total Funded: ₦50M</span>
    </div>
    <div class="stat-item">
      <i class="fas fa-wallet"></i>
      <span id="portfolio-value">Portfolio: ₦0</span>
    </div>
  </div>

  <!-- New Feature: Deal Comparison Tool -->
  <div class="deal-comparison" style="margin-top: 30px; padding: 20px; background: var(--bg-2); border-radius: var(--card-radius); box-shadow: var(--ui-shadow);">
    <h3 style="color: var(--txt); margin-bottom: 15px;">⚖️ Compare Deals</h3>
    <div class="comparison-controls" style="display: flex; flex-wrap: wrap; gap: 10px;">
      <select id="compare-deal-1" aria-label="Select first deal to compare" style="flex: 1; padding: 10px; border-radius: 5px; border: 1px solid var(--muted); background: var(--bg-1); color: var(--txt);">
        <option value="">Select Deal 1</option>
      </select>
      <select id="compare-deal-2" aria-label="Select second deal to compare" style="flex: 1; padding: 10px; border-radius: 5px; border: 1px solid var(--muted); background: var(--bg-1); color: var(--txt);">
        <option value="">Select Deal 2</option>
      </select>
      <select id="compare-deal-3" aria-label="Select third deal to compare" style="flex: 1; padding: 10px; border-radius: 5px; border: 1px solid var(--muted); background: var(--bg-1); color: var(--txt);">
        <option value="">Select Deal 3</option>
      </select>
    </div>
    <button onclick="compareDeals()" style="margin-top: 10px; padding: 10px; background: var(--accent-1); color: var(--bg-1); border: none; border-radius: 5px; cursor: pointer; width: 100%;">Compare</button>
    <div id="comparison-result" style="margin-top: 15px; color: var(--txt);"></div>
  </div>

  <!-- ROI Calculator -->
  <div class="roi-calculator" style="margin-top: 30px; padding: 20px; background: var(--bg-2); border-radius: var(--card-radius); box-shadow: var(--ui-shadow);">
    <h3 style="color: var(--txt); margin-bottom: 15px;">📈 ROI Calculator</h3>
    <div style="display: flex; flex-wrap: wrap; gap: 10px;">
      <input type="number" id="investment-amount" placeholder="Investment Amount (₦)" aria-label="Investment amount" style="flex: 1; padding: 10px; border-radius: 5px; border: 1px solid var(--muted); background: var(--bg-1); color: var(--txt);">
      <input type="number" id="roi-percentage" placeholder="Expected ROI (%)" aria-label="ROI percentage" style="flex: 1; padding: 10px; border-radius: 5px; border: 1px solid var(--muted); background: var(--bg-1); color: var(--txt);">
      <input type="number" id="time-months" placeholder="Time (months)" aria-label="Time in months" style="flex: 1; padding: 10px; border-radius: 5px; border: 1px solid var(--muted); background: var(--bg-1); color: var(--txt);">
    </div>
    <button onclick="calculateROI()" style="margin-top: 10px; padding: 10px; background: var(--accent-1); color: var(--bg-1); border: none; border-radius: 5px; cursor: pointer; width: 100%;">Calculate</button>
    <p id="roi-result" style="margin-top: 10px; color: var(--success); font-weight: bold;"></p>
  </div>

  <!-- New Feature: Real-Time Notification Feed -->
  <div class="notification-feed" style="margin-top: 30px; padding: 20px; background: var(--bg-2); border-radius: var(--card-radius); box-shadow: var(--ui-shadow);">
    <h3 style="color: var(--txt); margin-bottom: 15px;">🔔 Live Deal Updates</h3>
    <ul id="notification-list" style="list-style: none; padding: 0; max-height: 150px; overflow-y: auto;"></ul>
  </div>
</section>

<!-- Enhanced Modal with Analytics -->
<div class="modal-bg" id="deal-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,10,30,0.7); z-index: 9999; align-items: center; justify-content: center;">
  <div class="modal" style="background: var(--bg-2); padding: 25px; width: 90%; max-width: 800px; border-radius: var(--card-radius); position: relative; box-shadow: var(--ui-shadow); overflow-y: auto; max-height: 85vh;">
    <span class="close" id="close-deal-modal" style="position: absolute; right: 15px; top: 10px; font-size: 28px; cursor: pointer; color: var(--muted);" aria-label="Close modal">&times;</span>
    <h3 id="deal-modal-title" style="margin-bottom: 15px; text-align: center; color: var(--txt);"></h3>
    <div id="deal-modal-details" style="margin-bottom: 15px;"></div>
    <div id="deal-modal-status" style="margin-bottom: 10px; font-weight: bold;"></div>
    <div id="deal-modal-progress" style="margin-bottom: 15px;">
      <div class="progress-bar" style="background: var(--bg-1); height: 8px; border-radius: 5px; overflow: hidden;">
        <div class="modal-progress" id="modal-progress-bar" style="height: 100%; width: 30%; background: linear-gradient(90deg, var(--accent-1), var(--success)); transition: width 0.5s var(--ease);"></div>
      </div>
      <span id="progress-text" style="display: block; margin-top: 5px; text-align: center; color: var(--muted);">30% Complete</span>
    </div>
    <!-- Investment Form -->
    <div id="investment-form" style="margin-bottom: 15px;">
      <h4 style="color: var(--txt); margin-bottom: 10px;">💵 Invest in this Deal</h4>
      <input type="number" id="invest-amount" placeholder="Amount to Invest" aria-label="Amount to invest" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid var(--muted); background: var(--bg-1); color: var(--txt); margin-bottom: 10px;">
      <button onclick="simulateInvestment()" style="width: 100%; padding: 10px; background: var(--success); color: var(--bg-1); border: none; border-radius: 5px; cursor: pointer;">Invest</button>
    </div>
    <button class="status-btn" id="deal-modal-action" onclick="performDealAction()" style="width: 100%; padding: 12px; margin-bottom: 15px; background: var(--accent-1); color: var(--bg-1); border: none; border-radius: 5px; cursor: pointer; font-size: 1.1rem; transition: background 0.3s var(--ease), transform 0.2s var(--ease);">Perform Action</button>
    <div id="activity-feed" style="margin-top: 20px;">
      <h4 style="margin-bottom: 10px; color: var(--txt);">📊 Deal Activity Feed</h4>
      <ul id="activity-list" style="list-style: none; padding: 0; max-height: 150px; overflow-y: auto;"></ul>
    </div>
    <div id="deal-extra-info" style="margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--muted);">
      <h5 style="color: var(--accent-2); margin-bottom: 10px;">Risk Assessment</h5>
      <p id="risk-text" style="color: var(--muted); font-size: 0.9rem;"></p>
    </div>
    <!-- New Feature: Analytics Section -->
    <div id="analytics-section" style="margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--muted);">
      <h5 style="color: var(--accent-2); margin-bottom: 10px;">📈 Deal Analytics</h5>
      <div style="display: flex; flex-wrap: wrap; gap: 15px;">
        <div style="flex: 1; min-width: 200px;">
          <h6 style="color: var(--txt); margin-bottom: 5px;">Historical Performance</h6>
          <canvas id="historical-chart" style="width: 100%; height: 150px;"></canvas>
        </div>
        <div style="flex: 1; min-width: 200px;">
          <h6 style="color: var(--txt); margin-bottom: 5px;">Projected Growth</h6>
          <canvas id="projection-chart" style="width: 100%; height: 150px;"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Notification Toast -->
<div id="deal-toast" style="display: none; position: fixed; bottom: 20px; right: 20px; background: var(--success); color: var(--bg-1); padding: 15px; border-radius: 5px; z-index: 10000; box-shadow: var(--ui-shadow); transition: opacity 0.3s var(--ease);"></div>

<!-- New Feature: Comparison Modal -->
<div class="modal-bg" id="compare-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,10,30,0.7); z-index: 9999; align-items: center; justify-content: center;">
  <div class="modal" style="background: var(--bg-2); padding: 25px; width: 90%; max-width: 900px; border-radius: var(--card-radius); position: relative; box-shadow: var(--ui-shadow); overflow-y: auto; max-height: 85vh;">
    <span class="close" id="close-compare-modal" style="position: absolute; right: 15px; top: 10px; font-size: 28px; cursor: pointer; color: var(--muted);" aria-label="Close comparison modal">&times;</span>
    <h3 style="color: var(--txt); margin-bottom: 15px; text-align: center;">⚖️ Deal Comparison</h3>
    <div id="comparison-table" style="overflow-x: auto;">
      <table style="width: 100%; border-collapse: collapse; color: var(--txt);">
        <thead>
          <tr style="background: var(--bg-1);">
            <th style="padding: 10px; border: 1px solid var(--muted);">Metric</th>
            <th id="compare-deal-1-title" style="padding: 10px; border: 1px solid var(--muted);"></th>
            <th id="compare-deal-2-title" style="padding: 10px; border: 1px solid var(--muted);"></th>
            <th id="compare-deal-3-title" style="padding: 10px; border: 1px solid var(--muted);"></th>
          </tr>
        </thead>
        <tbody id="comparison-body"></tbody>
      </table>
    </div>
  </div>
</div>
<Script>
document.addEventListener('DOMContentLoaded', function() {
  const dealModal = document.getElementById('deal-modal');
  const compareModal = document.getElementById('compare-modal');
  const dealModalTitle = document.getElementById('deal-modal-title');
  const dealModalDetails = document.getElementById('deal-modal-details');
  const dealModalStatus = document.getElementById('deal-modal-status');
  const modalProgressBar = document.getElementById('modal-progress-bar');
  const progressText = document.getElementById('progress-text');
  const dealModalAction = document.getElementById('deal-modal-action');
  const activityList = document.getElementById('activity-list');
  const riskText = document.getElementById('risk-text');
  const closeDealBtn = document.getElementById('close-deal-modal');
  const closeCompareBtn = document.getElementById('close-compare-modal');
  const toast = document.getElementById('deal-toast');
  const searchInput = document.getElementById('deal-search');
  const filterSelect = document.getElementById('deal-filter');
  const dealsGrid = document.getElementById('deals-grid');
  const dealCards = dealsGrid.querySelectorAll('.deal-card');
  const compareDeal1 = document.getElementById('compare-deal-1');
  const compareDeal2 = document.getElementById('compare-deal-2');
  const compareDeal3 = document.getElementById('compare-deal-3');
  const comparisonTable = document.getElementById('comparison-table');
  const notificationList = document.getElementById('notification-list');
  const userStatus = document.getElementById('user-status');
  const authBtn = document.getElementById('auth-btn');

  // Enhanced deals data
  let deals = {
    'Property Deal': {
      title: '🏠 Luxury Property Flip',
      description: 'Prime villa in Abuja - ₦15,000,000 | ROI: 25% in 6 months',
      status: 'negotiating',
      progress: 30,
      action: 'Negotiate',
      locked: false,
      auditLog: [],
      activityFeed: ['Deal created on Sep 09, 2025', 'Initial offer submitted'],
      risk: 'Medium risk due to market fluctuations. Stable location.',
      roiData: [0, 5, 10, 15, 25],
      historicalData: [100, 120, 130, 140, 150],
      investmentAmount: 15000000,
      isFavorite: false
    },
    'Crypto Investment': {
      title: '₿ Crypto Venture Fund',
      description: '0.5 BTC for AI startup - High-growth potential',
      status: 'pending',
      progress: 0,
      action: 'Invest',
      locked: false,
      auditLog: [],
      activityFeed: ['New opportunity launched'],
      risk: 'High volatility in crypto, but innovative tech backing.',
      roiData: [0, 10, 20, 30, 50],
      historicalData: [80, 90, 85, 100, 110],
      investmentAmount: 0.5, // In BTC
      isFavorite: false
    },
    'Business Expansion': {
      title: '💼 Business Expansion',
      description: 'E-commerce platform in Lagos - ₦5,000,000 | 20% Equity',
      status: 'pending',
      progress: 15,
      action: 'Launch',
      locked: false,
      auditLog: [],
      activityFeed: ['Market analysis completed'],
      risk: 'Low entry barrier, growing e-commerce sector.',
      roiData: [0, 5, 10, 15, 20],
      historicalData: [90, 95, 100, 110, 120],
      investmentAmount: 5000000,
      isFavorite: false
    },
    'Tech Startup': {
      title: '🚀 Tech Startup Seed',
      description: 'Fintech app in Lagos - ₦8,000,000 | 15% ROI projected',
      status: 'ongoing',
      progress: 45,
      action: 'Join',
      locked: false,
      auditLog: [],
      activityFeed: ['Seed round opened', 'Investor interest rising'],
      risk: 'Moderate tech risks, strong team experience.',
      roiData: [0, 5, 10, 12, 15],
      historicalData: [100, 110, 115, 120, 130],
      investmentAmount: 8000000,
      isFavorite: false
    },
    'Green Energy Project': {
      title: '🌿 Green Energy Project',
      description: 'Solar farm in Kano - ₦10,000,000 | ROI: 18% in 12 months',
      status: 'pending',
      progress: 5,
      action: 'Invest',
      locked: false,
      auditLog: [],
      activityFeed: ['Project initiated'],
      risk: 'Low environmental impact, sustainable growth.',
      roiData: [0, 5, 10, 15, 18],
      historicalData: [95, 100, 105, 110, 115],
      investmentAmount: 10000000,
      isFavorite: false
    },
    'Art NFT Collection': {
      title: '🎨 Art NFT Collection',
      description: 'Exclusive digital art series - 1 ETH | High resale value',
      status: 'negotiating',
      progress: 20,
      action: 'Negotiate',
      locked: false,
      auditLog: [],
      activityFeed: ['Collection curated'],
      risk: 'Market-dependent, creative sector volatility.',
      roiData: [0, 10, 20, 30, 40],
      historicalData: [70, 80, 90, 100, 120],
      investmentAmount: 1, // In ETH
      isFavorite: false
    }
  };

  // Simulated user data
  let user = {
    isAuthenticated: false,
    username: 'Guest',
    portfolio: 0,
    investments: {}
  };

  // Populate comparison dropdowns
  Object.keys(deals).forEach(deal => {
    const option1 = document.createElement('option');
    option1.value = deal;
    option1.text = deal;
    compareDeal1.appendChild(option1.cloneNode(true));
    compareDeal2.appendChild(option1.cloneNode(true));
    compareDeal3.appendChild(option1);
  });

  // Show toast
  function showToast(message, duration = 3000) {
    toast.innerText = message;
    toast.style.display = 'block';
    toast.style.opacity = '0';
    setTimeout(() => { toast.style.opacity = '1'; }, 100);
    setTimeout(() => { 
      toast.style.opacity = '0';
      setTimeout(() => { toast.style.display = 'none'; }, 300);
    }, duration);
  }

  // New Feature: Toggle Authentication
  window.toggleAuth = function() {
    if (user.isAuthenticated) {
      user.isAuthenticated = false;
      user.username = 'Guest';
      user.portfolio = 0;
      user.investments = {};
      authBtn.innerText = 'Login';
      userStatus.innerText = 'Guest';
      showToast('👋 Logged out successfully.');
    } else {
      user.isAuthenticated = true;
      user.username = 'User' + Math.floor(Math.random() * 1000);
      authBtn.innerText = 'Logout';
      userStatus.innerText = user.username;
      showToast(`🎉 Welcome, ${user.username}!`);
    }
    updatePortfolioDisplay();
  };

  // New Feature: Toggle Favorite
  window.toggleFavorite = function(dealType) {
    if (!user.isAuthenticated) {
      showToast('🔒 Please login to favorite deals.');
      return;
    }
    const deal = deals[dealType];
    deal.isFavorite = !deal.isFavorite;
    const icon = document.getElementById(`favorite-${dealType.toLowerCase().replace(/ /g, '-')}`);
    icon.style.color = deal.isFavorite ? var(--accent-3) : var(--muted);
    showToast(deal.isFavorite ? `⭐ Added ${deal.title} to favorites!` : `☆ Removed ${deal.title} from favorites.`);
  };

  // New Feature: Share Deal
  window.shareDeal = function(dealType) {
    const deal = deals[dealType];
    const shareUrl = `${window.location.origin}/deal/${dealType.toLowerCase().replace(/ /g, '-')}`;
    navigator.clipboard.writeText(shareUrl).then(() => {
      showToast(`🔗 Copied share link for ${deal.title}!`);
    });
  };

  // Open Deal Modal
  window.openDealModal = function(dealType) {
    if (deals[dealType].locked) {
      showToast('🔒 Deal locked - Finalized!');
      return;
    }
    const deal = deals[dealType];
    dealModalTitle.innerText = deal.title;
    dealModalDetails.innerHTML = `<p style="font-size: 1.1rem; color: var(--muted);">${deal.description}</p>`;
    dealModalStatus.innerHTML = `<span class="status-badge ${deal.status}">${deal.status.charAt(0).toUpperCase() + deal.status.slice(1)}</span>`;
    modalProgressBar.style.width = `${deal.progress}%`;
    progressText.innerText = `${deal.progress}% Complete`;
    const progressElement = document.getElementById(`${dealType.toLowerCase().replace(/ /g, '-')}-progress`);
    if (progressElement) progressElement.style.width = `${deal.progress}%`;
    dealModalAction.innerText = `${deal.action} Now`;
    riskText.innerText = deal.risk;
    deal.activityFeed.push(`👁️ Viewed by ${user.username} on ${new Date().toLocaleString()}`);
    updateActivityFeed(deal);
    drawAnalyticsCharts(deal.historicalData, deal.roiData);
    dealModal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
    dealModal.style.opacity = '0';
    setTimeout(() => { dealModal.style.opacity = '1'; }, 100);
  };

  // Update Activity Feed
  function updateActivityFeed(deal) {
    activityList.innerHTML = '';
    deal.activityFeed.slice(-5).reverse().forEach(activity => {
      const li = document.createElement('li');
      li.innerHTML = `<small style="color: var(--muted);">${activity}</small>`;
      li.style.padding = '5px 0';
      li.style.borderBottom = `1px solid var(--bg-1)`;
      activityList.appendChild(li);
    });
  }

  // Close Modals
  function closeDealModal() {
    dealModal.style.opacity = '0';
    setTimeout(() => {
      dealModal.style.display = 'none';
      document.body.style.overflow = 'auto';
    }, 300);
  }

  function closeCompareModal() {
    compareModal.style.opacity = '0';
    setTimeout(() => {
      compareModal.style.display = 'none';
      document.body.style.overflow = 'auto';
    }, 300);
  }

  closeDealBtn.addEventListener('click', closeDealModal);
  closeCompareBtn.addEventListener('click', closeCompareModal);
  dealModal.addEventListener('click', (e) => { if (e.target === dealModal) closeDealModal(); });
  compareModal.addEventListener('click', (e) => { if (e.target === compareModal) closeCompareModal(); });
  document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDealModal(); closeCompareModal(); } });

  // Perform Deal Action
  window.performDealAction = function() {
    if (!user.isAuthenticated) {
      showToast('🔒 Please login to perform actions.');
      return;
    }
    const currentDealTitle = dealModalTitle.innerText;
    const deal = deals[currentDealTitle];
    let progressBoost = 25;
    let toastMsg = '';
    let activityMsg = '';
    if (deal.status === 'negotiating') {
      deal.status = 'ongoing';
      progressBoost = 25;
      toastMsg = `📈 Negotiation advanced! Progress: ${deal.progress + progressBoost}%`;
      activityMsg = `💬 Negotiation round completed by ${user.username}`;
    } else if (deal.status === 'pending') {
      deal.status = 'ongoing';
      progressBoost = 20;
      toastMsg = `🚀 Action taken! Progress: ${deal.progress + progressBoost}%`;
      activityMsg = `✅ Investment/Launch initiated by ${user.username}`;
    } else if (deal.status === 'ongoing') {
      progressBoost = 15;
      toastMsg = `🔄 Progress updated! Now at ${deal.progress + progressBoost}%`;
      activityMsg = `📊 Milestone achieved by ${user.username}`;
    }
    deal.progress = Math.min(deal.progress + progressBoost, 100);
    deal.activityFeed.push(activityMsg);
    modalProgressBar.style.width = `${deal.progress}%`;
    progressText.innerText = `${deal.progress}% Complete`;
    dealModalStatus.innerHTML = `<span class="status-badge ${deal.status}">${deal.status.charAt(0).toUpperCase() + deal.status.slice(1)}</span>`;
    const progressElement = document.getElementById(`${currentDealTitle.toLowerCase().replace(/ /g, '-')}-progress`);
    if (progressElement) progressElement.style.width = `${deal.progress}%`;
    updateActivityFeed(deal);
    showToast(toastMsg);
    notifyLiveUpdate(`${currentDealTitle} progressed to ${deal.progress}%`);
    if (deal.progress >= 100) {
      deal.locked = true;
      showToast(`🎉 ${deal.title} completed & locked! Earnings unlocked.`);
      deal.activityFeed.push(`🏆 Deal finalized successfully by ${user.username}`);
      dealModalAction.innerText = 'Deal Completed';
      dealModalAction.style.background = var(--success);
      notifyLiveUpdate(`${deal.title} has been finalized!`);
    }
  };

  // Simulate Investment
  window.simulateInvestment = function() {
    if (!user.isAuthenticated) {
      showToast('🔒 Please login to invest.');
      return;
    }
    const amount = parseFloat(document.getElementById('invest-amount').value);
    if (isNaN(amount) || amount <= 0) {
      showToast('⚠️ Please enter a valid amount.');
      return;
    }
    const currentDealTitle = dealModalTitle.innerText;
    const deal = deals[currentDealTitle];
    user.portfolio += amount;
    user.investments[currentDealTitle] = (user.investments[currentDealTitle] || 0) + amount;
    updatePortfolioDisplay();
    showToast(`💰 Invested ₦${amount.toLocaleString()} in ${deal.title}!`);
    deal.activityFeed.push(`💵 ${user.username} invested ₦${amount.toLocaleString()} on ${new Date().toLocaleString()}`);
    notifyLiveUpdate(`${user.username} invested ₦${amount.toLocaleString()} in ${deal.title}`);
    updateActivityFeed(deal);
  };

  // Update Portfolio Display
  function updatePortfolioDisplay() {
    document.getElementById('portfolio-value').innerText = `Portfolio: ₦${user.portfolio.toLocaleString()}`;
  }

  // Calculate ROI
  window.calculateROI = function() {
    const amount = parseFloat(document.getElementById('investment-amount').value);
    const roi = parseFloat(document.getElementById('roi-percentage').value) / 100;
    const time = parseFloat(document.getElementById('time-months').value);
    if (isNaN(amount) || isNaN(roi) || isNaN(time)) {
      document.getElementById('roi-result').innerText = 'Please fill all fields.';
      return;
    }
    const projected = amount * Math.pow(1 + roi / 12, time);
    document.getElementById('roi-result').innerText = `Projected Return: ₦${projected.toFixed(2)}`;
  };

  // Filter and Search Deals
  function filterDeals() {
    const searchTerm = searchInput.value.toLowerCase();
    const filterStatus = filterSelect.value;
    dealCards.forEach(card => {
      const title = card.querySelector('h4').innerText.toLowerCase();
      const status = card.dataset.status;
      const matchesSearch = title.includes(searchTerm);
      const matchesFilter = filterStatus === 'all' || status === filterStatus;
      card.style.display = matchesSearch && matchesFilter ? 'block' : 'none';
    });
  }

  searchInput.addEventListener('input', filterDeals);
  filterSelect.addEventListener('change', filterDeals);

  // Draw Analytics Charts
  function drawAnalyticsCharts(historicalData, roiData) {
    const historicalCanvas = document.getElementById('historical-chart');
    const projectionCanvas = document.getElementById('projection-chart');
    const ctx1 = historicalCanvas.getContext('2d');
    const ctx2 = projectionCanvas.getContext('2d');
    
    function drawChart(ctx, data, color) {
      ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
      const width = ctx.canvas.width;
      const height = ctx.canvas.height;
      const maxVal = Math.max(...data);
      const stepX = width / (data.length - 1);
      const stepY = maxVal ? height / maxVal : 1;
      
      ctx.beginPath();
      ctx.moveTo(0, height - data[0] * stepY);
      data.forEach((val, i) => {
        ctx.lineTo(i * stepX, height - val * stepY);
      });
      ctx.strokeStyle = color;
      ctx.lineWidth = 2;
      ctx.stroke();
      
      ctx.beginPath();
      ctx.moveTo(0, height);
      ctx.lineTo(width, height);
      ctx.lineTo(width, 0);
      ctx.strokeStyle = var(--muted);
      ctx.stroke();
    }
    
    drawChart(ctx1, historicalData, var(--accent-1));
    drawChart(ctx2, roiData, var(--success));
  }

  // New Feature: Compare Deals
  window.compareDeals = function() {
    const deal1 = compareDeal1.value;
    const deal2 = compareDeal2.value;
    const deal3 = compareDeal3.value;
    if (!deal1 && !deal2 && !deal3) {
      showToast('⚠️ Select at least one deal to compare.');
      return;
    }
    const selectedDeals = [deal1, deal2, deal3].filter(d => d && deals[d]);
    if (selectedDeals.length === 0) {
      showToast('⚠️ Invalid deal selection.');
      return;
    }
    document.getElementById('compare-deal-1-title').innerText = deal1 ? deals[deal1].title : '';
    document.getElementById('compare-deal-2-title').innerText = deal2 ? deals[deal2].title : '';
    document.getElementById('compare-deal-3-title').innerText = deal3 ? deals[deal3].title : '';
    const metrics = [
      { name: 'Investment Amount', key: 'investmentAmount', format: v => typeof v === 'number' ? `₦${v.toLocaleString()}` : v },
      { name: 'ROI', key: 'roiData', format: v => v[v.length - 1] + '%' },
      { name: 'Risk', key: 'risk', format: v => v },
      { name: 'Status', key: 'status', format: v => v.charAt(0).toUpperCase() + v.slice(1) }
    ];
    let html = '';
    metrics.forEach(metric => {
      html += `<tr><td style="padding: 10px; border: 1px solid var(--muted);">${metric.name}</td>`;
      selectedDeals.forEach(deal => {
        const value = deals[deal][metric.key];
        html += `<td style="padding: 10px; border: 1px solid var(--muted);">${metric.format(value)}</td>`;
      });
      if (selectedDeals.length < 3) {
        for (let i = selectedDeals.length; i < 3; i++) {
          html += `<td style="padding: 10px; border: 1px solid var(--muted);">-</td>`;
        }
      }
      html += '</tr>';
    });
    document.getElementById('comparison-body').innerHTML = html;
    compareModal.style.display = 'flex';
    compareModal.style.opacity = '0';
    setTimeout(() => { compareModal.style.opacity = '1'; }, 100);
  };

  // New Feature: Simulated WebSocket Notifications
  function notifyLiveUpdate(message) {
    const li = document.createElement('li');
    li.innerHTML = `<small style="color: var(--muted);">${message} - ${new Date().toLocaleString()}</small>`;
    li.style.padding = '5px 0';
    li.style.borderBottom = `1px solid var(--bg-1)`;
    notificationList.prepend(li);
    if (notificationList.children.length > 5) {
      notificationList.removeChild(notificationList.lastChild);
    }
  }

  // Simulated WebSocket Updates
  setInterval(function() {
    const dealKeys = Object.keys(deals);
    const randomDeal = dealKeys[Math.floor(Math.random() * dealKeys.length)];
    const deal = deals[randomDeal];
    if (!deal.locked && deal.status === 'ongoing') {
      const boost = Math.random() * 3 + 2;
      deal.progress = Math.min(deal.progress + boost, 100);
      const progressElement = document.getElementById(`${randomDeal.toLowerCase().replace(/ /g, '-')}-progress`);
      if (progressElement) progressElement.style.width = `${deal.progress}%`;
      notifyLiveUpdate(`${deal.title} progressed to ${deal.progress.toFixed(1)}%`);
      if (deal.progress >= 100) {
        deal.locked = true;
        showToast(`${deal.title} completed!`);
        notifyLiveUpdate(`${deal.title} has been finalized!`);
      }
    }
  }, 10000);

  // Welcome Toast
  setTimeout(() => showToast('🔥 New deals available - Check them out! Explore favorites and comparisons.'), 1500);
});
</Script>
<Style>
/* Enhanced Styles */
.deals-controls { display: flex; align-items: center; gap: 20px; flex-wrap: wrap; }
.deals-filter { display: flex; gap: 10px; flex-wrap: wrap; }
.favorite-btn { 
  background: none; 
  border: none; 
  cursor: pointer; 
  color: var(--muted); 
  transition: color 0.3s var(--ease); 
}
.favorite-btn i.fas { font-size: 1.2rem; }
.share-btn { transition: background 0.3s var(--ease), transform 0.2s var(--ease); }
.share-btn:hover { background: var(--accent-3) !important; transform: scale(1.05); }
.notification-feed { background: rgba(59, 234, 255, 0.05); border: 1px solid rgba(59, 234, 255, 0.1); }
#notification-list li { padding: 5px 0; border-bottom: 1px solid var(--bg-1); }
.deal-comparison table { min-width: 100%; }
.deal-comparison th, .deal-comparison td { text-align: center; }
.comparison-controls select { min-width: 150px; }

/* Responsive Design */
@media (max-width: 768px) {
  .deals-grid { grid-template-columns: 1fr; }
  .deals-stats { flex-direction: column; gap: 15px; }
  .deals-filter { flex-direction: column; }
  .comparison-controls { flex-direction: column; }
  .modal { max-width: 95%; }
}

/* Light Theme Adjustments */
[data-theme="light"] .notification-feed { 
  background: rgba(59, 234, 255, 0.05); 
  border: 1px solid rgba(0, 0, 0, 0.05); 
}
[data-theme="light"] .deal-comparison { 
  background: var(--light-bg-2); 
}
[data-theme="light"] .modal { 
  background: var(--light-bg-1); 
}
</Style>
                <!-- Upload Slide (Updated with Upload Hub Logic) -->
                <section class="slide" id="upload-slide" aria-labelledby="upload-title">
                    <div class="upload-area">
                        <h2 class="dashboard-title" id="upload-title">Upload Hub</h2>
                        <!-- Progress Indicator -->
                        <div id="progress-bar">
                            <span id="step-1" class="progress-step">1</span>
                            <span id="step-2" class="progress-step">2</span>
                            <span id="step-3" class="progress-step">3</span>
                        </div>
                        <!-- Category/Subcategory/Type/Condition -->
                        <div class="upload-form-group">
                            <select id="upload-category" onchange="upload.updateSubCategory()" aria-label="Select Category">
                                <option value="">--Select Category--</option>
                                <option value="vehicle">Vehicle</option>
                                <option value="property">Property</option>
                                <option value="business">Business</option>
                                <option value="legal">Legal/Case</option>
                                <option value="management">Management</option>
                                <option value="game">Game</option>
                                <option value="advertisement">Advertisement</option>
                                <option value="mining">Mining</option>
                                <option value="profile">Profile</option>
                            </select>
                            <select id="upload-subcategory" onchange="upload.updateType()" aria-label="Select Subcategory">
                                <option value="">--Select Subcategory--</option>
                            </select>
                            <select id="upload-type" onchange="upload.updateCondition()" aria-label="Select Type">
                                <option value="">--Select Type--</option>
                            </select>
                            <select id="upload-condition" aria-label="Select Condition">
                                <option value="">--Select Condition--</option>
                            </select>
                        </div>
                        <!-- Price & Currency -->
                        <div id="price-group">
                            <input type="number" id="upload-price" placeholder="Price" min="0" aria-label="Price">
                            <select id="upload-currency" aria-label="Select Currency">
                                <option value="USD">USD</option>
                                <option value="NGN">NGN</option>
                                <option value="EUR">EUR</option>
                            </select>
                            <label class="boost-label">
                                <input type="checkbox" id="boost-upload"> Boost / Promote
                                <span class="boost-note">(Increases visibility)</span>
                            </label>
                        </div>
                        <!-- Live Capture -->
                        <div class="capture-group">
                            <video id="video" autoplay aria-label="Live video feed"></video>
                            <canvas id="canvas" class="hidden" aria-hidden="true"></canvas>
                            <div id="preview-gallery"></div>
                            <div class="capture-buttons">
                                <button class="status-btn" onclick="startVideo()" aria-label="Start video capture">Start Video</button>
                                <button class="status-btn" onclick="capturePhoto()" aria-label="Capture photo">Capture Photo</button>
                                <button class="status-btn" onclick="stopRecording()" aria-label="Stop video capture">Stop Video</button>
                            </div>
                        </div>
                        <!-- Owner Verification -->
                        <div id="owner-verification-step">
                            <input type="text" id="owner-name" placeholder="Owner Name" aria-label="Owner Name">
                            <input type="text" id="owner-contact" placeholder="Contact" aria-label="Owner Contact">
                            <input type="file" id="owner-id" accept=".jpg,.png,.pdf" aria-label="Owner ID Upload">
                            <video id="owner-video" autoplay aria-label="Owner verification video"></video>
                            <canvas id="owner-canvas" class="hidden" aria-hidden="true"></canvas>
                            <div class="selfie-controls">
                                <button class="status-btn" onclick="startSelfieCountdown()" aria-label="Capture selfie">Capture Selfie</button>
                                <span id="selfie-countdown" aria-live="polite"></span>
                            </div>
                        </div>
                        <!-- Verification Checklist -->
                        <div class="verification-group">
                            <label><input type="checkbox" id="id-verified" aria-label="ID Verified"> ID Verified</label>
                            <label><input type="checkbox" id="address-verified" aria-label="Address Verified"> Address Verified</label>
                            <label class="kyc-label">
                                <input type="checkbox" id="kyc-complete" aria-label="KYC Complete"> KYC Complete
                                <span class="kyc-note">(Know Your Customer)</span>
                            </label>
                        </div>
                        <!-- Submit -->
                        <button class="status-btn" onclick="submitUpload()" id="submit-btn" aria-label="Submit upload">Submit</button>
                        <div id="upload-status" aria-live="polite"></div>
                        <!-- Recent Uploads -->
                        <div class="uploads-group">
                            <div class="uploads-filter">
                                <input type="text" id="search-box" placeholder="Search uploads..." oninput="filterUploads()" aria-label="Search Uploads">
                                <button class="status-btn" onclick="filterByCategory('vehicle')" aria-label="Filter by Vehicles">Vehicles</button>
                                <button class="status-btn" onclick="filterByCategory('property')" aria-label="Filter by Properties">Vehicles</button>
                            </div>
                            <div id="upload-list" role="list"></div>
                        </div>
                        <!-- Notifications -->
                        <div id="notif-list" aria-live="polite"></div>
                    </div>
                </section>
                <!-- Contacts Slide -->
                <section class="slide app" id="contacts-slide" aria-labelledby="contacts-title">
                    <div class="contacts">
                        <div class="header-row">
                            <h2 class="dashboard-title" id="contacts-title">Contacts</h2>
                            <button class="icon-btn status-btn" title="Add new contact" onclick="alert('Add contact flow')" aria-label="Add new contact">+</button>
                        </div>
                        <div class="search">
                            <input id="searchInput" type="search" placeholder="Search contacts or deals..." oninput="filterContacts()" aria-label="Search contacts or deals">
                            <button class="icon-btn status-btn" onclick="document.getElementById('searchInput').value=''; filterContacts();" aria-label="Clear search">✕</button>
                        </div>
                        <div id="contactList" class="contact-list" role="list">
                            <div class="contact-card" data-name="Aisha Bello" onclick="openConversation('Aisha Bello','Real Estate Agent • Lagos','https://via.placeholder.com/48/35e0ff', true)" role="button" tabindex="0" aria-label="Chat with Aisha Bello">
                                <div class="avatar-wrap">
                                    <img class="post-profile-img" src="https://via.placeholder.com/48/35e0ff" alt="Aisha Bello's profile" loading="lazy">
                                    <span class="online-dot"></span>
                                </div>
                                <div class="info">
                                    <h4>Aisha Bello</h4>
                                    <p>Real Estate • Negotiating: 2 offers</p>
                                </div>
                            </div>
                            <div class="contact-card" data-name="Usman Danjuma" onclick="openConversation('Usman Danjuma','Crypto Trader • Abuja','https://via.placeholder.com/48/ffd36a', false)" role="button" tabindex="0" aria-label="Chat with Usman Danjuma">
                                <div class="avatar-wrap">
                                    <img class="post-profile-img" src="https://via.placeholder.com/48/ffd36a" alt="Usman Danjuma's profile" loading="lazy">
                                </div>
                                <div class="info">
                                    <h4>Usman Danjuma</h4>
                                    <p>Crypto • Last seen 2h</p>
                                </div>
                            </div>
                            <div class="contact-card" data-name="Business Hub" onclick="openConversation('Business Hub','Negotiation Center','','true')" role="button" tabindex="0" aria-label="Chat with Business Hub">
                                <div class="avatar-wrap">
                                    <img class="post-profile-img" src="https://via.placeholder.com/48/8b6dff" alt="Business Hub" loading="lazy">
                                    <span class="online-dot"></span>
                                </div>
                                <div class="info">
                                    <h4>Business Hub</h4>
                                    <p>System • Info & rules</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="chat" role="region" aria-label="Chat area">
                        <div class="chat-header">
                            <div class="avatar-wrap">
                                <img id="chatAvatar" src="https://via.placeholder.com/48/35e0ff" class="post-profile-img" alt="Chat contact profile" loading="lazy">
                                <span id="statusDot" class="online-dot" style="display:none"></span>
                            </div>
                            <div class="chat-title">
                                <h3 id="chatName">Select a contact</h3>
                                <p id="chatSub">Negotiation tool ready <span id="negTag" class="tag" style="display:none">Negotiation</span></p>
                            </div>
                            <div class="chat-actions">
                                <button class="icon-btn status-btn" title="Start voice call" onclick="alert('Voice/Call placeholder')" aria-label="Start voice call">📞</button>
                                <button class="icon-btn status-btn" title="Open profile" onclick="openProfile()" aria-label="View contact profile">ℹ️</button>
                            </div>
                        </div>
                        <div id="chatBody" class="chat-body" role="log" aria-live="polite">
                            <div class="msg-row received">
                                <div>
                                    <div class="msg received">Welcome — select a contact to start negotiating. Use the offer tool (📎) to send price proposals.</div>
                                    <div class="meta">System • now</div>
                                </div>
                            </div>
                        </div>
                        <div class="attach-preview" id="attachPreview" aria-hidden="true"></div>
                        <div class="chat-footer">
                            <div class="tools">
                                <label class="icon-btn" title="Take photo">
                                    <input id="cameraInput" type="file" accept="image/*" capture="camera" hidden onchange="handleCamera(event)" aria-label="Capture photo"/>
                                    📷
                                </label>
                                <label class="icon-btn" title="Attach file">
                                    <input id="fileInput" type="file" hidden onchange="handleFile(event)" aria-label="Attach file"/>
                                    📎
                                </label>
                                <button id="recBtn" class="icon-btn status-btn" title="Record voice" onclick="toggleRecord()" aria-label="Record voice message">🎙</button>
                                <button class="icon-btn status-btn" title="Create offer" onclick="openOffer()" aria-label="Create offer">💼</button>
                            </div>
                            <div class="input">
                                <input id="chatInput" type="text" placeholder="Write a negotiation message or paste terms..." onkeydown="if(event.key==='Enter'){ sendText(); }" aria-label="Send negotiation message">
                            </div>
                            <button class="icon-btn status-btn" title="Send message" onclick="sendText()" aria-label="Send message">➤</button>
                        </div>
                    </div>
                </section>
                <!-- Business Slide -->
                <section class="slide" id="business-slide" aria-labelledby="business-title">
                    <div class="business-grid">
                        <h2 class="dashboard-title" id="business-title">Business Hub</h2>
                        <div class="business-filters">
                            <select aria-label="Filter by category">
                                <option value="all">All Categories</option>
                                <option value="real-estate">Real Estate</option>
                                <option value="crypto">Crypto</option>
                            </select>
                            <button class="status-btn active" aria-label="Show all businesses">All</button>
                            <button class="status-btn" aria-label="Show active businesses">Active</button>
                            <button class="status-btn" aria-label="Show pending businesses">Pending</button>
                        </div>
                        <div class="business-card">
                            <h4>Real Estate Venture</h4>
                            <p>Partnered with Lagos developers</p>
                            <button class="status-btn" aria-label="View Real Estate Venture details">View Details</button>
                        </div>
                        <div class="business-card">
                            <h4>Crypto Startup</h4>
                            <p>Blockchain-based payment solution</p>
                            <button class="status-btn" aria-label="View Crypto Startup details">View Details</button>
                        </div>
                    </div>
                </section>
                <!-- Invest Slide -->
                <section class="slide" id="invest-slide" aria-labelledby="invest-title">
                    <div class="invest-container">
                        <h2 class="dashboard-title" id="invest-title">Investment Opportunities</h2>
                        <div class="business-card">
                            <h4>Property Fund</h4>
                            <p>Invest in Lagos real estate, min. ₦500,000</p>
                            <button class="status-btn" aria-label="Invest in Property Fund">Invest Now</button>
                        </div>
                        <div class="business-card">
                            <h4>Crypto Fund</h4>
                            <p>0.1 BTC minimum investment</p>
                            <button class="status-btn" aria-label="Invest in Crypto Fund">Invest Now</button>
                        </div>
                    </div>
                </section>
                <!-- Loans Slide -->
                <section class="slide" id="loans-slide" aria-labelledby="loans-title">
                    <div class="loan-container">
                        <h2 class="dashboard-title" id="loans-title">Loans</h2>
                        <div class="form-group">
                            <label for="loan-amount">Loan Amount</label>
                            <input type="number" id="loan-amount" placeholder="Enter amount" aria-label="Loan amount">
                        </div>
                        <div class="form-group">
                            <label for="loan-purpose">Purpose</label>
                            <select id="loan-purpose" aria-label="Loan purpose">
                                <option value="real-estate">Real Estate</option>
                                <option value="business">Business</option>
                                <option value="personal">Personal</option>
                            </select>
                        </div>
                        <button class="status-btn" onclick="applyLoan()" aria-label="Apply for loan">Apply for Loan</button>
                    </div>
                </section>
                <!-- Exchanges Slide -->
                <section class="slide" id="exchanges-slide" aria-labelledby="exchanges-title">
                    <div class="exchange-container">
                        <h2 class="dashboard-title" id="exchanges-title">Exchange</h2>
                        <div class="exchange-filters">
                            <select aria-label="Filter by asset type">
                                <option value="all">All Assets</option>
                                <option value="crypto">Crypto</option>
                                <option value="fiat">Fiat</option>
                            </select>
                        </div>
                        <div class="exchange-grid">
                            <div class="deal-card">
                                <h4>BTC to NGN</h4>
                                <p>Rate: ₦25,000,000/BTC</p>
                                <button class="status-btn" aria-label="Exchange BTC to NGN">Exchange</button>
                            </div>
                            <div class="deal-card">
                                <h4>ETH to USD</h4>
                                <p>Rate: $3,200/ETH</p>
                                <button class="status-btn" aria-label="Exchange ETH to USD">Exchange</button>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- Advertisement Slide -->
                <section class="slide" id="advertisement-slide" aria-labelledby="advertisement-title">
                    <div class="ad-container">
                        <h2 class="dashboard-title" id="advertisement-title">Advertisement</h2>
                        <div class="ad-campaign-form">
                            <div class="form-group">
                                <label for="ad-title">Ad Title</label>
                                <input type="text" id="ad-title" placeholder="Enter ad title" aria-label="Ad title">
                            </div>
                            <div class="form-group">
                                <label for="ad-content">Ad Content</label>
                                <textarea id="ad-content" placeholder="Enter ad content" aria-label="Ad content"></textarea>
                            </div>
                            <button class="status-btn" onclick="createAd()" aria-label="Create advertisement">Create Ad</button>
                        </div>
                    </div>
                </section>
                <!-- Support Slide -->
                <section class="slide" id="support-slide" aria-labelledby="support-title">
                    <div class="support-container">
                        <h2 class="dashboard-title" id="support-title">Support</h2>
                        <div class="faq-list" role="list">
                            <div class="faq-item">
                                <button class="faq-question status-btn" aria-expanded="false" aria-controls="faq-answer-1">How do I verify my account?</button>
                                <div class="faq-answer" id="faq-answer-1">Submit your ID and address proof in the Upload Hub.</div>
                            </div>
                            <div class="faq-item">
                                <button class="faq-question status-btn" aria-expanded="false" aria-controls="faq-answer-2">How to start an escrow?</button>
                                <div class="faq-answer" id="faq-answer-2">Go to XG Trust and select "Start Escrow".</div>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- Insight Slide -->
                <section class="slide" id="insight-slide" aria-labelledby="insight-title">
                    <div class="analytics-container">
                        <h2 class="dashboard-title" id="insight-title">XG Insight</h2>
                        <div class="analytics-card">
                            <h3>Performance Stats</h3>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value">₦4.5M</div>
                                    <div class="stat-label">Portfolio Value</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">+3.2%</div>
                                    <div class="stat-label">Monthly Growth</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">12</div>
                                    <div class="stat-label">Active Deals</div>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container" id="portfolio-chart" aria-label="Portfolio performance chart"></div>
                    </div>
                </section>
                <!-- Court Slide -->
                <section class="slide" id="court-slide" aria-labelledby="court-title">
                    <div class="court-container">
                        <h2 class="dashboard-title" id="court-title">Court & Legal Hub</h2>
                        <div class="court-case-form">
                            <div class="form-group">
                                <label for="case-title">Case Title</label>
                                <input type="text" id="case-title" placeholder="Enter case title" aria-label="Case title">
                            </div>
                            <div class="form-group">
                                <label for="case-details">Details</label>
                                <textarea id="case-details" placeholder="Enter case details" aria-label="Case details"></textarea>
                            </div>
                            <button class="status-btn" onclick="submitCase()" aria-label="Submit legal case">Submit Case</button>
                        </div>
                    </div>
                </section>
                <!-- Ads Slide -->
                <section class="slide" id="ads-slide" aria-labelledby="ads-title">
                    <div class="ad-grid">
                        <h2 class="dashboard-title" id="ads-title">Advertising</h2>
                        <div class="ad-card">
                            <h4>Promote Your Business</h4>
                            <p>Reach thousands with targeted ads.</p>
                            <button class="status-btn" aria-label="Create advertising campaign">Create Campaign</button>
                        </div>
                        <div class="ad-card">
                            <h4>Sponsor a Post</h4>
                            <p>Boost visibility with sponsored content.</p>
                            <button class="status-btn" aria-label="Sponsor a post">Sponsor Now</button>
                        </div>
                    </div>
                </section>
                <!-- Mining Slide -->
                <section class="slide" id="mining-slide" aria-labelledby="mining-title">
                    <div class="mining-container">
                        <h2 class="dashboard-title" id="mining-title">Mining & Resource Hub</h2>
                        <div class="mining-upload">
                            <div class="form-group">
                                <label for="mining-resource">Resource Type</label>
                                <select id="mining-resource" aria-label="Resource type">
                                    <option value="crypto">Cryptocurrency</option>
                                    <option value="mineral">Mineral</option>
                                </select>
                            </div>
                            <button class="status-btn" onclick="uploadResource()" aria-label="Upload resource">Upload Resource</button>
                        </div>
                    </div>
                </section>
                <!-- Learning Slide -->
                <section class="slide" id="learning-slide" aria-labelledby="learning-title">
                    <div class="learning-container">
                        <h2 class="dashboard-title" id="learning-title">Learning & Certification</h2>
                        <div class="learning-courses">
                            <div class="course-card">
                                <h4>Real Estate Investment</h4>
                                <p>Learn strategies for property investment.</p>
                                <button class="status-btn" aria-label="Enroll in Real Estate Investment course">Enroll Now</button>
                            </div>
                            <div class="course-card">
                                <h4>Crypto Trading Basics</h4>
                                <p>Master the art of crypto trading.</p>
                                <button class="status-btn" aria-label="Enroll in Crypto Trading Basics course">Enroll Now</button>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- Zone Slide -->
                <section class="slide" id="zone-slide" aria-labelledby="zone-title">
                    <div class="zone-container">
                        <h2 class="dashboard-title" id="zone-title">Zone Management</h2>
                        <div class="zone-filters">
                            <select aria-label="Filter by zone">
                                <option value="all">All Zones</option>
                                <option value="lagos">Lagos</option>
                                <option value="abuja">Abuja</option>
                            </select>
                        </div>
                        <div class="zone-map" id="zone-map" aria-label="Zone map"></div>
                        <div class="zone-grid">
                            <div class="zone-card">
                                <h4>Lagos Zone</h4>
                                <p>High-demand real estate area.</p>
                                <button class="status-btn" aria-label="Explore Lagos Zone">Explore</button>
                            </div>
                            <div class="zone-card">
                                <h4>Abuja Zone</h4>
                                <p>Emerging crypto investment hub.</p>
                                <button class="status-btn" aria-label="Explore Abuja Zone">Explore</button>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- Settings Slide -->
                <section class="slide" id="settings-slide" aria-labelledby="settings-title">
                    <div class="settings-container">
                        <h2 class="dashboard-title" id="settings-title">Settings</h2>
                        <div class="form-group">
                            <label for="username">Username</label>
                            <input type="text" id="username" placeholder="Enter username" aria-label="Username">
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" placeholder="Enter email" aria-label="Email">
                        </div>
                        <div class="form-group">
                            <label for="notifications">Notifications</label>
                            <select id="notifications" aria-label="Notification preferences">
                                <option value="all">All</option>
                                <option value="important">Important Only</option>
                                <option value="none">None</option>
                            </select>
                        </div>
                        <button class="status-btn" onclick="saveSettings()" aria-label="Save settings">Save Settings</button>
                    </div>
                </section>
            </div>
        </section>
    </main>

    <!-- Modals -->
    <!-- Status Modal -->
    <div class="modal-bg" id="status-modal" aria-hidden="true" role="dialog" aria-label="Status viewer">
        <div class="modal">
            <button class="close status-btn" onclick="closeModal('status-modal')" aria-label="Close status modal">&times;</button>
            <div id="progress-container"></div>
            <h3 id="status-user"></h3>
            <div id="status-content"></div>
            <div id="status-comment">
                <input type="text" id="status-message" placeholder="Send message..." aria-label="Comment on status">
                <button class="status-btn" onclick="sendStatusMessage()" aria-label="Send comment">Send</button>
            </div>
        </div>
    </div>
    <!-- Upload Modal -->
    <div class="modal-bg" id="upload-modal" aria-hidden="true" role="dialog" aria-label="Upload status">
        <div class="modal">
            <button class="close status-btn" onclick="closeModal('upload-modal')" aria-label="Close upload modal">&times;</button>
            <h3>Add to My Status</h3>
            <input type="file" id="status-upload" accept="image/*,video/*" aria-label="Upload status media">
            <button class="status-btn" onclick="uploadStatus()" aria-label="Upload status">Upload</button>
        </div>
    </div>
    <!-- Comment Modal -->
    <div class="modal-bg" id="comment-modal" aria-hidden="true" role="dialog" aria-label="Add comment">
        <div class="modal">
            <button class="close status-btn" onclick="closeModal('comment-modal')" aria-label="Close comment modal">&times;</button>
            <h3>Add Comment</h3>
            <div class="form-group">
                <label for="comment-text">Comment</label>
                <textarea id="comment-text" placeholder="Enter your comment" aria-label="Comment"></textarea>
            </div>
            <button class="status-btn" onclick="submitComment()" aria-label="Submit comment">Submit Comment</button>
        </div>
    </div>
    <!-- View Post Modal (First Instance) -->
    <div class="modal-bg view-post-modal" id="view-post-modal-1" aria-hidden="true" role="dialog" aria-label="View post details">
        <div class="modal">
            <button class="close status-btn" onclick="closeModal('view-post-modal-1')" aria-label="Close post modal">&times;</button>
            <div class="post-header">
                <img src="https://via.placeholder.com/40/35e0ff" alt="Agent profile" class="post-profile-img" loading="lazy">
                <div class="post-info">
                    <h4 id="property-owner">Property Owner:</h4>
                    <p id="uploaded-by">Uploaded by Agent:</p>
                </div>
            </div>
            <div class="post-content">
                <p id="property-description"></p>
                <div id="property-media"></div>
            </div>
            <h3>Choose Your Agent</h3>
            <div class="agents-list" id="agents-list" role="list"></div>
        </div>
    </div>
    <!-- View Post Modal (Second Instance) -->
    <div class="modal-bg view-post-modal" id="view-post-modal-2" aria-hidden="true" role="dialog" aria-label="View post details">
        <div class="modal">
            <button class="close status-btn" onclick="closeModal('view-post-modal-2')" aria-label="Close post modal">&times;</button>
            <h3>Post Details</h3>
            <div class="media-container" id="post-media"></div>
            <div class="chat-container">
                <h4>Chat with Agent</h4>
                <div class="chat-messages" id="chat-messages" role="log" aria-live="polite"></div>
                <div class="chat-input">
                    <input type="text" id="chat-input" placeholder="Type a message..." aria-label="Chat with agent">
                    <button class="status-btn" onclick="sendMessage()" aria-label="Send message to agent">Send</button>
                </div>
            </div>
            <div class="agent-selection" id="agent-selection">
                <h4>Select Agent</h4>
                <div class="agent-list" role="list">
                    <div class="agent-card">
                        <img src="https://via.placeholder.com/40/35e0ff" alt="Aisha Bello's profile" loading="lazy">
                        <div>
                            <h4>Aisha Bello</h4>
                            <p>Real Estate Expert</p>
                        </div>
                        <button class="status-btn" onclick="selectAgent('Aisha')" aria-label="Select Aisha Bello as agent">Select</button>
                    </div>
                    <div class="agent-card">
                        <img src="https://via.placeholder.com/40/ffd36a" alt="Usman Danjuma's profile" loading="lazy">
                        <div>
                            <h4>Usman Danjuma</h4>
                            <p>Crypto Specialist</p>
                        </div>
                        <button class="status-btn" onclick="selectAgent('Usman')" aria-label="Select Usman Danjuma as agent">Select</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Offer Modal -->
    <div class="modal-bg" id="offerModal" aria-hidden="true" role="dialog" aria-label="Create offer">
        <div class="modal">
            <h3>Create Offer</h3>
            <div class="form-group">
                <label for="offerAmount">Amount (₦ or currency)</label>
                <input id="offerAmount" type="number" placeholder="Enter amount" aria-label="Offer amount">
            </div>
            <div class="form-group">
                <label for="offerNote">Terms / Note</label>
                <textarea id="offerNote" rows="3" placeholder="Enter terms or note" aria-label="Offer terms"></textarea>
            </div>
            <div class="actions">
                <button class="btn decline status-btn" onclick="closeOffer()" aria-label="Cancel offer">Cancel</button>
                <button class="btn counter status-btn" onclick="sendOffer()" aria-label="Send offer">Send Offer</button>
            </div>
        </div>
    </div>
    <!-- Deposit Modal -->
    <div class="modal-bg" id="deposit-modal" aria-hidden="true" role="dialog" aria-label="Deposit funds">
        <div class="modal">
            <button class="close status-btn" onclick="closeModal('deposit-modal')" aria-label="Close deposit modal">&times;</button>
            <h3>Deposit Funds</h3>
            <div class="form-group">
                <label for="deposit-amount">Amount</label>
                <input type="number" id="deposit-amount" placeholder="Enter amount" aria-label="Deposit amount">
                <label for="deposit-fee">Gas / Fee</label>
                <input type="text" id="deposit-fee" value="1%" readonly aria-label="Deposit fee">
            </div>
            <div class="form-group">
                <label for="deposit-method">Payment Method</label>
                <select id="deposit-method" aria-label="Payment method">
                    <option value="bank">Bank Transfer</option>
                    <option value="crypto">Cryptocurrency</option>
                </select>
                <div class="form-row">
                    <div>
                        <label for="deposit-currency">Currency</label>
                        <select id="deposit-currency" aria-label="Deposit currency">
                            <option value="NGN">NGN</option>
                            <option value="BTC">BTC</option>
                            <option value="USD">USD</option>
                            <option value="ETH">ETH</option>
                        </select>
                    </div>
                    <div class="switch-container">
                        <span class="switch-label">Enable 2FA</span>
                        <div class="switch" onclick="toggle2FA(this)" role="switch" aria-checked="false">
                            <div class="dot" id="deposit-2fa"></div>
                        </div>
                    </div>
                    <div class="actions">
                        <button class="btn btn-primary status-btn" onclick="openOTP('deposit')" aria-label="Send deposit">Send</button>
                    </div>
                    <div class="progress-bar">
                        <div class="progress" id="deposit-progress-bar" aria-label="Deposit progress"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Withdraw Modal -->
    <div class="modal-bg" id="withdraw-modal" aria-hidden="true" role="dialog" aria-label="Withdraw funds">
        <div class="modal">
            <button class="close status-btn" onclick="closeModal('withdraw-modal')" aria-label="Close withdraw modal">&times;</button>
            <h3>Withdraw Funds</h3>
            <div class="form-group">
                <label for="withdraw-amount">Amount</label>
                <input type="number" id="withdraw-amount" placeholder="Enter amount" aria-label="Withdraw amount">
                <label for="withdraw-fee">Gas / Fee</label>
                <input type="text" id="withdraw-fee" value="1%" readonly aria-label="Withdraw fee">
            </div>
            <div class="form-group">
                <label for="withdraw-method">Withdrawal Method</label>
                <select id="withdraw-method" aria-label="Withdrawal method">
                    <option value="bank">Bank Transfer</option>
                    <option value="crypto">Cryptocurrency</option>
                </select>
                <div class="form-row">
                    <div>
                        <label for="withdraw-currency">Currency</label>
                        <select id="withdraw-currency" aria-label="Withdraw currency">
                            <option value="NGN">NGN</option>
                            <option value="BTC">BTC</option>
                            <option value="USD">USD</option>
                            <option value="ETH">ETH</option>
                        </select>
                    </div>
                </div>
                <button class="status-btn" onclick="openOTP('withdraw')" aria-label="Withdraw funds">Withdraw</button>
            </div>
        </div>
    </div>
    <!-- Transfer Modal -->
    <div class="modal-bg" id="transfer-modal" aria-hidden="true" role="dialog" aria-label="Transfer funds">
        <div class="modal">
            <button class="close status-btn" onclick="closeModal('transfer-modal')" aria-label="Close transfer modal">&times;</button>
            <h3>Transfer Funds</h3>
            <div class="form-group">
                <label for="transfer-amount">Amount</label>
                <input type="number" id="transfer-amount" placeholder="Enter amount" aria-label="Transfer amount">
                <label for="transfer-fee">Gas / Fee</label>
                <input type="text" id="transfer-fee" value="1%" readonly aria-label="Transfer fee">
            </div>
            <div class="form-group">
                <label for="transfer-recipient">Recipient</label>
                <input type="text" id="transfer-recipient" placeholder="Enter recipient" aria-label="Recipient">
            </div>
            <div class="form-row">
                <div>
                    <label for="transfer-currency">Currency</label>
                    <select id="transfer-currency" aria-label="Transfer currency">
                        <option value="NGN">NGN</option>
                        <option value="BTC">BTC</option>
                        <option value="USD">USD</option>
                        <option value="ETH">ETH</option>
                    </select>
                </div>
                <button class="status-btn" onclick="openOTP('transfer')" aria-label="Transfer funds">Transfer</button>
            </div>
        </div>
    </div>
    <!-- OTP/PIN Modal -->
    <div class="modal-bg" id="otp-modal" aria-hidden="true" role="dialog" aria-label="Verification">
        <div class="modal">
            <button class="close status-btn" onclick="closeModal('otp-modal')" aria-label="Close verification modal">&times;</button>
            <h3>Verification</h3>
            <p>Please choose a verification method to confirm this transaction.</p>
            <div class="form-group">
                <select id="verification-method" onchange="toggleVerificationMethod()" aria-label="Verification method">
                    <option value="otp">OTP (One Time Password)</option>
                    <option value="pin">6-Digit PIN</option>
                </select>
            </div>
            <div class="form-group" id="otp-section">
                <label for="otp-code">OTP Code</label>
                <input type="text" id="otp-code" placeholder="Enter OTP" aria-label="OTP code">
            </div>
            <div class="form-group" id="pin-section" style="display:none;">
                <label for="pin-code">6-Digit PIN</label>
                <input type="password" id="pin-code" maxlength="6" placeholder="Enter 6-digit PIN" aria-label="6-digit PIN">
            </div>
            <div class="actions">
                <button class="btn btn-primary status-btn" onclick="verifyOTP()" aria-label="Verify transaction">Verify</button>
            </div>
        </div>
    </div>
    <!-- Escrow Modal -->
    <div class="modal-bg" id="escrow-modal" aria-hidden="true" role="dialog" aria-label="Start escrow">
        <div class="modal">
            <button class="close status-btn" onclick="closeModal('escrow-modal')" aria-label="Close escrow modal">&times;</button>
            <h3>Start Escrow</h3>
            <div class="form-group">
                <label for="escrow-amount">Amount</label>
                <input type="number" id="escrow-amount" placeholder="Enter amount" aria-label="Escrow amount">
            </div>
            <div class="form-group">
                <label for="escrow-details">Details</label>
                <textarea id="escrow-details" placeholder="Enter escrow details" aria-label="Escrow details"></textarea>
            </div>
            <button class="status-btn" onclick="startEscrow()" aria-label="Start escrow">Start Escrow</button>
        </div>
    </div>
<!-- JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
<script>
  // Global State
  const state = {
    currentAction: null,
    currentContact: null,
    chats: {},
    mediaRecorder: null,
    recordedChunks: [],
    isRecording: false,
    currentUser: { name: 'Isah', isAgent: false, id: 'USER123' },
    agentsData: [
      { name: 'Ahmed Yusuf', title: 'Real Estate Specialist', profile: 'https://via.placeholder.com/50/35e0ff' },
      { name: 'Maryam Ali', title: 'Property Consultant', profile: 'https://via.placeholder.com/50/ffd36a' },
      { name: 'John Smith', title: 'Investment Advisor', profile: 'https://via.placeholder.com/50/888888' },
    ],
    statuses: [
      { name: 'Aisha', media: ['https://via.placeholder.com/400x600/35e0ff', 'https://via.placeholder.com/400x600/8b6dff'], seen: false },
      { name: 'Ibrahim', media: ['https://via.placeholder.com/400x600/8b6dff'], seen: false },
      { name: 'Usman', media: ['https://via.placeholder.com/400x600/ffd36a', 'https://via.placeholder.com/400x600/35e0ff'], seen: false },
    ],
    statusState: {
      currentUserIndex: 0,
      currentMediaIndex: 0,
      progressAnimation: null,
      isPaused: false,
      startTime: 0,
      duration: 5000,
    },
    upload: {
      capturedFiles: [],
      ownerSelfie: null,
      recentUploads: [],
      selfieCountdownTimer: null,
      stream: null,
      categoryData: {
        vehicle: { Cars: ['Sedan', 'SUV', 'Truck'], Motorcycles: ['Sport', 'Cruiser', 'Offroad'] },
        property: { House: ['Detached', 'Semi-Detached', 'Apartment'], Land: ['Residential', 'Commercial', 'Agricultural'] },
        business: { Company: ['SME', 'Startup', 'Enterprise'], Product: ['Electronics', 'Furniture', 'Clothing'] },
        legal: { Case: ['Civil', 'Criminal', 'Family'], Document: ['Contract', 'Affidavit', 'Evidence'] },
        management: { Reports: ['Daily', 'Weekly', 'Monthly'] },
        game: { Data: ['Leaderboard', 'Stats', 'Updates'] },
        advertisement: { Campaign: ['Poster', 'Video', 'Banner'] },
        mining: { Resources: ['Logs', 'Stats', 'Market'] },
      },
      conditionOptions: ['New', 'Used', 'Refurbished'],
    },
  };

  // Utility Functions
  const utils = {
    genId: () => Math.random().toString(36).slice(2, 11),
    escapeHtml: (text) => {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    },
    debounce: (func, wait) => {
      let timeout;
      return (...args) => {
        clearTimeout(timeout);
        timeout = setTimeout(() => func(...args), wait);
      };
    },
    formatDate: () => new Date().toISOString(),
  };

  // Notification System
  const notify = {
    show: (message, type = 'success') => {
      const notification = document.getElementById('notification') || document.getElementById('notif-list');
      if (!notification) {
        console.warn('Notification element not found');
        return;
      }
      if (notification.id === 'notif-list') {
        const n = document.createElement('div');
        n.className = `notif ${type}`;
        n.innerHTML = `${message} <span class="notif-close" onclick="this.parentElement.remove()">✖</span>`;
        notification.prepend(n);
        setTimeout(() => n.remove(), 5000);
      } else {
        const messageEl = document.getElementById('notification-message');
        if (messageEl) {
          messageEl.textContent = message;
          notification.className = `notification ${type} active`;
          notification.style.display = 'block';
          notification.setAttribute('aria-live', 'assertive');
          setTimeout(() => {
            notification.classList.remove('active');
            notification.style.display = 'none';
            notification.setAttribute('aria-live', 'polite');
          }, 3000);
        } else {
          console.warn('Notification message element not found');
        }
      }
    },
  };

  // Loader
  const initLoader = () => {
    window.addEventListener('load', () => {
      setTimeout(() => {
        const loader = document.getElementById('loader');
        if (loader) loader.classList.add('hidden');
        else console.warn('Loader element not found');
      }, 1000);
    });
  };

  // Particles.js
  const initParticles = () => {
    if (typeof particlesJS !== 'undefined') {
      particlesJS('particles-js', {
        particles: {
          number: { value: 80, density: { enable: true, value_area: 800 } },
          color: { value: ['#35e0ff', '#8b6dff', '#ffd36a'] },
          shape: { type: 'circle' },
          opacity: { value: 0.5, random: true },
          size: { value: 3, random: true },
          line_linked: { enable: false },
          move: { enable: true, speed: 2, direction: 'none', random: true },
        },
        interactivity: {
          detect_on: 'canvas',
          events: { onhover: { enable: true, mode: 'repulse' }, onclick: { enable: true, mode: 'push' } },
          modes: { repulse: { distance: 100, duration: 0.4 }, push: { particles_nb: 4 } },
        },
      });
    } else {
      console.warn('particlesJS not loaded');
    }
  };

  // Theme Toggle
  const initThemeToggle = () => {
    const toggle = document.getElementById('theme-toggle');
    if (!toggle) {
      console.warn('Theme toggle element not found');
      return;
    }
    toggle.addEventListener('click', () => {
      const body = document.body;
      const currentTheme = body.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      body.setAttribute('data-theme', newTheme);
      toggle.innerHTML = `<i class="fas fa-${newTheme === 'dark' ? 'moon' : 'sun'}"></i>`;
      toggle.setAttribute('aria-label', `Toggle ${newTheme} theme`);
    });
  };

  // Sidebar Toggle
  const initSidebarToggle = () => {
    const toggle = document.getElementById('sidebar-toggle');
    const sidebar = document.getElementById('sidebar');
    if (!toggle || !sidebar) {
      console.warn('Sidebar toggle or sidebar element not found');
      return;
    }
    toggle.addEventListener('click', () => {
      const isExpanded = toggle.getAttribute('aria-expanded') === 'true';
      toggle.setAttribute('aria-expanded', !isExpanded);
      sidebar.classList.toggle('active');
    });
  };

  // Navigation
  const initNavigation = () => {
    const navLinks = document.querySelectorAll('.nav-link');
    const slides = document.querySelectorAll('.slide');
    navLinks.forEach((link) => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const section = link.getAttribute('href')?.slice(1);
        if (!section) {
          console.warn('Navigation link href not found');
          return;
        }
        slides.forEach((slide) => slide.classList.remove('active-slide'));
        const targetSlide = document.getElementById(`${section}-slide`);
        if (targetSlide) targetSlide.classList.add('active-slide');
        else console.warn(`Slide ${section}-slide not found`);
        navLinks.forEach((l) => l.classList.remove('active'));
        link.classList.add('active');
        if (window.innerWidth <= 980) {
          const sidebar = document.getElementById('sidebar');
          const toggle = document.getElementById('sidebar-toggle');
          if (sidebar && toggle) {
            sidebar.classList.remove('active');
            toggle.setAttribute('aria-expanded', 'false');
          }
        }
      });
    });
  };

  // Modal Functions
  const modals = {
    open: (modalId) => {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.classList.add('active');
        modal.style.display = 'flex';
        modal.setAttribute('aria-hidden', 'false');
      } else {
        notify.show(`Modal ${modalId} not found`, 'error');
      }
    },
    close: (modalId) => {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.classList.remove('active');
        modal.style.display = 'none';
        modal.setAttribute('aria-hidden', 'true');
      } else {
        notify.show(`Modal ${modalId} not found`, 'error');
      }
    },
    openComment: (postId) => modals.open('comment-modal'),
    openViewPost: (postId, owner, agent, description, imageUrl, videoUrl, price, postLink) => {
      const ownerEl = document.getElementById('property-owner');
      const uploadedByEl = document.getElementById('uploaded-by');
      const descEl = document.getElementById('property-description');
      const mediaDiv = document.getElementById('property-media');
      const agentsListDiv = document.getElementById('agents-list');
      if (!ownerEl || !uploadedByEl || !descEl || !mediaDiv || !agentsListDiv) {
        notify.show('View post modal elements not found', 'error');
        return;
      }
      ownerEl.textContent = `Property Owner: ${owner}`;
      uploadedByEl.textContent = `Uploaded by Agent: ${agent}`;
      descEl.textContent = description;
      mediaDiv.innerHTML = '';
      if (imageUrl) mediaDiv.insertAdjacentHTML('beforeend', `<img src="${imageUrl}" class="post-media" alt="Post image" loading="lazy">`);
      if (videoUrl) mediaDiv.insertAdjacentHTML('beforeend', `<video controls class="post-media" aria-label="Post video"><source src="${videoUrl}" type="video/mp4"></video>`);
      agentsListDiv.innerHTML = state.currentUser.isAgent
        ? '<p>You are an agent, options are not available.</p>'
        : state.agentsData.map((a) => `
            <div class="agent-card">
              <img src="${a.profile}" alt="${a.name}'s profile" loading="lazy">
              <div>
                <h4>${a.name}</h4>
                <p>${a.title}</p>
                <button onclick="chat.start('${a.name}', '${postLink}', '${price}')" aria-label="Select ${a.name} as agent">Select Agent</button>
              </div>
            </div>
          `).join('');
      modals.open('view-post-modal');
    },
    openDeposit: () => modals.open('deposit-modal'),
    openWithdraw: () => modals.open('withdraw-modal'),
    openTransfer: () => modals.open('transfer-modal'),
    openEscrow: () => modals.open('escrow-modal'),
    openUpload: () => modals.open('upload-modal'),
  };

  // Placeholder Actions
  const actions = {
    toggleXGAI: () => notify.show('XG AI toggled'),
    toggleLike: (postId) => {
      const likeBtn = document.querySelector(`[data-post-id="${postId}"] .like-btn`);
      if (likeBtn) {
        likeBtn.classList.toggle('active');
        notify.show(likeBtn.classList.contains('active') ? 'Post liked' : 'Post unliked');
      } else {
        notify.show('Like button not found', 'error');
      }
    },
    submitComment: () => {
      notify.show('Comment submitted');
      modals.close('comment-modal');
    },
    sharePost: (postId) => notify.show('Post shared'),
    sendMessage: () => notify.show('Message sent'),
    selectAgent: (agent) => notify.show(`Agent ${agent} selected`),
    submitDeposit: () => {
      notify.show('Deposit submitted');
      modals.close('deposit-modal');
    },
    submitWithdraw: () => {
      notify.show('Withdrawal submitted');
      modals.close('withdraw-modal');
    },
    submitTransfer: () => {
      notify.show('Transfer submitted');
      modals.close('transfer-modal');
    },
    startEscrow: () => {
      notify.show('Escrow started');
      modals.close('escrow-modal');
    },
    applyLoan: () => notify.show('Loan application submitted'),
    createAd: () => notify.show('Ad created'),
    submitCase: () => notify.show('Case submitted'),
    uploadResource: () => notify.show('Resource uploaded'),
    saveSettings: () => notify.show('Settings saved'),
    manageZone: () => notify.show('Zone managed'),
  };

  // OTP Verification
  const otp = {
    open: (action) => {
      state.currentAction = action;
      modals.open('otp-modal');
    },
    toggleMethod: () => {
      const method = document.getElementById('verification-method')?.value;
      if (!method) {
        notify.show('Verification method not selected', 'error');
        return;
      }
      const otpSection = document.getElementById('otp-section');
      const pinSection = document.getElementById('pin-section');
      if (otpSection && pinSection) {
        otpSection.style.display = method === 'otp' ? 'block' : 'none';
        pinSection.style.display = method === 'pin' ? 'block' : 'none';
      } else {
        notify.show('OTP or PIN section not found', 'error');
      }
    },
    verify: () => {
      const method = document.getElementById('verification-method')?.value;
      if (!method) {
        notify.show('Verification method not selected', 'error');
        return;
      }
      let code = '';
      if (method === 'otp') {
        code = document.getElementById('otp-code')?.value?.trim();
        if (!code) {
          notify.show('Please enter OTP', 'error');
          return;
        }
      } else {
        code = document.getElementById('pin-code')?.value?.trim();
        if (code.length !== 6) {
          notify.show('Please enter a 6-digit PIN', 'error');
          return;
        }
      }
      modals.close('otp-modal');
      if (state.currentAction === 'deposit') actions.submitDeposit();
      else if (state.currentAction === 'withdraw') actions.submitWithdraw();
      else if (state.currentAction === 'transfer') actions.submitTransfer();
      else notify.show('Invalid action', 'error');
    },
  };

  // Video Capture
  const video = {
    stream: null,
    ownerStream: null,
    start: async () => {
      try {
        video.stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
        const videoEl = document.getElementById('video');
        if (videoEl) {
          videoEl.srcObject = video.stream;
          videoEl.classList.add('active');
          notify.show('Video stream started');
          state.mediaRecorder = new MediaRecorder(video.stream);
          state.mediaRecorder.ondataavailable = (e) => {
            if (e.data.size > 0) state.recordedChunks.push(e.data);
          };
          state.mediaRecorder.start();
          state.isRecording = true;
        } else {
          notify.show('Video element not found', 'error');
        }
      } catch (err) {
        notify.show(`Failed to start video: ${err.message}`, 'error');
      }
    },
    startOwnerVideo: async () => {
      try {
        video.ownerStream = await navigator.mediaDevices.getUserMedia({ video: true });
        const ownerVideoEl = document.getElementById('owner-video');
        if (ownerVideoEl) {
          ownerVideoEl.srcObject = video.ownerStream;
          ownerVideoEl.classList.add('active');
          notify.show('Owner video stream started');
        } else {
          notify.show('Owner video element not found', 'error');
        }
      } catch (err) {
        notify.show(`Failed to start owner video: ${err.message}`, 'error');
      }
    },
    capturePhoto: () => {
      const videoEl = document.getElementById('video');
      const canvas = document.getElementById('canvas');
      if (!videoEl || !canvas) {
        notify.show('Video or canvas element not found', 'error');
        return;
      }
      canvas.width = videoEl.videoWidth;
      canvas.height = videoEl.videoHeight;
      canvas.getContext('2d').drawImage(videoEl, 0, 0);
      const dataUrl = canvas.toDataURL('image/jpeg');
      state.upload.capturedFiles.push({ url: dataUrl, type: 'image' });
      upload.addPreview(dataUrl, 'Photo');
      notify.show('Photo captured successfully');
    },
    captureOwnerSelfie: () => {
      const videoEl = document.getElementById('owner-video');
      const canvas = document.getElementById('owner-canvas');
      if (!videoEl || !canvas) {
        notify.show('Owner video or canvas element not found', 'error');
        return;
      }
      canvas.width = videoEl.videoWidth;
      canvas.height = videoEl.videoHeight;
      canvas.getContext('2d').drawImage(videoEl, 0, 0);
      state.upload.ownerSelfie = canvas.toDataURL('image/jpeg');
      upload.addPreview(state.upload.ownerSelfie, 'Selfie');
      notify.show('Selfie captured successfully');
    },
    stopRecording: () => {
      if (state.mediaRecorder && state.isRecording) {
        state.mediaRecorder.stop();
        state.isRecording = false;
        const blob = new Blob(state.recordedChunks, { type: 'video/webm' });
        const dataUrl = URL.createObjectURL(blob);
        state.upload.capturedFiles.push({ url: dataUrl, type: 'video' });
        upload.addPreview(dataUrl, 'Video');
        state.recordedChunks = [];
        notify.show('Video recording stopped');
      } else {
        notify.show('No recording in progress', 'error');
      }
    },
    stop: () => {
      [video.stream, video.ownerStream].forEach((stream) => {
        if (stream) {
          stream.getTracks().forEach((track) => track.stop());
        }
      });
      const videoEl = document.getElementById('video');
      const ownerVideoEl = document.getElementById('owner-video');
      if (videoEl) videoEl.classList.remove('active');
      if (ownerVideoEl) ownerVideoEl.classList.remove('active');
      state.isRecording = false;
      notify.show('Video stopped');
    },
    applyFilter: () => {
      const filter = document.getElementById('filter-select')?.value;
      const videoEl = document.getElementById('video');
      if (videoEl && filter) {
        videoEl.style.filter = filter === 'none' ? '' : filter;
        notify.show(`Applied ${filter} filter`);
      } else {
        notify.show('Filter select or video element not found', 'error');
      }
    },
  };

  // File Preview and Drag-and-Drop
  const initFilePreview = () => {
    const docUpload = document.getElementById('doc-upload');
    const ownerId = document.getElementById('owner-id');
    const dropArea = document.getElementById('drag-drop-area');
    if (docUpload) {
      docUpload.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (!file) return;
        if (!file.type.startsWith('image/') && !file.type.startsWith('video/')) {
          notify.show('Only images and videos allowed', 'error');
          return;
        }
        const dataUrl = URL.createObjectURL(file);
        state.upload.capturedFiles.push({ url: dataUrl, type: file.type.startsWith('image') ? 'image' : 'video', name: file.name });
        upload.addPreview(dataUrl, file.type.startsWith('image') ? 'Image' : 'Video');
        notify.show(`File uploaded: ${file.name}`);
      });
    }
    if (ownerId) {
      ownerId.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (!file) return;
        const dataUrl = URL.createObjectURL(file);
        state.upload.capturedFiles.push({ url: dataUrl, type: file.type.startsWith('image') ? 'image' : 'file', name: file.name });
        upload.addPreview(dataUrl, file.name);
        notify.show(`Owner ID uploaded: ${file.name}`);
      });
    }
    if (dropArea) {
      dropArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropArea.classList.add('drag-over');
      });
      dropArea.addEventListener('dragleave', () => {
        dropArea.classList.remove('drag-over');
      });
      dropArea.addEventListener('drop', (e) => {
        e.preventDefault();
        dropArea.classList.remove('drag-over');
        const files = e.dataTransfer.files;
        for (const file of files) {
          if (!file.type.startsWith('image/') && !file.type.startsWith('video/')) {
            notify.show('Only images and videos allowed', 'error');
            continue;
          }
          if (file.size > 100 * 1024 * 1024) {
            notify.show('File size exceeds 100MB limit', 'error');
            continue;
          }
          const dataUrl = URL.createObjectURL(file);
          state.upload.capturedFiles.push({ url: dataUrl, type: file.type.startsWith('image') ? 'image' : 'video', name: file.name });
          upload.addPreview(dataUrl, file.type.startsWith('image') ? 'Image' : 'Video');
          notify.show(`File uploaded: ${file.name}`);
        }
      });
    }
  };

  // Map Initialization
  const initMap = () => {
    const mapEl = document.getElementById('zone-map');
    if (!mapEl) {
      console.warn('Map element not found');
      return;
    }
    const map = L.map('zone-map').setView([6.5244, 3.3792], 10);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
    }).addTo(map);
    L.marker([6.5244, 3.3792]).addTo(map).bindPopup('Lagos Zone').openPopup();
  };

  // Date and Time
  const initDateTime = () => {
    const update = () => {
      const dayTime = document.getElementById('day-time');
      if (dayTime) dayTime.textContent = new Date().toLocaleString('en-US', { timeZone: 'Africa/Lagos' });
      else console.warn('Day-time element not found');
    };
    update();
    setInterval(update, 1000);
  };

  // Scroll Effect for Navbar
  const initNavbarScroll = () => {
    window.addEventListener('scroll', () => {
      const navbar = document.querySelector('.navbar');
      if (navbar) navbar.classList.toggle('scrolled', window.scrollY > 50);
      else console.warn('Navbar element not found');
    });
  };

  // Chat Functions
  const chat = {
    start: (agentName, postLink, price) => {
      const chatUrl = `/chat?agent=${encodeURIComponent(agentName)}&post=${encodeURIComponent(postLink)}&price=${encodeURIComponent(price)}`;
      window.location.href = chatUrl;
    },
    filterContacts: utils.debounce(() => {
      const query = document.getElementById('searchInput')?.value.toLowerCase() || '';
      const cards = document.querySelectorAll('.contact-card');
      cards.forEach((c) => {
        const name = c.dataset.name?.toLowerCase() || '';
        c.style.display = name.includes(query) ? 'flex' : 'none';
      });
    }, 300),
    openConversation: (name, sub, avatar, online) => {
      state.currentContact = name;
      const chatName = document.getElementById('chatName');
      const chatSub = document.getElementById('chatSub');
      const chatAvatar = document.getElementById('chatAvatar');
      const statusDot = document.getElementById('statusDot');
      const negTag = document.getElementById('negTag');
      if (!chatName || !chatSub || !chatAvatar || !statusDot || !negTag) {
        notify.show('Chat elements not found', 'error');
        return;
      }
      chatName.textContent = name;
      chatSub.textContent = sub || '';
      chatAvatar.src = avatar || 'https://via.placeholder.com/48/35e0ff';
      statusDot.style.display = online ? 'inline-block' : 'none';
      negTag.style.display = sub?.includes('Negotiating') ? 'inline-block' : 'none';
      chat.render();
    },
    render: () => {
      const body = document.getElementById('chatBody');
      if (!body) {
        notify.show('Chat body element not found', 'error');
        return;
      }
      body.innerHTML = '';
      const list = state.chats[state.currentContact] || [];
      if (!list.length) {
        body.innerHTML = `<div class="msg-row received"><div><div class="msg received">No messages yet. Start negotiating by sending a message or creating an offer (💼).</div></div></div>`;
        return;
      }
      list.forEach((m) => {
        const row = document.createElement('div');
        row.className = `msg-row ${m.sent ? 'sent' : 'received'}`;
        let content = '';
        if (m.type === 'offer') {
          content = `
            <div class="neg-card">
              <strong>${m.sent ? 'You offered' : 'Offer'}</strong>
              <div class="offer-amount">${m.amount || '—'}</div>
              <div class="offer-note">${m.note || ''}</div>
              <div class="actions">
                <button class="btn accept" onclick="chat.respondOffer('${m.id}', 'accept')" aria-label="Accept offer">Accept</button>
                <button class="btn decline" onclick="chat.respondOffer('${m.id}', 'decline')" aria-label="Decline offer">Decline</button>
                <button class="btn counter" onclick="chat.respondOffer('${m.id}', 'counter')" aria-label="Counter offer">Counter</button>
              </div>
            </div>`;
        } else if (m.type === 'file') {
          content = `<div class="msg ${m.sent ? 'sent' : 'received'}">${m.name || 'File'}</div><div class="meta">${m.time}</div>`;
        } else if (m.type === 'voice') {
          content = `<div class="msg ${m.sent ? 'sent' : 'received'}"><audio controls src="${m.url}" aria-label="Voice message"></audio></div><div class="meta">${m.time}</div>`;
        } else {
          content = `<div class="msg ${m.sent ? 'sent' : 'received'}">${utils.escapeHtml(m.text)}</div><div class="meta">${m.time}</div>`;
        }
        row.innerHTML = `<div>${content}</div>`;
        body.appendChild(row);
      });
      body.scrollTop = body.scrollHeight;
    },
    sendText: () => {
      if (!state.currentContact) {
        notify.show('Select a contact', 'error');
        return;
      }
      const input = document.getElementById('chatInput');
      if (!input) {
        notify.show('Chat input element not found', 'error');
        return;
      }
      const text = input.value.trim();
      if (!text) return;
      const msg = { type: 'text', text, sent: true, time: new Date().toLocaleString(), id: utils.genId() };
      state.chats[state.currentContact] = state.chats[state.currentContact] || [];
      state.chats[state.currentContact].push(msg);
      input.value = '';
      chat.render();
      setTimeout(() => {
        state.chats[state.currentContact].push({
          type: 'text',
          text: `Acknowledged: ${text}`,
          sent: false,
          time: new Date().toLocaleString(),
          id: utils.genId(),
        });
        chat.render();
      }, 1000);
    },
    handleFile: (event) => {
      const file = event.target.files[0];
      if (!file || !state.currentContact) {
        notify.show('No file selected or contact not chosen', 'error');
        return;
      }
      const url = URL.createObjectURL(file);
      const preview = document.getElementById('attachPreview');
      if (preview) {
        preview.classList.add('active');
        preview.innerHTML = file.type.startsWith('image/')
          ? `<img src="${url}" class="preview-image" alt="File preview" loading="lazy">`
          : `<p>${file.name}</p>`;
      }
      state.chats[state.currentContact] = state.chats[state.currentContact] || [];
      state.chats[state.currentContact].push({
        type: 'file',
        name: file.name,
        url,
        sent: true,
        time: new Date().toLocaleString(),
        id: utils.genId(),
      });
      setTimeout(() => {
        chat.render();
        if (preview) preview.classList.remove('active');
      }, 1000);
    },
    handleCamera: (event) => {
      const file = event.target.files[0];
      if (!file || !state.currentContact) {
        notify.show('No file selected or contact not chosen', 'error');
        return;
      }
      const url = URL.createObjectURL(file);
      const preview = document.getElementById('attachPreview');
      if (preview) {
        preview.classList.add('active');
        preview.innerHTML = `<img src="${url}" class="preview-image" alt="Camera preview" loading="lazy">`;
      }
      state.chats[state.currentContact] = state.chats[state.currentContact] || [];
      state.chats[state.currentContact].push({
        type: 'file',
        name: 'Photo',
        url,
        sent: true,
        time: new Date().toLocaleString(),
        id: utils.genId(),
      });
      setTimeout(() => {
        chat.render();
        if (preview) preview.classList.remove('active');
      }, 1000);
    },
    toggleRecord: () => {
      if (!state.isRecording) {
        navigator.mediaDevices.getUserMedia({ audio: true })
          .then((s) => {
            state.mediaRecorder = new MediaRecorder(s);
            state.mediaRecorder.ondataavailable = (e) => state.recordedChunks.push(e.data);
            state.mediaRecorder.onstop = () => {
              const blob = new Blob(state.recordedChunks, { type: 'audio/webm' });
              const url = URL.createObjectURL(blob);
              if (state.currentContact) {
                state.chats[state.currentContact] = state.chats[state.currentContact] || [];
                state.chats[state.currentContact].push({
                  type: 'voice',
                  url,
                  sent: true,
                  time: new Date().toLocaleString(),
                  id: utils.genId(),
                });
                chat.render();
              }
              state.recordedChunks = [];
            };
            state.mediaRecorder.start();
            state.isRecording = true;
            const recBtn = document.getElementById('recBtn');
            if (recBtn) recBtn.classList.add('recording');
            notify.show('Recording started');
          })
          .catch(() => notify.show('Failed to access microphone', 'error'));
      } else {
        if (state.mediaRecorder) state.mediaRecorder.stop();
        state.isRecording = false;
        const recBtn = document.getElementById('recBtn');
        if (recBtn) recBtn.classList.remove('recording');
        notify.show('Recording stopped');
      }
    },
    openOffer: () => {
      if (!state.currentContact) {
        notify.show('Select a contact', 'error');
        return;
      }
      modals.open('offerModal');
    },
    closeOffer: () => {
      const modal = document.getElementById('offerModal');
      const amount = document.getElementById('offerAmount');
      const note = document.getElementById('offerNote');
      if (!modal || !amount || !note) {
        notify.show('Offer modal elements not found', 'error');
        return;
      }
      modal.style.display = 'none';
      modal.setAttribute('aria-hidden', 'true');
      amount.value = '';
      note.value = '';
    },
    sendOffer: () => {
      if (!state.currentContact) {
        notify.show('Select a contact', 'error');
        return;
      }
      const amount = document.getElementById('offerAmount')?.value;
      const note = document.getElementById('offerNote')?.value;
      if (!amount) {
        notify.show('Enter an amount', 'error');
        return;
      }
      state.chats[state.currentContact] = state.chats[state.currentContact] || [];
      state.chats[state.currentContact].push({
        type: 'offer',
        amount,
        note,
        sent: true,
        time: new Date().toLocaleString(),
        id: utils.genId(),
      });
      chat.render();
      chat.closeOffer();
      notify.show('Offer sent');
      setTimeout(() => {
        state.chats[state.currentContact].push({
          type: 'text',
          text: `Received your offer of ${amount}. Reviewing...`,
          sent: false,
          time: new Date().toLocaleString(),
          id: utils.genId(),
        });
        chat.render();
      }, 1500);
    },
    respondOffer: (id, action) => {
      if (!state.currentContact) {
        notify.show('Select a contact', 'error');
        return;
      }
      const msg = state.chats[state.currentContact]?.find((m) => m.id === id);
      if (!msg) {
        notify.show('Offer not found', 'error');
        return;
      }
      let responseText = '';
      if (action === 'accept') responseText = `Offer of ${msg.amount} accepted!`;
      else if (action === 'decline') responseText = `Offer of ${msg.amount} declined.`;
      else if (action === 'counter') {
        responseText = `Counter-offer: ${parseFloat(msg.amount) + 10000}`;
        state.chats[state.currentContact].push({
          type: 'offer',
          amount: responseText,
          note: 'Counter-offer',
          sent: false,
          time: new Date().toLocaleString(),
          id: utils.genId(),
        });
      }
      state.chats[state.currentContact].push({
        type: 'text',
        text: responseText,
        sent: true,
        time: new Date().toLocaleString(),
        id: utils.genId(),
      });
      chat.render();
      notify.show(`${action.charAt(0).toUpperCase() + action.slice(1)} sent`);
    },
  };

  // Status Functions
  const status = {
    open: (userIndex) => {
      state.statusState.currentUserIndex = userIndex;
      state.statusState.currentMediaIndex = 0;
      status.show();
      const modal = document.getElementById('status-modal');
      if (modal) {
        modal.style.display = 'flex';
        modal.setAttribute('aria-hidden', 'false');
      } else {
        notify.show('Status modal not found', 'error');
      }
      state.statuses[userIndex].seen = true;
      status.updateBorders();
    },
    updateBorders: () => {
      const items = document.querySelectorAll('.status-item');
      items.forEach((el, index) => {
        if (index > 0 && state.statuses[index - 1]?.seen) {
          const circle = el.querySelector('.status-circle');
          if (circle) circle.style.borderColor = '#ccc';
        }
      });
    },
    show: () => {
      clearInterval(state.statusState.progressAnimation);
      const user = state.statuses[state.statusState.currentUserIndex];
      const mediaUrl = user.media[state.statusState.currentMediaIndex];
      const progressContainer = document.getElementById('progress-container');
      const contentDiv = document.getElementById('status-content');
      const userEl = document.getElementById('status-user');
      if (!progressContainer || !contentDiv || !userEl) {
        notify.show('Status elements not found', 'error');
        return;
      }
      contentDiv.style.opacity = 0;
      setTimeout(() => {
        contentDiv.innerHTML = mediaUrl.endsWith('.mp4')
          ? `<video id="status-video" autoplay muted class="status-media" aria-label="Status video"><source src="${mediaUrl}" type="video/mp4"></video>`
          : `<img src="${mediaUrl}" class="status-media" alt="${user.name}'s status" loading="lazy">`;
        contentDiv.style.transition = 'opacity 0.3s';
        contentDiv.style.opacity = 1;
        userEl.textContent = `${user.name}'s Status`;
        progressContainer.innerHTML = user.media.map((_, index) => `
          <div class="status-progress" style="flex:1;height:3px;background:${index < state.statusState.currentMediaIndex ? '#ccc' : '#fff'};margin:0 2px;"></div>
        `).join('');
        status.animateProgress();
      }, 200);
    },
    animateProgress: () => {
      const bars = document.querySelectorAll('#progress-container .status-progress');
      state.statusState.startTime = Date.now();
      state.statusState.progressAnimation = setInterval(() => {
        if (state.statusState.isPaused) return;
        const elapsed = Date.now() - state.statusState.startTime;
        const percent = Math.min((elapsed / state.statusState.duration) * 100, 100);
        const bar = bars[state.statusState.currentMediaIndex];
        if (bar) {
          bar.style.background = `linear-gradient(to right, #fff ${percent}%, #ccc ${percent}%)`;
        }
        if (percent >= 100) {
          clearInterval(state.statusState.progressAnimation);
          status.next();
        }
      }, 20);
    },
    next: () => {
      const user = state.statuses[state.statusState.currentUserIndex];
      if (state.statusState.currentMediaIndex < user.media.length - 1) {
        state.statusState.currentMediaIndex++;
      } else if (state.statusState.currentUserIndex < state.statuses.length - 1) {
        state.statusState.currentUserIndex++;
        state.statusState.currentMediaIndex = 0;
      } else {
        modals.close('status-modal');
        return;
      }
      status.show();
    },
    handleClick: (e) => {
      const clickX = e.clientX;
      const modal = e.currentTarget;
      const middle = modal.offsetWidth / 2;
      if (clickX < middle) {
        if (state.statusState.currentMediaIndex > 0) {
          state.statusState.currentMediaIndex--;
        } else if (state.statusState.currentUserIndex > 0) {
          state.statusState.currentUserIndex--;
          state.statusState.currentMediaIndex = state.statuses[state.statusState.currentUserIndex].media.length - 1;
        }
      } else {
        status.next();
      }
      status.show();
    },
    pause: () => {
      state.statusState.isPaused = true;
    },
    resume: () => {
      state.statusState.isPaused = false;
    },
    openMyStatus: () => {
      modals.open('upload-modal');
    },
    upload: () => {
      const file = document.getElementById('status-upload')?.files[0];
      if (!file) {
        notify.show('Please select a photo or video', 'error');
        return;
      }
      const dataUrl = URL.createObjectURL(file);
      state.statuses.push({
        name: state.currentUser.name,
        media: [dataUrl],
        seen: false,
      });
      notify.show(`Uploaded ${file.name} to My Status!`);
      modals.close('upload-modal');
    },
    sendMessage: () => {
      const message = document.getElementById('status-message')?.value?.trim();
      if (!message) {
        notify.show('Please type a message', 'error');
        return;
      }
      const user = state.statuses[state.statusState.currentUserIndex];
      notify.show(`Message sent to ${user.name}!`);
      document.getElementById('status-message').value = '';
    },
    showReaction: () => {
      const contentDiv = document.getElementById('status-content');
      if (!contentDiv) {
        notify.show('Status content element not found', 'error');
        return;
      }
      const heart = document.createElement('div');
      heart.innerHTML = '❤️';
      heart.className = 'reaction-heart';
      contentDiv.appendChild(heart);
      setTimeout(() => {
        heart.style.transform = 'translate(-50%, -50%) scale(1.5)';
        heart.style.opacity = '1';
      }, 50);
      setTimeout(() => {
        heart.style.opacity = '0';
        setTimeout(() => contentDiv.removeChild(heart), 500);
      }, 800);
    },
  };

  // Upload Hub Functions
  const upload = {
    updateProgress: (step) => {
      const steps = document.querySelectorAll('#progress-bar span');
      if (!steps.length) {
        console.warn('Progress bar elements not found');
        return;
      }
      steps.forEach((el, i) => {
        el.className = i + 1 <= step ? 'progress-step active' : 'progress-step';
      });
    },
    updateSubCategory: () => {
      const category = document.getElementById('upload-category')?.value;
      const subSelect = document.getElementById('upload-subcategory');
      if (!category || !subSelect) {
        notify.show('Category or subcategory select not found', 'error');
        return;
      }
      subSelect.innerHTML = '<option value="">--Select Subcategory--</option>';
      if (state.upload.categoryData[category]) {
        subSelect.innerHTML += Object.keys(state.upload.categoryData[category])
          .map((sub) => `<option value="${sub}">${sub}</option>`)
          .join('');
      }
      upload.updateType();
      upload.updateOwnerVerification();
      upload.updateProgress(1);
    },
    updateType: () => {
      const category = document.getElementById('upload-category')?.value;
      const subcategory = document.getElementById('upload-subcategory')?.value;
      const typeSelect = document.getElementById('upload-type');
      if (!category || !subcategory || !typeSelect) {
        notify.show('Category, subcategory, or type select not found', 'error');
        return;
      }
      typeSelect.innerHTML = '<option value="">--Select Type--</option>';
      if (state.upload.categoryData[category]?.[subcategory]) {
        typeSelect.innerHTML += state.upload.categoryData[category][subcategory]
          .map((t) => `<option value="${t}">${t}</option>`)
          .join('');
      }
      upload.updateCondition();
      upload.updateProgress(1);
    },
    updateCondition: () => {
      const condSelect = document.getElementById('upload-condition');
      if (!condSelect) {
        notify.show('Condition select not found', 'error');
        return;
      }
      condSelect.innerHTML = '<option value="">--Select Condition--</option>';
      condSelect.innerHTML += state.upload.conditionOptions
        .map((c) => `<option value="${c}">${c}</option>`)
        .join('');
      const category = document.getElementById('upload-category')?.value;
      const priceGroup = document.getElementById('price-group');
      if (priceGroup) {
        priceGroup.classList.toggle('active', ['vehicle', 'property', 'business'].includes(category));
      } else {
        console.warn('Price group element not found');
      }
      upload.updateProgress(['vehicle', 'property', 'business'].includes(category) ? 2 : 1);
    },
    updateOwnerVerification: () => {
      const category = document.getElementById('upload-category')?.value;
      const ownerStep = document.getElementById('owner-verification-step');
      if (ownerStep) {
        ownerStep.classList.toggle('active', ['vehicle', 'property', 'business'].includes(category));
      } else {
        console.warn('Owner verification step element not found');
      }
      upload.updateProgress(['vehicle', 'property', 'business'].includes(category) ? 2 : 1);
    },
    addPreview: (dataUrl, type) => {
      const gallery = document.getElementById('preview-gallery');
      if (!gallery) {
        notify.show('Preview gallery element not found', 'error');
        return;
      }
      const container = document.createElement('div');
      container.className = 'preview-item';
      let element;
      if (type === 'image' || type === 'Photo' || type === 'Selfie') {
        element = document.createElement('img');
        element.src = dataUrl;
        element.alt = `${type} preview`;
        element.className = 'preview-image';
      } else if (type === 'video') {
        element = document.createElement('video');
        element.src = dataUrl;
        element.controls = true;
        element.alt = 'Video preview';
        element.className = 'preview-image';
      } else {
        element = document.createElement('p');
        element.textContent = type;
      }
      const removeBtn = document.createElement('button');
      removeBtn.textContent = 'Remove';
      removeBtn.className = 'status-btn';
      removeBtn.onclick = () => {
        gallery.removeChild(container);
        state.upload.capturedFiles = state.upload.capturedFiles.filter((f) => f.url !== dataUrl);
        if (dataUrl === state.upload.ownerSelfie) state.upload.ownerSelfie = null;
        URL.revokeObjectURL(dataUrl);
      };
      container.appendChild(element);
      container.appendChild(removeBtn);
      gallery.appendChild(container);
    },
    submit: async () => {
      const submitBtn = document.getElementById('submit-btn');
      if (!submitBtn) {
        notify.show('Submit button not found', 'error');
        return;
      }
      submitBtn.disabled = true;
      submitBtn.textContent = 'Submitting...';
      const category = document.getElementById('upload-category')?.value;
      const subcategory = document.getElementById('upload-subcategory')?.value;
      const type = document.getElementById('upload-type')?.value;
      const condition = document.getElementById('upload-condition')?.value;
      const price = document.getElementById('upload-price')?.value;
      const ownerName = document.getElementById('owner-name')?.value;
      const ownerContact = document.getElementById('owner-contact')?.value;
      if (!category || !subcategory || !type || !condition || (['vehicle', 'property', 'business'].includes(category) && (!price || !ownerName || !ownerContact))) {
        notify.show('Please fill all required fields', 'error');
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit';
        return;
      }
      const uploadObj = {
        userId: state.currentUser.id,
        timestampUTC: utils.formatDate(),
        deviceID: navigator.userAgent,
        category,
        subcategory,
        type,
        condition,
        price: price || null,
        currency: document.getElementById('upload-currency')?.value || null,
        boost: document.getElementById('boost-upload')?.checked || false,
        ownerName: ownerName || null,
        ownerContact: ownerContact || null,
        files: [...state.upload.capturedFiles],
        ownerSelfie: state.upload.ownerSelfie,
        status: 'Pending',
      };
      state.upload.recentUploads.unshift(uploadObj);
      state.upload.capturedFiles = [];
      state.upload.ownerSelfie = null;
      const gallery = document.getElementById('preview-gallery');
      if (gallery) gallery.innerHTML = '';
      upload.render();
      notify.show(`Upload submitted: ${uploadObj.category}/${uploadObj.subcategory}/${uploadObj.type}`);
      const uploadStatus = document.getElementById('upload-status');
      if (uploadStatus) uploadStatus.textContent = 'Status: Submitted — Pending Review';
      submitBtn.disabled = false;
      submitBtn.textContent = 'Submit';
      upload.updateProgress(3);
    },
    render: () => {
      const list = document.getElementById('upload-list');
      if (!list) {
        notify.show('Upload list element not found', 'error');
        return;
      }
      list.innerHTML = state.upload.recentUploads
        .map((u, i) => `
          <div class="upload-item">
            ${u.category} > ${u.subcategory} > ${u.type}
            <span class="status-badge ${u.status.toLowerCase()}">${u.status}</span>
            <button onclick="upload.approve(${i})" aria-label="Approve upload">Approve</button>
            <button onclick="upload.reject(${i})" aria-label="Reject upload">Reject</button>
          </div>
        `)
        .join('');
    },
    approve: (idx) => {
      state.upload.recentUploads[idx].status = 'Approved';
      upload.render();
      notify.show(`Upload Approved: ${state.upload.recentUploads[idx].category}`);
    },
    reject: (idx) => {
      state.upload.recentUploads[idx].status = 'Rejected';
      upload.render();
      notify.show(`Upload Rejected: ${state.upload.recentUploads[idx].category}`);
    },
    filter: utils.debounce(() => {
      const query = document.getElementById('search-box')?.value.toLowerCase() || '';
      upload.render();
      if (query) {
        document.querySelectorAll('#upload-list .upload-item').forEach((el) => {
          if (!el.textContent.toLowerCase().includes(query)) el.style.display = 'none';
        });
      }
    }, 300),
    filterByCategory: (category) => {
      const searchBox = document.getElementById('search-box');
      if (searchBox) searchBox.value = '';
      upload.render();
      document.querySelectorAll('#upload-list .upload-item').forEach((el) => {
        if (!el.textContent.toLowerCase().includes(category.toLowerCase())) el.style.display = 'none';
      });
    },
    startSelfieCountdown: () => {
      const countdownEl = document.getElementById('selfie-countdown');
      if (!countdownEl) {
        notify.show('Selfie countdown element not found', 'error');
        return;
      }
      let count = 3;
      countdownEl.textContent = `Selfie in ${count}...`;
      clearInterval(state.upload.selfieCountdownTimer);
      state.upload.selfieCountdownTimer = setInterval(() => {
        count--;
        if (count > 0) {
          countdownEl.textContent = `Selfie in ${count}...`;
        } else {
          countdownEl.textContent = '';
          clearInterval(state.upload.selfieCountdownTimer);
          video.captureOwnerSelfie();
        }
      }, 1000);
      video.startOwnerVideo();
    },
  };

  // Search Suggestions
  const initSearchSuggestions = () => {
    const searchInput = document.getElementById('search-input');
    if (!searchInput) {
      console.warn('Search input element not found');
      return;
    }
    searchInput.addEventListener(
      'input',
      utils.debounce((e) => {
        const query = e.target.value.toLowerCase();
        const suggestions = document.getElementById('search-suggestions');
        if (!suggestions) {
          console.warn('Search suggestions element not found');
          return;
        }
        suggestions.innerHTML = '';
        if (query) {
          const matches = ['Property in Lagos', 'Crypto Trading', 'Real Estate Deals', 'Aisha Bello', 'Usman Danjuma'].filter((item) =>
            item.toLowerCase().includes(query)
          );
          suggestions.innerHTML = matches.map((match) => `<div class="suggestion-item">${match}</div>`).join('');
          suggestions.setAttribute('aria-hidden', 'false');
          suggestions.querySelectorAll('.suggestion-item').forEach((div) => {
            div.addEventListener('click', () => {
              searchInput.value = div.textContent;
              suggestions.innerHTML = '';
              suggestions.setAttribute('aria-hidden', 'true');
            });
          });
        } else {
          suggestions.setAttribute('aria-hidden', 'true');
        }
      }, 300)
    );
  };

  // Transaction Filters
  const initTransactionFilters = () => {
    document.querySelectorAll('.filter-btn').forEach((btn) => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.filter-btn').forEach((b) => b.classList.remove('active'));
        btn.classList.add('active');
        const filter = btn.dataset.filter;
        document.querySelectorAll('.transaction-item').forEach((item) => {
          const icon = item.querySelector('.desc .icon i');
          item.style.display = filter === 'all' || (icon && icon.classList.contains(`fa-${filter}`)) ? 'flex' : 'none';
        });
      });
    });
    const categoryFilter = document.querySelector('.category-filter');
    if (categoryFilter) {
      categoryFilter.addEventListener('change', (e) => {
        const filter = e.target.value;
        document.querySelectorAll('.transaction-item').forEach((item) => {
          const details = item.querySelector('.details');
          item.style.display = filter === 'all' || (details && details.textContent.includes(filter)) ? 'flex' : 'none';
        });
      });
    }
  };

  // Initialize Functions
  const init = () => {
    initLoader();
    initParticles();
    initThemeToggle();
    initSidebarToggle();
    initNavigation();
    initFilePreview();
    initMap();
    initDateTime();
    initNavbarScroll();
    initSearchSuggestions();
    initTransactionFilters();

    const statusModal = document.getElementById('status-modal');
    const statusContent = document.getElementById('status-content');
    if (statusModal) {
      statusModal.addEventListener('click', status.handleClick);
      let touchStartY = 0;
      statusModal.addEventListener('touchstart', (e) => {
        touchStartY = e.touches[0].clientY;
      });
      statusModal.addEventListener('touchmove', (e) => {
        const touchEndY = e.touches[0].clientY;
        if (Math.abs(touchEndY - touchStartY) > 100) {
          modals.close('status-modal');
        }
      });
    } else {
      console.warn('Status modal not found');
    }
    if (statusContent) {
      statusContent.addEventListener('mouseover', status.pause);
      statusContent.addEventListener('mouseout', status.resume);
      let lastTap = 0;
      statusContent.addEventListener('click', () => {
        const currentTime = Date.now();
        const tapLength = currentTime - lastTap;
        if (tapLength < 300 && tapLength > 0) {
          status.showReaction();
        }
        lastTap = currentTime;
      });
    } else {
      console.warn('Status content not found');
    }

    const uploadCategory = document.getElementById('upload-category');
    const uploadSubcategory = document.getElementById('upload-subcategory');
    const uploadType = document.getElementById('upload-type');
    const searchBox = document.getElementById('search-box');
    const filterSelect = document.getElementById('filter-select');
    if (uploadCategory) uploadCategory.addEventListener('change', upload.updateSubCategory);
    if (uploadSubcategory) uploadSubcategory.addEventListener('change', upload.updateType);
    if (uploadType) uploadType.addEventListener('change', upload.updateCondition);
    if (searchBox) searchBox.addEventListener('input', upload.filter);
    if (filterSelect) filterSelect.addEventListener('change', video.applyFilter);

    window.toggleXGAI = actions.toggleXGAI;
    window.toggleLike = actions.toggleLike;
    window.openCommentModal = modals.openComment;
    window.openViewPostModal = modals.openViewPost;
    window.openDepositModal = modals.openDeposit;
    window.openWithdrawModal = modals.openWithdraw;
    window.openTransferModal = modals.openTransfer;
    window.openEscrowModal = modals.openEscrow;
    window.openMyStatus = status.openMyStatus;
    window.submitComment = actions.submitComment;
    window.sharePost = actions.sharePost;
    window.sendMessage = actions.sendMessage;
    window.selectAgent = actions.selectAgent;
    window.applyLoan = actions.applyLoan;
    window.createAd = actions.createAd;
    window.submitCase = actions.submitCase;
    window.uploadResource = actions.uploadResource;
    window.saveSettings = actions.saveSettings;
    window.manageZone = actions.manageZone;
    window.openOTP = otp.open;
    window.toggleVerificationMethod = otp.toggleMethod;
    window.verifyOTP = otp.verify;
    window.startVideo = video.start;
    window.capturePhoto = video.capturePhoto;
    window.stopRecording = video.stopRecording;
    window.stopVideo = video.stop;
    window.startSelfieCountdown = upload.startSelfieCountdown;
    window.submitUpload = upload.submit;
    window.filterUploads = upload.filter;
    window.filterByCategory = upload.filterByCategory;
    window.approveUpload = upload.approve;
    window.rejectUpload = upload.reject;
    window.applyFilter = video.applyFilter;
    window.toggle2FA = (element) => {
      element.classList.toggle('active');
      element.setAttribute('aria-checked', element.classList.contains('active'));
      notify.show(`2FA ${element.classList.contains('active') ? 'enabled' : 'disabled'}`);
    };
    window.openProfile = () => {
      if (!state.currentContact) {
        notify.show('Select a contact', 'error');
        return;
      }
      notify.show(`Opening profile for ${state.currentContact}`);
    };
    window.startChat = chat.start;
    window.filterContacts = chat.filterContacts;
    window.openConversation = chat.openConversation;
    window.sendText = chat.sendText;
    window.handleFile = chat.handleFile;
    window.handleCamera = chat.handleCamera;
    window.toggleRecord = chat.toggleRecord;
    window.openOffer = chat.openOffer;
    window.closeOffer = chat.closeOffer;
    window.sendOffer = chat.sendOffer;
    window.respondOffer = chat.respondOffer;
    window.openStatus = status.open;
    window.uploadStatus = status.upload;
    window.sendStatusMessage = status.sendMessage;
    window.closeModal = modals.close;
  };

  // Run Initialization
  document.addEventListener('DOMContentLoaded', () => {
    init();
    if (navigator.mediaDevices) {
      navigator.geolocation.watchPosition(
        (pos) => console.log('Geolocation:', pos.coords.latitude, pos.coords.longitude),
        (err) => console.error('Geolocation error:', err)
      );
    }
  });
</script>

<style>
  /* CSS for dynamic elements */
  .post-media {
    width: 100%;
    margin-bottom: 10px;
  }
  .preview-image {
    max-width: 100px;
    max-height: 100px;
    border: 1px solid var(--border, #ddd);
  }
  .status-media {
    max-width: 100%;
  }
  .reaction-heart {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0);
    font-size: 50px;
    opacity: 0.8;
    transition: transform 0.5s ease, opacity 0.5s ease;
  }
  .offer-amount {
    margin-top: 8px;
    font-size: 1.1rem;
  }
  .offer-note {
    margin-top: 8px;
    color: var(--muted, #666);
  }
  .suggestion-item {
    cursor: pointer;
    padding: 8px;
    background: var(--bg, #fff);
    border-bottom: 1px solid var(--border, #ddd);
  }
  .suggestion-item:hover {
    background: var(--hover, #f0f0f0);
  }
  .progress-step {
    padding: 0.5rem 1rem;
    background: var(--inactive, #ccc);
    border-radius: 50%;
    color: #333;
    font-size: 1rem;
  }
  .progress-step.active {
    background: var(--primary, #4b9cea);
    color: white;
  }
  #progress-bar {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }
  #upload-slide select,
  #upload-slide input[type="number"],
  #upload-slide input[type="text"],
  #upload-slide input[type="file"] {
    width: 100%;
    max-width: 200px;
    padding: 0.5rem;
    margin: 0.25rem 0;
  }
  #price-group,
  #owner-verification-step {
    margin-top: 1rem;
  }
  #price-group.active,
  #owner-verification-step.active {
    display: block;
  }
  #price-group:not(.active),
  #owner-verification-step:not(.active) {
    display: none;
  }
  #preview-gallery {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    margin-top: 0.5rem;
  }
  #upload-slide button {
    padding: 0.5rem 1rem;
    margin: 0.25rem;
  }
  .upload-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    border-bottom: 1px solid var(--border, #ddd);
  }
  .status-badge {
    padding: 0.25rem 0.5rem;
    border-radius: 12px;
    font-size: 0.8rem;
  }
  .status-badge.pending {
    background: var(--warning, #ffcc00);
  }
  .status-badge.approved {
    background: var(--success, #28a745);
  }
  .status-badge.rejected {
    background: var(--danger, #dc3545);
  }
  .notif {
    padding: 0.5rem;
    background: var(--bg, #fff);
    border: 1px solid var(--border, #ddd);
    margin-bottom: 0.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .notif-close {
    cursor: pointer;
  }
  .preview-item {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .status-btn {
    margin-top: 0.25rem;
    padding: 0.25rem 0.5rem;
    font-size: 0.8rem;
  }
  .drag-over {
    border: 2px dashed var(--primary, #4b9cea);
  }
</style>
</body>